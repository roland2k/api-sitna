TC.Util.ExcelExport=function(){this.stringifyField=function(t,e,r){if("string"==typeof t){t=t.replace(/"/g,'""');(r||t.indexOf(",")>-1||t.indexOf("\n")>-1||t.indexOf("\r")>-1)&&(t=e+t+e);return t}return"boolean"==typeof t?t?"TRUE":"FALSE":t};this.stringify=function(t,e){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=String.fromCharCode,o=function(){try{document.createElement("$")}catch(t){return t}}();window.btoa||(window.btoa=function(t){for(var e,a,n,i,s,l,c=0,d=t.length,f=Math.max,h="";c<d;){if(f(e=t.charCodeAt(c++)||0,a=t.charCodeAt(c++)||0,l=t.charCodeAt(c++)||0)>255)throw o;n=(3&e)<<4|a>>4&15;i=(15&a)<<2|l>>6&3;s=63&l;a?l||(s=64):i=s=64;h+=r.charAt(e>>2&63)+r.charAt(n)+r.charAt(i)+r.charAt(s)}return h});window.atob||(window.atob=function(t){var e,n,i,s,l,c=0,d=(t=t.replace(/=+$/,"")).length,f=[];if(d%4==1)throw o;for(;c<d;){e=(63&r.indexOf(t.charAt(c++)))<<2|(i=r.indexOf(t.charAt(c++)))>>4&3;n=(15&i)<<4|(s=r.indexOf(t.charAt(c++)))>>2&15;l=(3&s)<<6|63&r.indexOf(t.charAt(c++));f.push(a(e));n&&f.push(a(n));l&&f.push(a(l))}return f.join("")});var n=[];Array.isArray(t)?n=t:TC.Util.isFunction(t)&&(n=t());const i=function(t,e){var r=e||"";if(t instanceof Array){r+="<table><tbody>";for(var a=0;a<t.length;a++)r+="<tr><td>"+i(t[a],e)+"</td></tr>";r+="</tbody></table>"}else if(t instanceof Object){r+="<table><tbody>";for(var a in t){r+="<tr><th>"+a+"</th>";if(t[a]instanceof Object)r+="<td>"+i(t[a],e)+"</td></tr>";else{var o=s(t[a]);t[a]=o.value;r+='<td class="'+o.class+'">';switch(!0){case"string"==typeof t[a]&&t[a].startsWith("http"):r+='<a href="'+unescape(encodeURIComponent(t[a]))+'">Abrir</a>';break;default:r+=t[a]}r+="</td></tr>"}}r+="</tbody></table>"}else r+=t;return r},s=function(t){var e;if(null===t||"string"!=typeof t&&"number"!=typeof t)e=e instanceof Object?"":"string";else{t.value&&(t=t.value);if(-1!=(""+t).indexOf("%")){t=t.replace(" %","%").replace(/\.|,/g,h);e="percent"}else{var r=0;t&&(r="number"==typeof t?t:new Number(t.replace?t.replace(/\,/g,"").replace(/./g,".").trim():t.trim()));if(isNaN(r))e=/^\d{1,2}([.\/-])\d{1,2}\1(\d{4}|\d{2})$/.test(t)||/^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])[ ,T]{1}(2[0-3]|[01][0-9]):[0-5][0-9]:[0-5][0-9][Z]{0,1}$/.test(t)?"date":"string";else{t=r.toString().replace(".",h);e=r%1>0?"number2d":"number"}}}return{class:e,value:t}};for(var l='<thead valign="top">',c=0;c<1;c++){l+="<tr>";for(var d in n[c])n[c].hasOwnProperty(d)&&(l+="<th>"+n[c][d]+"</th>");l+="</tr>"}l+="</thead>";l+="<tbody>";let f=navigator.language.substring(0,5);var h;try{h=1.1.toLocaleString(f).substring(1,2);1e3.toLocaleString(f).substring(1,2)}catch(t){h=1.1.toLocaleString("es-ES").substring(1,2);1e3.toLocaleString("es-ES").substring(1,2)}for(c=1;c<n.length;c++){l+="<tr>";for(d=0;d<n[c].length;d++)if(n[c].hasOwnProperty(d)){var m=n[c][d];const t=s(m);if((m=t.value)instanceof Object)l+="<td>"+i(m)+"</td>";else{l+='<td class="'+t.class+'"';if(m&&(m.hasOwnProperty("rowspan")||m.hasOwnProperty("colspan"))){m.hasOwnProperty("rowspan")&&(l+=' valign="top" rowspan="'+m.rowspan+'">'+m.value+"</td>");m.hasOwnProperty("colspan")&&(l+=' colspan="'+m.colspan+'">'+m.value+"</td>");d++}else l+=">"+(null==m?"":m)+"</td>"}}l+="</tr>"}l+="</tbody>";var p='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name=ProgId content=Excel.Sheet><meta name=Generator content="Microsoft Excel 9">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>';p+=","===h?'\x3c!--table{mso-displayed-decimal-separator:","; mso-displayed-thousand-separator:".";}':'\x3c!--table{mso-displayed-decimal-separator:"."; mso-displayed-thousand-separator:",";}';p+="body {visibility:hidden;}";p+='.number{mso-number-format:"#,##0";} .number2d{mso-number-format:"#,##0.00";} .percent{mso-number-format:0.00%;} ';p+='.date{mso-number-format:"dd/mm/yyyy";} .string{mso-number-format:"@";} caption{text-align:left;}--\x3e</style></head><body><table><caption>{caption}</caption>{table}</table></body></html>';var u,b={worksheet:e.workSheet||"Hoja1",table:l,caption:e.title||""};return u=b,p.replace(/{(\w+)}/g,function(t,e){return u[e]})}};TC.Util.ExcelExport.prototype.Save=function(t,e,r){csvFile=this.stringify(e,{txtDelim:'"',fieldSep:";",title:r||""});var a=new Blob([csvFile],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(a,t);else{var o=document.createElement("a");if(void 0!==o.download){var n=URL.createObjectURL(a);o.setAttribute("href",n);o.setAttribute("download",t);o.style.visibility="hidden";document.body.appendChild(o);o.click();document.body.removeChild(o)}}};
//# sourceMappingURL=maps/Util.ExcelExport.min.js.map