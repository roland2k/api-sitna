!function(){const e=["http://www.google.com/kml/ext/2.2"];let t=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"];const o=function(e){for(var t=[],o=[],l=Math.pow(2,e.length),r=0;r<l;r++){o=[];for(var n=0;n<e.length;n++)r&Math.pow(2,n)&&-1==o.indexOf(e[n])&&o.push(e[n]);o.length>0&&-1==t.indexOf(o.join(" "))&&t.push(o.join(" "))}return t}(t.slice().slice(1));!function(e,t){if(e&&e.length>0)for(var o=0;o<t.length;o++){var l=e.indexOf(t[o]);l>-1&&e.splice(l,1)}}(o,t);t=t.concat(o);const l={fraction:ol.style.IconAnchorUnits.FRACTION,pixels:ol.style.IconAnchorUnits.PIXELS,insetPixels:ol.style.IconAnchorUnits.PIXELS},r=ol.xml.makeStructureNS(t,{ExtendedData:function(e,t){ol.xml.parseNode(ee,e,t)},Region:function(e,t){ol.xml.parseNode(n,e,t)},MultiGeometry:ol.xml.makeObjectPropertySetter(q,"geometry"),LineString:ol.xml.makeObjectPropertySetter(z,"geometry"),LinearRing:ol.xml.makeObjectPropertySetter(X,"geometry"),Point:ol.xml.makeObjectPropertySetter(Z,"geometry"),Polygon:ol.xml.makeObjectPropertySetter(H,"geometry"),Style:ol.xml.makeObjectPropertySetter($),StyleMap:function(e,t){const o=function(e,t){return ol.xml.pushParseAndPop(void 0,w,e,t)}(e,t);if(!o)return;const l=t[t.length-1];Array.isArray(o)?l.Style=o:"string"==typeof o?l.styleUrl=o:assert(!1,38)},address:ol.xml.makeObjectPropertySetter(ol.format.xsd.readString),description:ol.xml.makeObjectPropertySetter(ol.format.xsd.readString),name:ol.xml.makeObjectPropertySetter(ol.format.xsd.readString),open:ol.xml.makeObjectPropertySetter(ol.format.xsd.readBoolean),phoneNumber:ol.xml.makeObjectPropertySetter(ol.format.xsd.readString),styleUrl:ol.xml.makeObjectPropertySetter(C),visibility:ol.xml.makeObjectPropertySetter(ol.format.xsd.readBoolean)},ol.xml.makeStructureNS(e,{MultiTrack:ol.xml.makeObjectPropertySetter(function(e,t){const o=ol.xml.pushParseAndPop([],D,e,t);if(!o)return;return new ol.geom.MultiLineString(o)},"geometry"),Track:ol.xml.makeObjectPropertySetter(v,"geometry")})),n=(ol.xml.makeStructureNS(t,{href:ol.xml.makeObjectPropertySetter(C)}),ol.xml.makeStructureNS(t,{LatLonAltBox:function(e,t){const o=ol.xml.pushParseAndPop({},le,e,t);if(!o)return;const l=t[t.length-1],r=[parseFloat(o.west),parseFloat(o.south),parseFloat(o.east),parseFloat(o.north)];l.extent=r;l.altitudeMode=o.altitudeMode;l.minAltitude=parseFloat(o.minAltitude);l.maxAltitude=parseFloat(o.maxAltitude)},Lod:function(e,t){const o=ol.xml.pushParseAndPop({},re,e,t);if(!o)return;const l=t[t.length-1];l.minLodPixels=parseFloat(o.minLodPixels);l.maxLodPixels=parseFloat(o.maxLodPixels);l.minFadeExtent=parseFloat(o.minFadeExtent);l.maxFadeExtent=parseFloat(o.maxFadeExtent)}}));let a,s,i,m,c,d,u,x=null;let p,y=null;let S,g=null;let f=null;let h=null,k=null;const P=function(e,t){var o;if(e){o=(o=ol.color.asArray(e)).slice();void 0!==t&&(o[3]=t)}else o=[0,0,0,1];return o};const A=function(e,o){const l=ol.xml.parse(e).getElementsByTagName(o.toLowerCase());if(l&&l.length>0){var r=l[0].getAttribute("xmlns");if(r&&r.indexOf(" ")>-1&&t.indexOf(r)>-1){const e=r.split(" "),t=[];for(var n=0;n<e.length;n++)t.push("xmlns:"+o.toLowerCase()+n+'="'+e[n].trim()+'"')}}return e};function O(e,t){let o=null;const l=[0,0];let r="start";if(e.getImage()){let t=e.getImage().getImageSize();null===t&&(t=c);if(2==t.length){const o=e.getImage().getScale();l[0]=o*t[0]/2;l[1]=-o*t[1]/2;r="left"}}if(null!==e.getText()){const t=e.getText();(o=t.clone()).setFont(t.getFont()||f.getFont());o.setScale(t.getScale()||f.getScale());o.setFill(t.getFill()||f.getFill());o.setStroke(t.getStroke()||S)}else o=f.clone();o.setText(t);o.setOffsetX(l[0]);o.setOffsetY(l[1]);o.setTextAlign(r);return new ol.style.Style({text:o})}function N(e){const t=ol.xml.getAllTextContent(e,!1),o=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(t);if(o){const e=o[1];return[parseInt(e.substr(6,2),16),parseInt(e.substr(4,2),16),parseInt(e.substr(2,2),16),parseInt(e.substr(0,2),16)/255]}}function T(e){let t=ol.xml.getAllTextContent(e,!1);const o=[],l=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?))?\s*/i;let r;for(;r=l.exec(t);){const e=parseFloat(r[1]),l=parseFloat(r[2]),n=r[3]?parseFloat(r[3]):0;o.push(e,l,n);t=t.substr(r[0].length)}if(""===t)return o}function C(e){const t=ol.xml.getAllTextContent(e,!1).trim();let o=e.baseURI;o&&"about:blank"!=o||(o=window.location.href);if(o){"https:"===location.protocol&&0===o.indexOf("http://")&&(o=o.substr(5));return new URL(t,o).href}return t}function b(e){return ol.format.xsd.readDecimal(e)}const w=ol.xml.makeStructureNS(t,{Pair:function(e,t){const o=ol.xml.pushParseAndPop({},te,e,t);if(!o)return;const l=o.key;if(l&&"normal"==l){const e=o.styleUrl;e&&(t[t.length-1]=e);const l=o.Style;l&&(t[t.length-1]=l)}}});const I=ol.xml.makeStructureNS(t,{Icon:ol.xml.makeObjectPropertySetter(function(e,t){const o=ol.xml.pushParseAndPop({},G,e,t);return o||null}),heading:ol.xml.makeObjectPropertySetter(ol.format.xsd.readDecimal),hotSpot:ol.xml.makeObjectPropertySetter(function(e){const t=e.getAttribute("xunits"),o=e.getAttribute("yunits");let r;r="insetPixels"!==t?"insetPixels"!==o?ol.style.IconOrigin.BOTTOM_LEFT:ol.style.IconOrigin.TOP_LEFT:"insetPixels"!==o?ol.style.IconOrigin.BOTTOM_RIGHT:ol.style.IconOrigin.TOP_RIGHT;return{x:parseFloat(e.getAttribute("x")),xunits:l[t],y:parseFloat(e.getAttribute("y")),yunits:l[o],origin:r}}),scale:ol.xml.makeObjectPropertySetter(b)}),F=ol.xml.makeStructureNS(t,{text:ol.xml.makeObjectPropertySetter(function(e,t){ol.asserts.assert(e.nodeType==Node.ELEMENT_NODE);ol.asserts.assert("text"==e.localName);return ol.format.xsd.readString(e).trim()})});const L=ol.xml.makeStructureNS(t,{color:ol.xml.makeObjectPropertySetter(N),scale:ol.xml.makeObjectPropertySetter(b)});const E=ol.xml.makeStructureNS(t,{color:ol.xml.makeObjectPropertySetter(N),width:ol.xml.makeObjectPropertySetter(ol.format.xsd.readDecimal)});const R=ol.xml.makeStructureNS(t,{color:ol.xml.makeObjectPropertySetter(N),fill:ol.xml.makeObjectPropertySetter(ol.format.xsd.readBoolean),outline:ol.xml.makeObjectPropertySetter(ol.format.xsd.readBoolean)});const _=ol.xml.makeStructureNS(t,{coordinates:ol.xml.makeReplacer(T)});function j(e,t){return ol.xml.pushParseAndPop(null,_,e,t)}const D=ol.xml.makeStructureNS(e,{Track:ol.xml.makeArrayPusher(v)});const M=ol.xml.makeStructureNS(t,{when:function(e,t){const o=t[t.length-1].whens,l=ol.xml.getAllTextContent(e,!1),r=Date.parse(l);o.push(isNaN(r)?0:r)}},ol.xml.makeStructureNS(e,{coord:function(e,t){const o=t[t.length-1].flatCoordinates,l=ol.xml.getAllTextContent(e,!1),r=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(l);if(r){const e=parseFloat(r[1]),t=parseFloat(r[2]),l=parseFloat(r[3]);o.push(e,t,l,0)}else o.push(0,0,0,0)}}));function v(e,t){const o=ol.xml.pushParseAndPop({flatCoordinates:[],whens:[]},M,e,t);if(!o)return;const l=o.flatCoordinates,r=o.whens;for(let e=0,t=Math.min(l.length,r.length);e<t;++e)l[4*e+3]=r[e];return new ol.geom.LineString(l,ol.geom.GeometryLayout.XYZM)}const G=ol.xml.makeStructureNS(t,{href:ol.xml.makeObjectPropertySetter(C)},ol.xml.makeStructureNS(e,{x:ol.xml.makeObjectPropertySetter(ol.format.xsd.readDecimal),y:ol.xml.makeObjectPropertySetter(ol.format.xsd.readDecimal),w:ol.xml.makeObjectPropertySetter(ol.format.xsd.readDecimal),h:ol.xml.makeObjectPropertySetter(ol.format.xsd.readDecimal)}));const U=ol.xml.makeStructureNS(t,{coordinates:ol.xml.makeReplacer(T)});function B(e,t){return ol.xml.pushParseAndPop(null,U,e,t)}const Y=ol.xml.makeStructureNS(t,{extrude:ol.xml.makeObjectPropertySetter(ol.format.xsd.readBoolean),tessellate:ol.xml.makeObjectPropertySetter(ol.format.xsd.readBoolean),altitudeMode:ol.xml.makeObjectPropertySetter(ol.format.xsd.readString)});function z(e,t){const o=ol.xml.pushParseAndPop({},Y,e,t),l=B(e,t);if(l){const e=new ol.geom.LineString(l,ol.geom.GeometryLayout.XYZ);e.setProperties(o,!0);return e}}function X(e,t){const o=ol.xml.pushParseAndPop({},Y,e,t),l=B(e,t);if(l){const e=new ol.geom.Polygon(l,ol.geom.GeometryLayout.XYZ,[l.length]);e.setProperties(o,!0);return e}}const J=ol.xml.makeStructureNS(t,{LineString:ol.xml.makeArrayPusher(z),LinearRing:ol.xml.makeArrayPusher(X),MultiGeometry:ol.xml.makeArrayPusher(q),Point:ol.xml.makeArrayPusher(Z),Polygon:ol.xml.makeArrayPusher(H)});function q(e,t){const o=ol.xml.pushParseAndPop([],J,e,t);if(!o)return null;if(0===o.length)return new ol.geom.GeometryCollection(o);let l,r=!0;const n=o[0].getType();let a;for(let e=1,t=o.length;e<t;++e)if((a=o[e]).getType()!=n){r=!1;break}if(r){let e,t;if(n==ol.geom.GeometryType.POINT){const r=o[0];e=r.getLayout();t=r.getFlatCoordinates();for(let e=1,l=o.length;e<l;++e){a=o[e];ol.array.extend(t,a.getFlatCoordinates())}Q(l=new ol.geom.MultiPoint(t,e),o)}else n==ol.geom.GeometryType.LINE_STRING?Q(l=new ol.geom.MultiLineString(o),o):n==ol.geom.GeometryType.POLYGON?Q(l=new ol.geom.MultiPolygon(o),o):n==ol.geom.GeometryType.GEOMETRY_COLLECTION?l=new ol.geom.GeometryCollection(o):assert(!1,37)}else l=new ol.geom.GeometryCollection(o);return l}function Z(e,t){const o=ol.xml.pushParseAndPop({},Y,e,t),l=B(e,t);if(l){const e=new ol.geom.Point(l,ol.geom.GeometryLayout.XYZ);e.setProperties(o,!0);return e}}const W=ol.xml.makeStructureNS(t,{innerBoundaryIs:function(e,t){const o=ol.xml.pushParseAndPop(void 0,ne,e,t);if(o){const e=t[t.length-1];e.push(o)}},outerBoundaryIs:function(e,t){const o=ol.xml.pushParseAndPop(void 0,ae,e,t);if(o){const e=t[t.length-1];e[0]=o}}});function H(e,t){const o=ol.xml.pushParseAndPop({},Y,e,t),l=ol.xml.pushParseAndPop([null],W,e,t);if(l&&l[0]){const e=l[0],t=[e.length];for(let o=1,r=l.length;o<r;++o){ol.array.extend(e,l[o]);t.push(e.length)}const r=new ol.geom.Polygon(e,ol.geom.GeometryLayout.XYZ,t);r.setProperties(o,!0);return r}}const K=ol.xml.makeStructureNS(t,{IconStyle:function(e,t){const o=ol.xml.pushParseAndPop({},I,e,t);if(!o)return;const l=t[t.length-1],r="Icon"in o?o.Icon:{},n=!("Icon"in o)||Object.keys(r).length>0;let a;const x=r.href;x?a=x:n&&(a=d);let y,S,g,f=ol.style.IconOrigin.BOTTOM_LEFT;const h=o.hotSpot;if(h){y=[h.x,h.y];S=h.xunits;g=h.yunits;f=h.origin}else if(a===d){y=s;S=i;g=m}else if(/^http:\/\/maps\.(?:google|gstatic)\.com\//.test(a)){y=[.5,0];S=ol.style.IconAnchorUnits.FRACTION;g=ol.style.IconAnchorUnits.FRACTION}/Firefox/.test(navigator.userAgent)&&"https:"===location.protocol&&a.startsWith("http:")&&(a=a.replace("http:","https:"));let k;const P=r.x,A=r.y;void 0!==P&&void 0!==A&&(k=[P,A]);let O;const N=r.w,T=r.h;void 0!==N&&void 0!==T&&(O=[N,T]);let C;const b=o.heading;void 0!==b&&(C=ol.math.toRadians(b));let w=o.scale;if(n){if(a==d){O=c;void 0===w&&(w=u)}const e=new ol.style.Icon({anchor:y,anchorOrigin:f,anchorXUnits:S,anchorYUnits:g,crossOrigin:"anonymous",offset:k,offsetOrigin:ol.style.IconOrigin.BOTTOM_LEFT,rotation:C,scale:w,size:O,src:a});l.imageStyle=e}else l.imageStyle=p},LabelStyle:function(e,t){const o=ol.xml.pushParseAndPop({},L,e,t);if(!o)return;const l=t[t.length-1],r=new ol.style.Text({fill:new ol.style.Fill({color:"color"in o?o.color:a}),scale:o.scale});l.textStyle=r},LineStyle:function(e,t){const o=ol.xml.pushParseAndPop({},E,e,t);if(!o)return;const l=t[t.length-1],r=new ol.style.Stroke({color:"color"in o?o.color:a,width:"width"in o?o.width:1});l.strokeStyle=r},PolyStyle:function(e,t){const o=ol.xml.pushParseAndPop({},R,e,t);if(!o)return;const l=t[t.length-1],r=new ol.style.Fill({color:"color"in o?o.color:a});l.fillStyle=r;const n=o.fill;void 0!==n&&(l.fill=n);const s=o.outline;void 0!==s&&(l.outline=s)},BalloonStyle:function(e,t){ol.asserts.assert(e.nodeType==Node.ELEMENT_NODE);ol.asserts.assert("BalloonStyle"==e.localName);var o=ol.xml.pushParseAndPop({},F,e,t);if(!o)return;const l=t[t.length-1],r=typeof l;ol.asserts.assert("object"==r&&null!=l||"function"==r);var n=new ol.style.Text({text:o.text});l.balloonStyle=n}});function $(e,t){const o=ol.xml.pushParseAndPop({},K,e,t);if(!o)return null;let l="fillStyle"in o?o.fillStyle:x;const r=o.fill;void 0===r||r||(l=null);let n;"imageStyle"in o?o.imageStyle!=p&&(n=o.imageStyle):n=y;const a="textStyle"in o?o.textStyle:f;let s="strokeStyle"in o?o.strokeStyle:g;const i=o.balloonStyle,m=new ol.style.Style({fill:l,image:n,stroke:s,text:a,zIndex:void 0});i&&(m._balloon=i);return[m]}function Q(e,t){const o=t.length,l=new Array(t.length),r=new Array(t.length),n=new Array(t.length);let a,s,i;a=s=i=!1;for(let e=0;e<o;++e){const o=t[e];l[e]=o.get("extrude");r[e]=o.get("tessellate");n[e]=o.get("altitudeMode");a=a||void 0!==l[e];s=s||void 0!==r[e];i=i||n[e]}a&&e.set("extrude",l);s&&e.set("tessellate",r);i&&e.set("altitudeMode",n)}const V=ol.xml.makeStructureNS(t,{displayName:ol.xml.makeObjectPropertySetter(ol.format.xsd.readString),value:ol.xml.makeObjectPropertySetter(ol.format.xsd.readString)});const ee=ol.xml.makeStructureNS(t,{Data:function(e,t){const o=e.getAttribute("name");ol.xml.parseNode(V,e,t);const l=t[t.length-1];null!==o?l[o]=l.value:null!==l.displayName&&(l[l.displayName]=l.value);delete l.value},SchemaData:function(e,t){ol.xml.parseNode(oe,e,t)}});const te=ol.xml.makeStructureNS(t,{Style:ol.xml.makeObjectPropertySetter($),key:ol.xml.makeObjectPropertySetter(ol.format.xsd.readString),styleUrl:ol.xml.makeObjectPropertySetter(C)});const oe=ol.xml.makeStructureNS(t,{SimpleData:function(e,t){const o=e.getAttribute("name");if(null!==o){const l=ol.format.xsd.readString(e),r=t[t.length-1];r[o]=l}}});const le=ol.xml.makeStructureNS(t,{altitudeMode:ol.xml.makeObjectPropertySetter(ol.format.xsd.readString),minAltitude:ol.xml.makeObjectPropertySetter(ol.format.xsd.readDecimal),maxAltitude:ol.xml.makeObjectPropertySetter(ol.format.xsd.readDecimal),north:ol.xml.makeObjectPropertySetter(ol.format.xsd.readDecimal),south:ol.xml.makeObjectPropertySetter(ol.format.xsd.readDecimal),east:ol.xml.makeObjectPropertySetter(ol.format.xsd.readDecimal),west:ol.xml.makeObjectPropertySetter(ol.format.xsd.readDecimal)});const re=ol.xml.makeStructureNS(t,{minLodPixels:ol.xml.makeObjectPropertySetter(ol.format.xsd.readDecimal),maxLodPixels:ol.xml.makeObjectPropertySetter(ol.format.xsd.readDecimal),minFadeExtent:ol.xml.makeObjectPropertySetter(ol.format.xsd.readDecimal),maxFadeExtent:ol.xml.makeObjectPropertySetter(ol.format.xsd.readDecimal)});const ne=ol.xml.makeStructureNS(t,{LinearRing:ol.xml.makeReplacer(j)});const ae=ol.xml.makeStructureNS(t,{LinearRing:ol.xml.makeReplacer(j)});function se(e,t){const o=asArray(t),l=[255*(4==o.length?o[3]:1),o[2],o[1],o[0]];for(let e=0;e<4;++e){const t=Math.floor(l[e]).toString(16);l[e]=1==t.length?"0"+t:t}ol.format.xsd.writeStringTextNode(e,l.join(""))}const ie=ol.xml.makeStructureNS(t,{Data:ol.xml.makeChildAppender(function(e,t,o){e.setAttribute("name",t.name);const l={node:e},r=t.value;if("object"==typeof r){null!==r&&r.displayName&&ol.xml.pushSerializeAndPop(l,ie,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,[r.displayName],o,["displayName"]);null!==r&&r.value&&ol.xml.pushSerializeAndPop(l,ie,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,[r.value],o,["value"])}else ol.xml.pushSerializeAndPop(l,ie,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,[r],o,["value"])}),value:ol.xml.makeChildAppender(function(e,t){ol.format.xsd.writeStringTextNode(e,t)}),displayName:ol.xml.makeChildAppender(function(e,t){ol.format.xsd.writeCDATASection(e,t)})});ol.xml.makeStructureNS(t,{Placemark:ol.xml.makeChildAppender(function(e,t,o){const l={node:e};t.getId()&&e.setAttribute("id",t.getId());const r=t.getProperties(),n={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};n[t.getGeometryName()]=1;const a=Object.keys(r||{}).sort().filter(function(e){return!n[e]});if(a.length>0){const e=ol.xml.makeSequence(r,a),t={names:a,values:e};ol.xml.pushSerializeAndPop(l,Ie,Le,[t],o)}const s=t.getStyleFunction();if(s){const e=s(t,0);if(e){const t=Array.isArray(e)?e[0]:e;this.writeStyles_&&(r.Style=t);const o=t.getText();o&&(r.name=o.getText())}}const i=o[o.length-1].node,m=Fe[i.namespaceURI],c=ol.xml.makeSequence(r,m);ol.xml.pushSerializeAndPop(l,Ie,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,c,o,m);const d=o[0];let u=t.getGeometry();u&&(u=ol.format.Feature.transformGeometryWithOptions(u,!0,d));ol.xml.pushSerializeAndPop(l,Ie,ke,[u],o)})});const me=ol.xml.makeSimpleNodeFactory("Data");const ce=ol.xml.makeStructureNS(t,["href"],ol.xml.makeStructureNS(e,["x","y","w","h"])),de=ol.xml.makeStructureNS(t,{href:ol.xml.makeChildAppender(ol.format.xsd.writeStringTextNode)},ol.xml.makeStructureNS(e,{x:ol.xml.makeChildAppender(ol.format.xsd.writeDecimalTextNode),y:ol.xml.makeChildAppender(ol.format.xsd.writeDecimalTextNode),w:ol.xml.makeChildAppender(ol.format.xsd.writeDecimalTextNode),h:ol.xml.makeChildAppender(ol.format.xsd.writeDecimalTextNode)})),ue=function(t,o,l){return ol.xml.createElementNS(e[0],"gx:"+l)};const xe=ol.xml.makeStructureNS(t,["scale","heading","Icon","hotSpot"]),pe=ol.xml.makeStructureNS(t,{Icon:ol.xml.makeChildAppender(function(t,o,l){const r={node:t},n=l[l.length-1].node;let a=ce[n.namespaceURI],s=ol.xml.makeSequence(o,a);ol.xml.pushSerializeAndPop(r,de,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,s,l,a);a=ce[e[0]];s=ol.xml.makeSequence(o,a);ol.xml.pushSerializeAndPop(r,de,ue,s,l,a)}),heading:ol.xml.makeChildAppender(ol.format.xsd.writeDecimalTextNode),hotSpot:ol.xml.makeChildAppender(function(e,t){e.setAttribute("x",String(t.x));e.setAttribute("y",String(t.y));e.setAttribute("xunits",t.xunits);e.setAttribute("yunits",t.yunits)}),scale:ol.xml.makeChildAppender(Be)});const ye=ol.xml.makeStructureNS(t,["color","scale"]),Se=ol.xml.makeStructureNS(t,{color:ol.xml.makeChildAppender(se),scale:ol.xml.makeChildAppender(Be)});const ge=ol.xml.makeStructureNS(t,["color","width"]),fe=ol.xml.makeStructureNS(t,{color:ol.xml.makeChildAppender(se),width:ol.xml.makeChildAppender(ol.format.xsd.writeDecimalTextNode)});const he={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},ke=function(e,t,o){if(e){const o=t[t.length-1].node;return ol.xml.createElementNS(o.namespaceURI,he[e.getType()])}},Pe=ol.xml.makeSimpleNodeFactory("Point"),Ae=ol.xml.makeSimpleNodeFactory("LineString"),Oe=ol.xml.makeSimpleNodeFactory("LinearRing"),Ne=ol.xml.makeSimpleNodeFactory("Polygon"),Te=ol.xml.makeStructureNS(t,{LineString:ol.xml.makeChildAppender(_e),Point:ol.xml.makeChildAppender(_e),Polygon:ol.xml.makeChildAppender(ve),GeometryCollection:ol.xml.makeChildAppender(Ce)});function Ce(e,t,o){const l={node:e},r=t.getType();let n,a;if(r==ol.geom.GeometryType.GEOMETRY_COLLECTION){n=t.getGeometries();a=ke}else if(r==ol.geom.GeometryType.MULTI_POINT){n=t.getPoints();a=Pe}else if(r==ol.geom.GeometryType.MULTI_LINE_STRING){n=t.getLineStrings();a=Ae}else if(r==ol.geom.GeometryType.MULTI_POLYGON){n=t.getPolygons();a=Ne}else assert(!1,39);ol.xml.pushSerializeAndPop(l,Te,a,n,o)}const be=ol.xml.makeStructureNS(t,{LinearRing:ol.xml.makeChildAppender(_e)});function we(e,t,o){const l={node:e};ol.xml.pushSerializeAndPop(l,be,Oe,[t],o)}const Ie=ol.xml.makeStructureNS(t,{ExtendedData:ol.xml.makeChildAppender(function(e,t,o){const l={node:e},r=t.names,n=t.values,a=r.length;for(let e=0;e<a;e++)ol.xml.pushSerializeAndPop(l,ie,me,[{name:r[e],value:n[e]}],o)}),MultiGeometry:ol.xml.makeChildAppender(Ce),LineString:ol.xml.makeChildAppender(_e),LinearRing:ol.xml.makeChildAppender(_e),Point:ol.xml.makeChildAppender(_e),Polygon:ol.xml.makeChildAppender(ve),Style:ol.xml.makeChildAppender(function(e,t,o){const l={node:e},r={},n=t.getFill(),a=t.getStroke(),s=t.getImage(),i=t.getText();s&&"function"==typeof s.getSrc&&(r.IconStyle=s);i&&(r.LabelStyle=i);a&&(r.LineStyle=a);n&&(r.PolyStyle=n);const m=o[o.length-1].node,c=Ye[m.namespaceURI],d=ol.xml.makeSequence(r,c);ol.xml.pushSerializeAndPop(l,ze,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,d,o,c)}),address:ol.xml.makeChildAppender(ol.format.xsd.writeStringTextNode),description:ol.xml.makeChildAppender(ol.format.xsd.writeStringTextNode),name:ol.xml.makeChildAppender(ol.format.xsd.writeStringTextNode),open:ol.xml.makeChildAppender(ol.format.xsd.writeBooleanTextNode),phoneNumber:ol.xml.makeChildAppender(ol.format.xsd.writeStringTextNode),styleUrl:ol.xml.makeChildAppender(ol.format.xsd.writeStringTextNode),visibility:ol.xml.makeChildAppender(ol.format.xsd.writeBooleanTextNode)}),Fe=ol.xml.makeStructureNS(t,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),Le=ol.xml.makeSimpleNodeFactory("ExtendedData");const Ee=ol.xml.makeStructureNS(t,["extrude","tessellate","altitudeMode","coordinates"]),Re=ol.xml.makeStructureNS(t,{extrude:ol.xml.makeChildAppender(ol.format.xsd.writeBooleanTextNode),tessellate:ol.xml.makeChildAppender(ol.format.xsd.writeBooleanTextNode),altitudeMode:ol.xml.makeChildAppender(ol.format.xsd.writeStringTextNode),coordinates:ol.xml.makeChildAppender(function(e,t,o){const l=o[o.length-1],r=l.layout,n=l.stride;let a;r==ol.geom.GeometryLayout.XY||r==ol.geom.GeometryLayout.XYM?a=2:r==ol.geom.GeometryLayout.XYZ||r==ol.geom.GeometryLayout.XYZM?a=3:assert(!1,34);const s=t.length;let i="";if(s>0){i+=t[0];for(let e=1;e<a;++e)i+=","+t[e];for(let e=n;e<s;e+=n){i+=" "+t[e];for(let o=1;o<a;++o)i+=","+t[e+o]}}ol.format.xsd.writeStringTextNode(e,i)})});function _e(e,t,o){const l=t.getFlatCoordinates(),r={node:e};r.layout=t.getLayout();r.stride=t.getStride();const n=t.getProperties();n.coordinates=l;const a=o[o.length-1].node,s=Ee[a.namespaceURI],i=ol.xml.makeSequence(n,s);ol.xml.pushSerializeAndPop(r,Re,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,i,o,s)}const je=ol.xml.makeStructureNS(t,{outerBoundaryIs:ol.xml.makeChildAppender(we),innerBoundaryIs:ol.xml.makeChildAppender(we)}),De=ol.xml.makeSimpleNodeFactory("innerBoundaryIs"),Me=ol.xml.makeSimpleNodeFactory("outerBoundaryIs");function ve(e,t,o){const l=t.getLinearRings(),r=l.shift(),n={node:e};ol.xml.pushSerializeAndPop(n,je,De,l,o);ol.xml.pushSerializeAndPop(n,je,Me,[r],o)}const Ge=ol.xml.makeStructureNS(t,{color:ol.xml.makeChildAppender(se)}),Ue=ol.xml.makeSimpleNodeFactory("color");function Be(e,t){ol.format.xsd.writeDecimalTextNode(e,Math.round(1e6*t)/1e6)}const Ye=ol.xml.makeStructureNS(t,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),ze=ol.xml.makeStructureNS(t,{IconStyle:ol.xml.makeChildAppender(function(e,t,o){const l={node:e},r={},n=t.getSrc(),a=t.getSize(),s=t.getImageSize(),i={href:n};if(a){i.w=a[0];i.h=a[1];const e=t.getAnchor(),o=t.getOrigin();if(o&&s&&0!==o[0]&&o[1]!==a[1]){i.x=o[0];i.y=s[1]-(o[1]+a[1])}if(e&&(e[0]!==a[0]/2||e[1]!==a[1]/2)){const t={x:e[0],xunits:ol.style.IconAnchorUnits.PIXELS,y:a[1]-e[1],yunits:ol.style.IconAnchorUnits.PIXELS};r.hotSpot=t}}r.Icon=i;const m=t.getScale();1!==m&&(r.scale=m);const c=t.getRotation();0!==c&&(r.heading=c);const d=o[o.length-1].node,u=xe[d.namespaceURI],x=ol.xml.makeSequence(r,u);ol.xml.pushSerializeAndPop(l,pe,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,x,o,u)}),LabelStyle:ol.xml.makeChildAppender(function(e,t,o){const l={node:e},r={},n=t.getFill();n&&(r.color=n.getColor());const a=t.getScale();a&&1!==a&&(r.scale=a);const s=o[o.length-1].node,i=ye[s.namespaceURI],m=ol.xml.makeSequence(r,i);ol.xml.pushSerializeAndPop(l,Se,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,m,o,i)}),LineStyle:ol.xml.makeChildAppender(function(e,t,o){const l={node:e},r={color:t.getColor(),width:t.getWidth()},n=o[o.length-1].node,a=ge[n.namespaceURI],s=ol.xml.makeSequence(r,a);ol.xml.pushSerializeAndPop(l,fe,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,s,o,a)}),PolyStyle:ol.xml.makeChildAppender(function(e,t,o){const l={node:e};ol.xml.pushSerializeAndPop(l,Ge,Ue,[t.getColor()],o)})});ol.format.KMLCustom=class extends ol.format.KML{constructor(e){super(e);const t=e||{};k||function(){a=[255,255,255,1];x=new ol.style.Fill({color:P(TC.Cfg.styles.polygon.fillColor,TC.Cfg.styles.polygon.fillOpacity)});s=[20,2];i=ol.style.IconAnchorUnits.PIXELS;m=ol.style.IconAnchorUnits.PIXELS;c=[64,64];d="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png";u=.5;y=new ol.style.Icon({anchor:s,anchorOrigin:ol.style.IconOrigin.BOTTOM_LEFT,anchorXUnits:i,anchorYUnits:m,crossOrigin:"anonymous",rotation:0,scale:u,size:c,src:d});p="NO_IMAGE";g=new ol.style.Stroke({color:P(TC.Cfg.styles.line.strokeColor,1),width:TC.Cfg.styles.line.strokeWidth||1});S=new ol.style.Stroke({color:[51,51,51,1],width:2});f=new ol.style.Text({font:"bold 16px Helvetica",fill:x,stroke:S,scale:.8});h=new ol.style.Style({fill:x,image:y,text:f,stroke:g,zIndex:0});k=[h]}();this.defaultStyle_=t.defaultStyle?t.defaultStyle:k}readFeatures(e,t){if("string"==typeof e){const t="<kml";let o=e.indexOf(t);if(o>=0){o+=t.length;e.indexOf("xmlns:xsi=")<0&&(e=e.substr(0,o)+' xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"'+e.substr(o));e=A(e,"KML")}}const o=ol.format.KML.prototype.readFeatures.call(this,e,t);o.forEach(function(e){e.getId()||e.setId(TC.getUID())});return o}readDocumentOrFolder_(e,o){const l=ol.xml.makeStructureNS(t,{Document:ol.xml.makeArrayExtender(this.readDocumentOrFolder_,this),Folder:ol.xml.makeArrayExtender(this.readDocumentOrFolder_,this),Placemark:ol.xml.makeArrayPusher(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),r=ol.xml.pushParseAndPop([],l,e,o,this);if(r){if("Folder"==e.localName)for(let t=0,o=r.length;t<o;t++){const o=r[t];Array.isArray(o._folders)||(o._folders=[]);var n=e.getElementsByTagName("name")[0];n&&TC.Util.fastUnshift(o._folders,n.innerHTML||n.textContent)}return r}}readPlacemark_(e,t){const o=ol.xml.pushParseAndPop({geometry:null},r,e,t);if(!o)return;const l=new ol.Feature,n=e.getAttribute("id");null!==n&&l.setId(n);const a=t[0],s=o.geometry;s&&ol.format.Feature.transformWithOptions(s,!1,a);l.setGeometry(s);delete o.geometry;if(this.extractStyles_){const e=function(e,t,o,l,r){return function(n,a){let s,i=r,m="";if(i){const e=n.getGeometry();e&&(i=e.getType()===ol.geom.GeometryType.POINT)}if(i){m=n.get("name");i=i&&!!m}if(e){if(i){s=O(e[0],m);return e.concat(s)}return e}if(t){const e=function e(t,o,l){if(Array.isArray(t))return t;if("string"==typeof t){!(t in l)&&"#"+t in l&&(t="#"+t);return e(l[t],o,l)}return o}(t,o,l);if(i){s=O(e[0],m);return e.concat(s)}return e}if(i){s=O(o[0],m);return o.concat(s)}return o}}(o.Style,o.styleUrl,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);l.setStyle(e)}delete o.Style;delete o.styleUrl;l.setProperties(o,!0);return l}readSharedStyle_(e,t){const o=e.getAttribute("id");if(null!==o){const l=$(e,t);if(l){let t,r=e.baseURI;r&&"about:blank"!=r||(r=window.location.href);t=r?new URL("#"+o,r).href:"#"+o;this.sharedStyles_[t]=l}}}readFeatureFromNode(e,o){if(!ol.array.includes(t,e.namespaceURI))return null;const l=this.readPlacemark_(e,[this.getReadOptions(e,o)]);return l||null}readFeaturesFromNode(e,o){if(!ol.array.includes(t,e.namespaceURI))return[];let l;const r=e.localName;if("Document"==r||"Folder"==r)return(l=this.readDocumentOrFolder_(e,[this.getReadOptions(e,o)]))||[];if("Placemark"==r){const t=this.readPlacemark_(e,[this.getReadOptions(e,o)]);return t?[t]:[]}if("kml"==r){l=[];for(let t=e.firstElementChild;t;t=t.nextElementSibling){const e=this.readFeaturesFromNode(t,o);e&&ol.array.extend(l,e)}return l}return[]}}}();
//# sourceMappingURL=../../maps/ol/format/KMLCustom.min.js.map