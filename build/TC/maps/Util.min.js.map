{"version":3,"sources":["Util.js"],"names":["TC","root","factory","exports","module","define","amd","Util","String","prototype","soundex","a","this","toLowerCase","split","f","shift","r","codes","e","i","o","u","b","p","v","c","g","j","k","q","s","x","z","d","t","l","m","n","map","filter","join","slice","toUpperCase","toLocaleString","Number","locale","options","detectIE","apply","arguments","sNum","replace","Math","floor","isInteger","iconUrlCache","markerGroupClassCache","path1","path2","getOnPath","obj","length","hasOwnProperty","swipeHandlers","WeakMap","modalCloseHandlers","hasOwn","getElevationGain","coords","uphill","downhill","hillDeltaThreshold","previousHeight","sectorMinHeight","sectorMaxHeight","previousUphill","height","undefined","min","max","delta","upHill","round","downHill","isPlainObject","nodeType","window","constructor","call","isEmptyObject","name","isFunction","extend","clone","target","deep","len","src","copy","copyIsArray","Array","isArray","getMapLocale","regex","PROTOCOL","isOnCapabilities","url","withProtocol","testUrl","capabilities","reqGetMapOnCapabilities","caps","getFnFromString","fnName","scope","scopeSplit","isURL","text","test","isSecureURL","isSameOrigin","uri","result","indexOf","urlParts","match","Consts","SPLIT_REGEX","location","uProtocol","protocol","hostname","uPort","lPort","port","formatNumber","value","parseFloat","valueOf","addProtocol","getDiv","div","document","getElementById","HTMLElement","$","createElement","getScriptLocation","script","currentScript","scripts","getElementsByTagName","getAttribute","substr","lastIndexOf","getBackgroundUrlFromCss","cssClass","iconDiv","style","display","classList","add","body","appendChild","exec","getComputedStyle","backgroundImage","parentElement","removeChild","getPointIconUrl","className","classes","Cfg","styles","marker","group","key","point","getLegendImageFromStyle","width","strokeWidth","strokeHalfWidth","diameter","radius","lineDashText","lineDash","geometryType","geom","POINT","strokeColor","fillColor","fillOpacity","POLYLINE","POLYGON","encodeURIComponent","addArrayToTree","path","treeNode","index","found","children","title","uid","push","parseCoords","_parseGeoCoord","type","GEOGRAPHIC","idx","_parseCoord","trim","UTM","xy","y","reproject","sourceCrs","targetCrs","multipoint","multiring","multipoly","loadProjDef","crs","sync","sourcePrj","proj4","defs","targetPrj","forEach","poly","pidx","rp","ring","ridx","rr","coord","cidx","getMetersPerDegree","extent","R","PI","cos","degToRad","dLat","sindlat2","sin","atan2","sqrt","radToDeg","rad","deg","mod","getCRSCode","CRSCodesEqual","crs1","crs2","code1","code2","getLocaleString","texts","i18n","getSimpleMimeType","mimeType","end","substring","getQueryStringParams","queryString","queryIdx","fragmentIdx","search","elm","bind","getParamString","arr","fastUnshift","storage","getCookie","cookie","setCookie","getLocalValue","localStorage","Storage","getItem","setLocalValue","removeItem","setItem","exDate","Date","setDate","getDate","expires","getSessionLocalValue","sessionStorage","setSessionLocalValue","detectFirefox","navigator","userAgent","RegExp","$1","ua","msie","parseInt","rv","edge","detectChrome","chrome","detectSafari","detectMouse","matchesCoarse","matchMedia","matches","matchesFine","mqResult","mq","hover","browserFeatures","touch","media","testHover","detectAndroid","detectBlackBerry","detectIOS","detectMobileWindows","detectMobile","getBrowser","UAParser","syncLoadJS","apiLocation","UA_PARSER","browser","version","major","getElementByNodeName","parentNode","nodeName","colonIndex","tag","nodes","getElementsByTagNameNS","addURLParameters","parameters","toAdd","Object","keys","urlparts","params","removeURLParameter","parameter","prefix","pars","splice","showModal","contentNode","hidden","get","VISIBLE","closeButton","querySelectorAll","closeCallback","delete","stopPropagation","closeModal","set","addEventListener","openCallback","callback","hide","modal","remove","closeAlert","btn","swipe","addListeners","handlers","start","passive","removeEventListener","minDistance","maxCrossDistance","maxAllowedTime","touchStartCoords","touchEndCoords","startTime","noSwipe","mustSwipe","changedTouches","pageX","pageY","getTime","startCoords","endCoords","dx","dy","adx","abs","ady","getDirection","getParameterByName","results","decodeURIComponent","getLocaleUserChoice","cookieName","paramName","browserLanguage","languages","language","userLanguage","lang","hyphenIdx","expirationDate","getValidFilename","filename","downloadBlob","blob","link","download","URL","createObjectURL","setAttribute","visibility","click","downloadFile","data","Blob","msSaveBlob","downloadDataURI","dataURI","binary","atob","array","charCodeAt","Uint8Array","shortenUrl","Promise","resolve","reject","ajax","access_token","longUrl","then","response","catch","utf8ToBase64","str","btoa","unescape","base64ToUtf8","escape","error","colorArrayToString","color","reduce","prev","cur","toString","operation","list1","list2","comparerFn","operationIsUnion","item1","inBoth","inFirstOnly","inSecondOnly","toDataUrl","canvas","backgroundColour","_ref","encoderOptions","context","getContext","getImageData","compositeOperation","globalCompositeOperation","fillStyle","fillRect","imageData","toDataURL","clearRect","putImageData","imgToDataUrl","outputFormat","createCanvas","img","ctx","drawImage","Image","crossOrigin","onload","dataURL","dataUrl","proxify","onerror","xhr","XMLHttpRequest","open","setRequestHeader","responseType","status","uInt8Array","binaryString","fromCharCode","getResponseHeader","onreadystatechange","readyState","Error","send","complete","imgTagToDataUrl","base64","addToCanvas","position","size","newCanvas","cloneCanvas","newImage","oldCanvas","calculateAspectRatioFit","srcWidth","srcHeight","maxWidth","maxHeight","ratio","getFormattedDate","date","hasTime","pad","getFullYear","getMonth","concat","getHours","getMinutes","getSeconds","replaceSpecialCharacters","translate","ä","ö","ü","Ä","Ö","Ü","á","é","ó","ú","Á","É","Í","Ó","Ú","ñ","Ñ","downloadFileForm","async","_err","request","msg","statusText","contentDispositionHeader","contentType","format","includes","DownloadError","MIMETYPE_NOT_SUPORTED","getUID","arrDownloads","err","WFSQueryBuilder","layers","onlyHits","srsName","maxFeatures","fields","getSRSAttribute","getFields","tagName","vi","va","query","_queryHeaderConstructor","resultType","queryBody","queryItem","typeName","Filter","getText","layer","WFGetPropertyValue","valueReference","WFSFilterBuilder","feature","clipLayer","geometryName","where","gmlEnvelope","lowerCorner","upperCorner","Feature","writeGMLGeometry","gmlVersion","getSRSName","getGmlCoordinates","Polyline","geometry","isServiceWorker","serviceWorker","controller","state","isSameOriginByLocation","isSameProtocol","protocolRegex","uriProtocol","locationProtocol","consoleRegister","isDebug","console","log","getSorterByProperty","propName","getSoundexDifference","res","charAt","toAbsolutePath","href","explodeGeometry","origin","iterationFunction","cloneMappingFunction","isGeometry","compactGeometry","precision","MAX_VALUE","newGeom","firstIterationFunction","val","secondIterationFunction","hasStyleOptions","formatCoord","nDecimales","maximumFractionDigits","getWebWorkerCrossOriginURL","method","args","arg","queryHeader","fncOvelaps","elem1","elem2","comparisonFnc","getBoundingClientRect","colliding","other","rect1","rect2","top","bottom","right","left","containing","inside"],"mappings":"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","sourcesContent":["; var TC = TC || {};\r\n(function (root, factory) {\r\n    if (typeof exports === \"object\") { // CommonJS\r\n        module.exports = factory();\r\n    } else if (typeof define === \"function\" && define.amd) { // AMD\r\n        define([], factory);\r\n    } else {\r\n        root.Util = factory();\r\n    }\r\n})(TC, function () {\r\n\r\n    String.prototype.soundex = function () {\r\n        var a = this.toLowerCase().split('')\r\n        f = a.shift(),\r\n            r = '',\r\n            codes = {\r\n                a: '', e: '', i: '', o: '', u: '',\r\n                b: 1, f: 1, p: 1, v: 1,\r\n                c: 2, g: 2, j: 2, k: 2, q: 2, s: 2, x: 2, z: 2,\r\n                d: 3, t: 3,\r\n                l: 4,\r\n                m: 5, n: 5,\r\n                r: 6\r\n            };\r\n\r\n        r = f +\r\n            a\r\n                .map(function (v, i, a) { return codes[v] })\r\n                .filter(function (v, i, a) { return ((i === 0) ? v !== codes[f] : v !== a[i - 1]); })\r\n                .join('');\r\n\r\n        return (r + '000').slice(0, 4).toUpperCase();\r\n    }\r\n\r\n    // GLS: Parche: Chrome no formatea correctamente los números en euskera, establece como separador de decimales el (.)\r\n    var toLocaleString = Number.prototype.toLocaleString;\r\n    Number.prototype.toLocaleString = function (locale, options) {\r\n        if (locale == \"eu-ES\" && !TC.Util.detectIE()) {\r\n            var sNum = toLocaleString.apply(this, arguments);\r\n            sNum = sNum.replace(/\\,/g, '.')\r\n            if (!(Math.floor(this) == this && Number.isInteger(Math.floor(this))))\r\n                sNum = sNum.replace(/.([^.]*)$/, \",$1\");\r\n\r\n            return sNum;\r\n        }\r\n        else\r\n            return toLocaleString.apply(this, arguments);\r\n    }\r\n\r\n    var iconUrlCache = {};\r\n    var markerGroupClassCache = {};\r\n\r\n    var path1 = [\"Capability\", \"Request\", \"GetMap\", \"DCPType\", \"0\", \"HTTP\", \"Get\", \"OnlineResource\"];\r\n    var path2 = [\"OperationsMetadata\", \"GetTile\", \"DCP\", \"HTTP\", \"Get\", \"0\", \"href\"];\r\n    var getOnPath = function (obj, p, i) {\r\n        if (i < p.length - 1) {\r\n            if (obj.hasOwnProperty(p[i]))\r\n                return getOnPath(obj[p[i]], p, ++i);\r\n            else return null;\r\n        } else {\r\n            return obj[p[i]];\r\n        }\r\n    };\r\n\r\n    const swipeHandlers = new WeakMap();\r\n    const modalCloseHandlers = new WeakMap();\r\n    const hasOwn = ({}).hasOwnProperty;\r\n\r\n    var Util = {\r\n\r\n        getElevationGain: function (options) {\r\n            options = options || {};\r\n            const coords = options.coords;\r\n            if (coords && coords.length > 0 && coords[0].length > 2) { // si tenemos la Z\r\n                var uphill = 0;\r\n                var downhill = 0;\r\n                const hillDeltaThreshold = options.hillDeltaThreshold || 0;\r\n\r\n                var previousHeight;\r\n                var sectorMinHeight;\r\n                var sectorMaxHeight;\r\n                var previousUphill = true;\r\n\r\n                for (var c = 0; c < coords.length; c++) {\r\n                    var point = coords[c];\r\n                    var height = point[2];\r\n                    if (height !== null) {\r\n                        if (previousHeight === undefined) //--inicializar\r\n                        {\r\n                            previousHeight = height;\r\n                            sectorMinHeight = height;\r\n                            sectorMaxHeight = height;\r\n                        }\r\n\r\n                        sectorMinHeight = Math.min(sectorMinHeight, height); //--actualizar mínimo y máximo del sector\r\n                        sectorMaxHeight = Math.max(sectorMaxHeight, height);\r\n\r\n                        var delta = height - previousHeight; //--calcular desnivel del punto respecto al anterior\r\n                        // hillDeltaThreshold: altura de los dientes a despreciar\r\n                        if (delta > hillDeltaThreshold || (delta > 0 && c == coords.length - 1)) //--Si se sube más del filtro (o se acaba el segmento subiendo)\r\n                        {\r\n                            if (previousUphill) //--Si en el segmento anterior también se subía, incrementamos el desnivel positivo acumulado\r\n                            {\r\n                                uphill += delta;\r\n                            }\r\n                            else //--Si en el segmento anterior se bajaba, incrementamos los desniveles acumulados que no habíamos contabilizado desde el último salto del filtro (sector) \r\n                            {\r\n                                downhill -= sectorMinHeight - previousHeight;\r\n                                uphill += height - sectorMinHeight;\r\n                                previousUphill = true; //--preparar para el paso siguiente\r\n                            }\r\n                            previousHeight = height; //--preparar para el paso siguiente\r\n                            sectorMinHeight = height;\r\n                            sectorMaxHeight = height;\r\n                        }\r\n                        else if (delta < -hillDeltaThreshold || (delta < 0 && c == coords.length - 1)) //--Si se baja más del filtro (o se acaba el segmento bajando)\r\n                        {\r\n                            if (!previousUphill) //--Si en el segmento anterior también se bajaba, incrementamos el desnivel negativo acumulado\r\n                            {\r\n                                downhill -= delta;\r\n                            }\r\n                            else //--Si en el segmento anterior se subía, incrementamos los desniveles acumulados que no habíamos contabilizado desde el último salto del filtro (sector) \r\n                            {\r\n                                uphill += sectorMaxHeight - previousHeight;\r\n                                downhill -= height - sectorMaxHeight;\r\n                                previousUphill = false; //--preparar para el paso siguiente\r\n                            }\r\n                            previousHeight = height; //--preparar para el paso siguiente\r\n                            sectorMinHeight = height;\r\n                            sectorMaxHeight = height;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return {\r\n                    upHill: Math.round(uphill),\r\n                    downHill: Math.round(downhill)\r\n                };\r\n\r\n            } else { return null; }\r\n        },\r\n\r\n        isPlainObject: function (obj) {\r\n            // Not plain objects:\r\n            // - Any object or value whose internal [[Class]] property is not \"[object Object]\"\r\n            // - DOM nodes\r\n            // - window\r\n            if (typeof obj !== 'object' || obj.nodeType || obj.window === obj) {\r\n                return false;\r\n            }\r\n\r\n            if (obj.constructor &&\r\n                !hasOwn.call(obj.constructor.prototype, 'isPrototypeOf')) {\r\n                return false;\r\n            }\r\n\r\n            // If the function hasn't returned already, we're confident that\r\n            // |obj| is a plain object, created by {} or constructed with new Object\r\n            return true;\r\n        },\r\n\r\n        isEmptyObject: function (obj) {\r\n            var name;\r\n            for (name in obj) {\r\n                return false;\r\n            }\r\n            return true;\r\n        },\r\n\r\n        isFunction: function (obj) {\r\n            return typeof obj === 'function';\r\n        },\r\n\r\n        extend: function () {\r\n            var clone,\r\n                target = arguments[0] || {},\r\n                i = 1,\r\n                deep = false;\r\n\r\n            // Comprobar si hay que hacer copia profunda (primer parámetro === true)\r\n            if (typeof target === 'boolean') {\r\n                deep = target;\r\n\r\n                target = arguments[i] || {};\r\n                i++;\r\n            }\r\n\r\n            // Handle case when target is a string or something (possible in deep copy)\r\n            if (typeof target !== 'object' && !Util.isFunction(target)) {\r\n                target = {};\r\n            }\r\n\r\n            for (var len = arguments.length; i < len; i++) {\r\n                // Only deal with non-null/undefined values\r\n                const options = arguments[i];\r\n                if (options != null) {\r\n                    // Extend the base object\r\n                    for (var name in options) {\r\n                        const src = target[name];\r\n                        const copy = options[name];\r\n\r\n                        // Prevent never-ending loop\r\n                        if (target === copy) {\r\n                            continue;\r\n                        }\r\n\r\n                        // Recurse if we're merging plain objects or arrays\r\n                        const copyIsArray = Array.isArray(copy);\r\n                        if (deep && copy && (Util.isPlainObject(copy) || copyIsArray)) {\r\n                            if (copyIsArray) {\r\n                                clone = src && Array.isArray(src) ? src : [];\r\n\r\n                            } else {\r\n                                clone = src && Util.isPlainObject(src) ? src : {};\r\n                            }\r\n\r\n                            // Never move original objects, clone them\r\n                            target[name] = Util.extend(deep, clone, copy);\r\n\r\n                            // Don't bring in undefined values\r\n                        } else if (copy !== undefined) {\r\n                            target[name] = copy;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Return the modified object\r\n            return target;\r\n        },\r\n\r\n        getMapLocale: function (map) {\r\n            return map.options && map.options.locale && map.options.locale.replace('_', '-') || \"es-ES\";\r\n        },\r\n\r\n        regex: {\r\n            PROTOCOL: /(^https?:)/i\r\n        },\r\n\r\n        isOnCapabilities: function (url) {\r\n            var withProtocol = arguments.length == 2 ? arguments[1] : true;\r\n            var testUrl = !withProtocol ? url.replace(TC.Util.regex.PROTOCOL, \"\") : url;\r\n\r\n            if (withProtocol) {\r\n                if (TC.capabilities[testUrl])\r\n                    return url;\r\n            } else {\r\n                for (var c in TC.capabilities) {\r\n                    if (c.replace(TC.Util.regex.PROTOCOL, \"\") == testUrl)\r\n                        return c;\r\n                }\r\n            }\r\n\r\n            for (c in TC.capabilities) {\r\n                var u = getOnPath(TC.capabilities[c], path1, 0) || getOnPath(TC.capabilities[c], path2, 0);\r\n\r\n                if (u && withProtocol && url == u) return u;\r\n                else if (u && url.replace(TC.Util.regex.PROTOCOL, \"\") == u.replace(TC.Util.regex.PROTOCOL, \"\")) return u;\r\n            }\r\n\r\n            return url;\r\n        },\r\n\r\n        reqGetMapOnCapabilities: function (url) {\r\n            var withProtocol = arguments.length == 2 ? arguments[1] : true;\r\n            var testUrl = !withProtocol ? url.replace(TC.Util.regex.PROTOCOL, \"\") : url;\r\n\r\n            var _get = function (caps) {\r\n                var u = getOnPath(caps, path1, 0) || getOnPath(caps, path2, 0);\r\n                if (u)\r\n                    return !withProtocol ? u.split('?')[0].replace(TC.Util.regex.PROTOCOL, \"\") : u.split('?')[0];\r\n\r\n                return null;\r\n            };\r\n            if (TC.capabilities[url]) {\r\n                return _get(TC.capabilities[url]);\r\n            }\r\n\r\n            return null;\r\n        },\r\n\r\n        getFnFromString: function (fnName) {\r\n            var scope = window;\r\n            var scopeSplit = fnName.split('.');\r\n            for (i = 0; i < scopeSplit.length - 1; i++) {\r\n                scope = scope[scopeSplit[i]];\r\n\r\n                if (scope == undefined) return;\r\n            }\r\n\r\n            return scope[scopeSplit[scopeSplit.length - 1]];\r\n        },\r\n\r\n        isURL: function (text) {\r\n            return /^(http|https|ftp|mailto)\\:\\/\\//i.test(text);\r\n        },\r\n\r\n        isSecureURL: function (url) {\r\n            //sino empieza por http ni por https la consideramos segura\r\n            if (!/^(f|ht)tps?:\\/\\//i.test(url))\r\n                return true;\r\n            return (/^(f|ht)tps:\\/\\//i.test(url));\r\n        },\r\n\r\n        isSameOrigin: function (uri) {\r\n            var result = uri.indexOf(\"http\") !== 0 && uri.indexOf(\"//\") !== 0;\r\n            var urlParts = !result && uri.match(TC.Consts.url.SPLIT_REGEX);\r\n            if (urlParts) {\r\n                var location = window.location;\r\n                var uProtocol = urlParts[1];\r\n                result =\r\n                    (uProtocol == location.protocol || uProtocol == undefined) &&\r\n                    urlParts[3] == location.hostname;\r\n                var uPort = urlParts[4], lPort = location.port;\r\n                if (uPort != 80 && uPort !== \"\" || lPort != \"80\" && lPort !== \"\") {\r\n                    result = result && uPort == lPort;\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n\r\n        formatNumber: function (value, locale) {\r\n            var t = typeof value;\r\n            if (t === 'number') {\r\n                return value.toLocaleString(locale);\r\n            }\r\n            else if (t === 'string') {\r\n                n = parseFloat(value);\r\n                if (n === new Number(value).valueOf()) {\r\n                    return n.toLocaleString(locale);\r\n                }\r\n            }\r\n            return value;\r\n        },\r\n\r\n        addProtocol: function (uri) {\r\n            var result = uri;\r\n            if (uri && uri.indexOf('//') === 0) {\r\n                result = location.protocol + uri;\r\n            }\r\n            return result;\r\n        },\r\n\r\n        /* \r\n        * getDiv: returns HTML element or null if the parameter is invalid\r\n        * Parameter: string with element ID or HTML element\r\n        */\r\n        getDiv: function (div) {\r\n            var result;\r\n            if (typeof div === 'string') {\r\n                result = document.getElementById(div);\r\n            }\r\n            else if (div instanceof HTMLElement) {\r\n                result = div;\r\n            }\r\n            else if (div && '$' in window && div instanceof $ && div.length) {\r\n                result = div[0];\r\n            }\r\n            else {\r\n                result = document.createElement('div');\r\n            }\r\n            return result;\r\n        },\r\n\r\n        getScriptLocation: function () {\r\n            var src;\r\n            var script;\r\n            if (document.currentScript) {\r\n                script = document.currentScript;\r\n            }\r\n            else {\r\n                var scripts = document.getElementsByTagName('script');\r\n                script = scripts[scripts.length - 1];\r\n            }\r\n            src = script.getAttribute('src');\r\n            if (src) {\r\n                return src.substr(0, src.lastIndexOf('/') + 1);\r\n            }\r\n            return \"\";\r\n        },\r\n\r\n        /* \r\n        * getBackgroundUrlFromCss: devuelve la URL de background-image en CSS\r\n        * Parameter: string con nombre de clase\r\n        */\r\n        getBackgroundUrlFromCss: function (cssClass) {\r\n            var result = '';\r\n\r\n            if (cssClass) {\r\n                if (iconUrlCache[cssClass] !== undefined) {\r\n                    result = iconUrlCache[cssClass];\r\n                }\r\n                else {\r\n                    const iconDiv = document.createElement('div');\r\n                    iconDiv.style.display = 'none';\r\n                    iconDiv.classList.add(cssClass);\r\n                    document.body.appendChild(iconDiv);\r\n                    // The regular expression is nongreedy (.*?), otherwise in FF and IE it gets 'url_to_image\"'\r\n                    var match = /^url\\(['\"]?(.*?)['\"]?\\)$/gi.exec(window.getComputedStyle(iconDiv, null).backgroundImage);\r\n                    if (match && match.length > 1) {\r\n                        result = match[match.length - 1];\r\n                    }\r\n                    iconDiv.parentElement.removeChild(iconDiv);\r\n                    iconUrlCache[cssClass] = result;\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n\r\n        getPointIconUrl: function getPointIconUrl(options) {\r\n            var result = null;\r\n            if (options.url) {\r\n                result = options.url;\r\n            }\r\n            else {\r\n                var className;\r\n                if (typeof options.cssClass === 'string') {\r\n                    className = options.cssClass;\r\n                }\r\n                else {\r\n                    var classes = options.classes || TC.Cfg.styles.marker.classes;\r\n                    className = classes[0];\r\n                    if (options.group) {\r\n                        if (markerGroupClassCache[options.group] === undefined) {\r\n                            var i = 0;\r\n                            for (var key in markerGroupClassCache) {\r\n                                i++;\r\n                            }\r\n                            i = i % classes.length;\r\n                            markerGroupClassCache[options.group] = classes[i];\r\n                        }\r\n                        className = markerGroupClassCache[options.group];\r\n                    }\r\n                }\r\n                result = TC.Util.getBackgroundUrlFromCss(className);\r\n            }\r\n            if (!result && options !== TC.Cfg.styles.point && options.cssClass !== '') {\r\n                result = getPointIconUrl(TC.Cfg.styles.point);\r\n            }\r\n            return result;\r\n        },\r\n\r\n        getLegendImageFromStyle: function (style, options) {\r\n            let result = null;\r\n            options = options || {};\r\n            if (style.url) {\r\n                result = style.url;\r\n            }\r\n            else {\r\n                let width = options.width || 32;\r\n                let height = options.height || 16;\r\n                const strokeWidth = style.strokeWidth || 0;\r\n                const strokeHalfWidth = strokeWidth / 2;\r\n                const diameter = (style.radius || 0) * 2 + strokeWidth;\r\n                const lineDashText = style.lineDash ? `stroke-dasharray=\"${style.lineDash.join(' ')}\" ` : '';\r\n                let body;\r\n                width = Math.max(width, diameter);\r\n                height = Math.max(height, diameter);\r\n                switch (options.geometryType) {\r\n                    case TC.Consts.geom.POINT:\r\n                        body = `<circle cx=\"${width / 2}\" cy=\"${height / 2}\" r=\"${style.radius}\" stroke=\"${style.strokeColor}\" stroke-width=\"${strokeWidth}\" fill=\"${style.fillColor}\" fill-opacity=\"${style.fillOpacity}\" ${lineDashText}/>`;\r\n                        break;\r\n                    case TC.Consts.geom.POLYLINE:\r\n                        const xStart = strokeHalfWidth;\r\n                        const yStart = height - strokeHalfWidth;\r\n                        const xEnd = width - strokeHalfWidth;\r\n                        const yEnd = strokeHalfWidth;\r\n                        body = `<polyline points=\"${xStart},${yStart} ${xEnd},${yEnd}\" style=\"stroke:${style.strokeColor};stroke-width:${strokeWidth}\" ${lineDashText}/>`;\r\n                        break;\r\n                    case TC.Consts.geom.POLYGON:\r\n                        const x1 = strokeHalfWidth;\r\n                        const y1 = height - strokeHalfWidth;\r\n                        const x2 = strokeHalfWidth;\r\n                        const y2 = strokeHalfWidth;\r\n                        const x3 = strokeHalfWidth + width * 0.8;\r\n                        const y3 = strokeHalfWidth;\r\n                        const x4 = width - strokeHalfWidth;\r\n                        const y4 = height - strokeHalfWidth;\r\n                        body = `<polygon points=\"${x1},${y1} ${x2},${y2} ${x3},${y3} ${x4},${y4}\" style=\"stroke:${style.strokeColor};stroke-width:${strokeWidth};fill:${style.fillColor};fill-opacity:${style.fillOpacity}\" ${lineDashText}/>`;\r\n                        break;\r\n                    default:\r\n                        body = `<rect x=\"${strokeHalfWidth}\" x=\"${strokeHalfWidth}\" width=\"${width - strokeWidth}\" height=\"${height - strokeWidth}\" style=\"stroke:${style.strokeColor};stroke-width:${strokeWidth};fill:${style.fillColor};fill-opacity:${style.fillOpacity}\" ${lineDashText}/>`;\r\n                        break;\r\n                }\r\n                result = 'data:image/svg+xml,' + encodeURIComponent(`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${width}\" height=\"${height}\">${body}</svg>`);\r\n            }\r\n            return result;\r\n        },\r\n\r\n        /* \r\n        * addPathToTree: añade a un array a un árbol, cada elemento en un nivel anidado\r\n        * Parameters: array, nodo de árbol, [índice]\r\n        * Returns: último nodo insertado, null si ya existía la ruta\r\n        */\r\n        addArrayToTree: function addArrayToTree(path, treeNode, index) {\r\n            var result = null;\r\n            var found = false;\r\n            index = index || 0;\r\n            var name = path[index];\r\n            if (name) {\r\n                var n;\r\n                for (var i = 0, len = treeNode.children.length; i < len; i++) {\r\n                    n = treeNode.children[i];\r\n                    if (n.name === name) {\r\n                        found = true;\r\n                        var r = addArrayToTree(path, n, index + 1);\r\n                        if (r) {\r\n                            result = r;\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n                if (!found) {\r\n                    n = { name: name, title: name, uid: '/' + path.slice(0, index + 1).join('/'), children: [] };\r\n                    treeNode.children.push(n);\r\n                    result = n;\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n\r\n        parseCoords: function (text) {\r\n            var result = null;\r\n\r\n            var _parseGeoCoord = function (text) {\r\n                var t = text;\r\n                var result = {};\r\n                result.type = TC.Consts.GEOGRAPHIC;\r\n                var idx = t.indexOf('\\u00B0');\r\n                result.value = parseFloat(t.substr(0, idx));\r\n                t = t.substr(idx + 1);\r\n                idx = t.indexOf('\\'');\r\n                if (idx >= 0) {\r\n                    var v = parseFloat(t.substr(0, idx)) / 60;\r\n                    if (result.value >= 0) {\r\n                        result.value += v;\r\n                    }\r\n                    else {\r\n                        result.value -= v;\r\n                    }\r\n                    t = t.substr(idx + 1);\r\n                    idx = t.indexOf('\\'');\r\n                    if (idx >= 0) {\r\n                        v = parseFloat(t.substr(0, idx).replace(',', '.')) / 3600;\r\n                        if (result.value >= 0) {\r\n                            result.value += v;\r\n                        }\r\n                        else {\r\n                            result.value -= v;\r\n                        }\r\n                    }\r\n                }\r\n                return result;\r\n            };\r\n\r\n            var _parseCoord = function (text) {\r\n                var t = text.trim();\r\n                // nnºnn'nn''N\r\n                if (t.match(/^1?\\d{0,2}\\s*\\u00B0(\\s*\\d{1,2}\\s*'(\\s*\\d{1,2}([.,]\\d+)?\\s*'')?)?\\s*[NnSsWwOoEe]$/g)) {\r\n                    switch (t[t.length - 1]) {\r\n                        case 'S':\r\n                        case 's':\r\n                        case 'W':\r\n                        case 'w':\r\n                        case 'O':\r\n                        case 'o':\r\n                            t = '-' + t;\r\n                            break;\r\n                    }\r\n                    t = t.substr(0, t.length - 1);\r\n                    return _parseGeoCoord(t);\r\n                }\r\n                // +nnºnn'nn''\r\n                if (t.match(/^[+-]?1?\\d{0,2}\\s*\\u00B0(\\s*\\d{1,2}\\s*'(\\s*\\d{1,2}([.,]\\d+)?\\s*'')?)?$/g)) {\r\n                    return _parseGeoCoord(t);\r\n                }\r\n                // nn.nn N\r\n                if (t.match(/^1?\\d{0,2}([.,]\\d+)?\\s*\\u00B0?\\s*[NnSsWwOoEe]$/g)) {\r\n                    var result = { type: TC.Consts.GEOGRAPHIC, value: parseFloat(t.substr(0, t.length - 1).replace(',', '.')) };\r\n                    if (t.match(/[SsWwOo]$/)) {\r\n                        result.value = -result.value;\r\n                    }\r\n                    return result;\r\n                }\r\n                // +nn.nn\r\n                if (t.match(/^[+-]?1?\\d{0,2}([.,]\\d+)?\\s*\\u00B0?$/g)) {\r\n                    return { type: TC.Consts.GEOGRAPHIC, value: parseFloat(t.replace(',', '.')) };\r\n                }\r\n                // UTM\r\n                if (t.match(/^[-+]?\\d{6,7}([.,]\\d+)?$/g)) {\r\n                    return { type: TC.Consts.UTM, value: parseFloat(t.replace(',', '.')) };\r\n                }\r\n                return null;\r\n            };\r\n\r\n            text = text.trim().toUpperCase();\r\n            var xy = text.split(',');\r\n            if (xy.length === 4) {\r\n                xy = [xy.slice(0, 1).join('.'), xy.slice(2, 3).join('.')];\r\n            }\r\n            else if (xy.length === 1 || xy.length === 3) {\r\n                xy = text.split(' ');\r\n            }\r\n            if (xy.length === 2) {\r\n                var x = _parseCoord(xy[0]);\r\n                var y = _parseCoord(xy[1]);\r\n                if (x !== null && y !== null) {\r\n                    result = [x, y];\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n\r\n        reproject: function (coords, sourceCrs, targetCrs) {\r\n            var result;\r\n            var multipoint = true;\r\n            var multiring = true;\r\n            var multipoly = true;\r\n            if (Array.isArray(coords[0])) {\r\n                if (Array.isArray(coords[0][0])) {\r\n                    if (!Array.isArray(coords[0][0][0])) {\r\n                        multipoly = false;\r\n                        coords = [coords];\r\n                    }\r\n                }\r\n                else {\r\n                    multiring = false;\r\n                    coords = [[coords]];\r\n                }\r\n            }\r\n            else {\r\n                multipoint = false;\r\n                multiring = false;\r\n                multipoly = false;\r\n                coords = [[[coords]]];\r\n            }\r\n            TC.loadProjDef({ crs: sourceCrs, sync: true });\r\n            TC.loadProjDef({ crs: targetCrs, sync: true });\r\n            var sourcePrj = proj4(proj4.defs[sourceCrs]);\r\n            var targetPrj = proj4(proj4.defs[targetCrs]);\r\n            result = new Array(coords.length);\r\n            coords.forEach(function (poly, pidx) {\r\n                const rp = result[pidx] = [];\r\n                poly.forEach(function (ring, ridx) {\r\n                    const rr = rp[ridx] = [];\r\n                    ring.forEach(function (coord, cidx) {\r\n                        if (Array.isArray(coord) && coord.length > 1) {\r\n                            var point = proj4(sourcePrj, targetPrj, { x: coord[0], y: coord[1] });\r\n                            rr[cidx] = [point.x, point.y];\r\n                            if (coord.length > 2) {\r\n                                rr[cidx][2] = coord[2];\r\n                            }\r\n                        } else {\r\n                            rr[cidx] = coord;\r\n                        }\r\n                    });\r\n                });\r\n            });\r\n            if (!multipoint) {\r\n                result = result[0][0][0];\r\n            }\r\n            else if (!multiring) {\r\n                result = result[0][0];\r\n            }\r\n            else if (!multipoly) {\r\n                result = result[0];\r\n            }\r\n            return result;\r\n        },\r\n\r\n        getMetersPerDegree: function (extent) {\r\n            let result = undefined;\r\n            const R = 6370997; // m\r\n            if (Array.isArray(extent) && extent.length >= 4) {\r\n                if (extent[3] === extent[1]) {\r\n                    result = Math.PI * R * Math.cos(this.degToRad(extent[1])) / 180;\r\n                }\r\n                else {\r\n                    const dLat = this.degToRad(extent[3] - extent[1]);\r\n                    const sindlat2 = Math.sin(dLat / 2);\r\n                    const a = sindlat2 * sindlat2;\r\n                    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n                    result = R * c / (extent[3] - extent[1]);\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n\r\n        radToDeg: function (rad) { // convert radians to degrees\r\n            return rad * 180 / Math.PI;\r\n        },\r\n        degToRad: function (deg) { // convert degrees to radians\r\n            return deg * Math.PI / 180;\r\n        },\r\n        mod: function (n) { // modulo for negative values\r\n            return ((n % (2 * Math.PI)) + (2 * Math.PI)) % (2 * Math.PI);\r\n        },\r\n\r\n        getCRSCode: function (crs) {\r\n            var result = null;\r\n            crs = crs.trim();\r\n            if (/^EPSG:\\d{4,6}$/g.test(crs) || //formato EPSG\r\n                /^urn:ogc:def:crs:EPSG:.*:\\d{4,6}/g.test(crs) || // formato URN\r\n                /http:\\/\\/www.opengis.net\\/gml\\/srs\\/epsg.xml#\\d{4,6}$/g.test(crs)) { // formato GML\r\n                var match = crs.trim().match(/^.+[:#](\\d{4,6})$/); // devuelve la parte numérica del código\r\n                if (match) {\r\n                    result = match[1];\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n\r\n        CRSCodesEqual: function (crs1, crs2) {\r\n            if (crs1 === crs2) {\r\n                return true;\r\n            }\r\n            var code1 = this.getCRSCode(crs1);\r\n            var code2 = this.getCRSCode(crs2);\r\n            return code1 !== null && code2 !== null && code1 === code2;\r\n        },\r\n\r\n        getLocaleString: function (locale, key, texts) {\r\n            var result = key;\r\n            if (TC.i18n && TC.i18n[locale]) {\r\n                var text = TC.i18n[locale][key];\r\n                if (text) {\r\n                    result = text;\r\n                    if (texts) {\r\n                        for (var k in texts) {\r\n                            result = result.replace('{' + k + '}', texts[k]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n\r\n        getSimpleMimeType: function (mimeType) {\r\n            var result = '';\r\n            if (mimeType) {\r\n                var end = mimeType.indexOf(';');\r\n                if (end > 0) {\r\n                    mimeType = mimeType.substring(0, end);\r\n                }\r\n                result = mimeType;\r\n            }\r\n            return result;\r\n        },\r\n\r\n        getQueryStringParams: function (url) {\r\n            var queryString;\r\n            if (url) {\r\n                var queryIdx = url.indexOf('?');\r\n                if (queryIdx >= 0) {\r\n                    queryString = url.substr(queryIdx);\r\n                    var fragmentIdx = queryString.indexOf('#');\r\n                    if (fragmentIdx >= 0) {\r\n                        queryString = queryString.substr(0, fragmentIdx)\r\n                    }\r\n                }\r\n                else {\r\n                    queryString = '?';\r\n                }\r\n            }\r\n            else {\r\n                queryString = location.search;\r\n            }\r\n            var result = queryString.replace(/(^\\?)/, '').split(\"&\").map(function (elm) {\r\n                return elm = elm.split(\"=\"), this[elm[0]] = elm[1], this\r\n            }.bind({}))[0];\r\n            delete result[''];\r\n            return result;\r\n        },\r\n\r\n        getParamString: function (obj) {\r\n            const arr = [];\r\n            for (var key in obj) {\r\n                arr.push(encodeURIComponent(key) + '=' + encodeURIComponent(obj[key]));\r\n            }\r\n            return arr.join('&').replace(/%20/g, '+');\r\n        },\r\n\r\n        fastUnshift: function (a, elm) {\r\n            var len = a.length;\r\n            while (len) {\r\n                a[len] = a[len - 1];\r\n                len--;\r\n            }\r\n            a[0] = elm;\r\n        },\r\n\r\n        storage: {\r\n            getCookie: function (key) {\r\n                return TC.cookie(key);\r\n            },\r\n            setCookie: function (key, value, options) {\r\n                return TC.cookie(key, value, options);\r\n            },\r\n            getLocalValue: function (key) {\r\n                var result = null;\r\n                if (localStorage && localStorage instanceof Storage) {\r\n                    result = localStorage.getItem(key);\r\n                }\r\n                else {\r\n                    result = TC.Util.storage.getCookie(key);\r\n                }\r\n                return result;\r\n            },\r\n            setLocalValue: function (key, value) {\r\n                if (localStorage && localStorage instanceof Storage) {\r\n                    if (value === undefined) {\r\n                        localStorage.removeItem(key);\r\n                    }\r\n                    else {\r\n                        localStorage.setItem(key, value);\r\n                    }\r\n                }\r\n                else {\r\n\r\n                    if (value === undefined) {\r\n                        var exDate = new Date();\r\n                        exDate.setDate(exDate.getDate() - 1);\r\n                        TC.Util.storage.setCookie(key, \"\", { expires: exDate });\r\n                    }\r\n                    else {\r\n                        TC.Util.storage.setCookie(key, value);\r\n                    }\r\n                }\r\n                return key;\r\n            },\r\n            getSessionLocalValue: function (key) {\r\n                var result = null;\r\n                if (sessionStorage && sessionStorage instanceof Storage) {\r\n                    result = sessionStorage.getItem(key);\r\n                }\r\n                else {\r\n                    result = TC.Util.storage.getCookie(key);\r\n                }\r\n                return result;\r\n            },\r\n            setSessionLocalValue: function (key, value) {\r\n                if (sessionStorage && sessionStorage instanceof Storage) {\r\n                    if (value === undefined) {\r\n                        sessionStorage.removeItem(key);\r\n                    }\r\n                    else {\r\n                        sessionStorage.setItem(key, value);\r\n                    }\r\n                }\r\n                else {\r\n\r\n                    if (value === undefined) {\r\n                        var exDate = new Date();\r\n                        exDate.setDate(exDate.getDate() - 1);\r\n                        TC.Util.storage.setCookie(key, \"\", { expires: exDate });\r\n                    }\r\n                    else {\r\n                        TC.Util.storage.setCookie(key, value);\r\n                    }\r\n                }\r\n                return key;\r\n            }\r\n        },\r\n        detectFirefox: function () {\r\n            if (/Firefox[\\/\\s](\\d+\\.\\d+)/.test(navigator.userAgent)) //test for Firefox/x.x or Firefox x.x (ignoring remaining digits);\r\n                return new Number(RegExp.$1); // capture x.x portion and store as a number\r\n            else\r\n                return false;\r\n        },\r\n        detectIE: function () {\r\n            var ua = window.navigator.userAgent;\r\n\r\n            var msie = ua.indexOf('MSIE ');\r\n            if (msie > 0) {\r\n                // IE 10 or older => return version number\r\n                return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\r\n            }\r\n\r\n            var trident = ua.indexOf('Trident/');\r\n            if (trident > 0) {\r\n                // IE 11 => return version number\r\n                var rv = ua.indexOf('rv:');\r\n                return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\r\n            }\r\n\r\n            // GLS: 13/02/2019. Comento lo que respecta a Edge, no tiene sentido meterlo en el mismo saco que un navegador obsoleto.\r\n            // No lo comento porque en la mesa no hay quorum.\r\n            var edge = ua.indexOf('Edge/');\r\n            if (edge > 0) {\r\n                // IE 12 => return version number\r\n                return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);\r\n            }\r\n\r\n            // other browser\r\n            return false;\r\n        },\r\n        detectChrome: function () {\r\n            return window.chrome;\r\n\r\n        },\r\n        detectSafari: function () {\r\n            return !!navigator.userAgent.match(/Version\\/[\\d\\.]+.*Safari/);\r\n        },\r\n        detectMouse: function () {\r\n            const matchesCoarse = matchMedia('(pointer:coarse)').matches;\r\n            const matchesFine = matchMedia('(pointer:fine)').matches;\r\n            if (matchesCoarse && matchesFine) {\r\n                return true;\r\n            }\r\n            if (matchesCoarse && !matchesFine) {\r\n                var testHover = function () {\r\n                    //console.log('estamos en testHover');\r\n                    var mq = '(hover: hover)',\r\n                        hover = !TC.browserFeatures.touch(), // fallback if mq4 not supported: no hover for touch\r\n                        mqResult;\r\n\r\n                    mqResult = window.matchMedia(mq);\r\n                    //console.log('resultado de window.matchMedia(mq): ' + mqResult.media);\r\n                    //console.log('mq: ' + mq);\r\n                    if (mqResult.media === mq) {\r\n                        //console.log('es igual');\r\n                        // matchMedia supports hover detection, so we rely on that\r\n                        hover = mqResult.matches;\r\n                        //console.log('va retornar: ' + hover);\r\n                    }\r\n\r\n                    return hover;\r\n                };\r\n\r\n                if (testHover())\r\n                    return true;\r\n                else return false;\r\n            }\r\n            if (!matchesCoarse && matchesFine) {\r\n                return true;\r\n            }\r\n            if (matchMedia('(pointer:none)').matches) {\r\n                return false;\r\n            }\r\n            if (!TC.browserFeatures.touch()) {\r\n                return true;\r\n            }\r\n        },\r\n        detectAndroid: function () {\r\n            return navigator.userAgent.match(/Android/i);\r\n        },\r\n        detectBlackBerry: function () {\r\n            return navigator.userAgent.match(/BlackBerry/i);\r\n        },\r\n        detectIOS: function () {\r\n            return navigator.userAgent.match(/iPhone|iPad|iPod/i);\r\n        },\r\n        detectMobileWindows: function () {\r\n            return navigator.userAgent.match(/IEMobile/i);\r\n        },\r\n        detectMobile: function () {\r\n            return (TC.Util.detectAndroid() || TC.Util.detectIOS() || TC.Util.detectMobileWindows() || TC.Util.detectBlackBerry());\r\n        },\r\n        getBrowser: function () {\r\n            if (!window.UAParser) {\r\n                TC.syncLoadJS(TC.apiLocation + TC.Consts.url.UA_PARSER);\r\n            }\r\n\r\n            var parser = new UAParser();\r\n            var browser = parser.getBrowser();\r\n            return { name: browser.name, version: browser.major };\r\n        },\r\n        getElementByNodeName: function (parentNode, nodeName) {\r\n            var colonIndex = nodeName.indexOf(\":\");\r\n            var tag = nodeName.substr(colonIndex + 1);\r\n            var nodes = parentNode.getElementsByTagNameNS(\"*\", tag);\r\n\r\n            for (var i = 0; i < nodes.length; i++) {\r\n                if (nodes[i].nodeName == nodeName)\r\n                    return nodes;\r\n            }\r\n            return undefined;\r\n        },\r\n        addURLParameters: function (url, parameters) {\r\n            if (!parameters) {\r\n                return url;\r\n            }\r\n            var toAdd = Object.keys(parameters).map(function (key) {\r\n                return encodeURIComponent(key) + '=' + (parameters[key] ? encodeURIComponent(parameters[key]) : '');\r\n            }).join('&');\r\n\r\n            var urlparts = url.split('?');\r\n            if (urlparts.length >= 2) {\r\n\r\n                var params = urlparts[1].split(/[&;]/g);\r\n                params.push(toAdd);\r\n\r\n                url = urlparts[0] + '?' + params.join('&');\r\n                return url;\r\n            } else {\r\n                urlparts = url.split('#');\r\n                if (urlparts.length >= 2) {\r\n                    urlparts.shift();\r\n                    url = urlparts[0] + '?' + toAdd + '#' + urlparts.join('#');\r\n                    return url;\r\n                }\r\n                else {\r\n                    url = url + '?' + toAdd;\r\n                    return url;\r\n                }\r\n            }\r\n        },\r\n        removeURLParameter: function (url, parameter) {\r\n            var urlparts = url.split('?');\r\n            if (urlparts.length >= 2) {\r\n\r\n                var prefix = encodeURIComponent(parameter.toLowerCase()) + '=';\r\n                var pars = urlparts[1].toLowerCase().split(/[&;]/g);\r\n\r\n                //reverse iteration as may be destructive\r\n                for (var i = pars.length; i-- > 0;) {\r\n                    //idiom for string.startsWith\r\n                    if (pars[i].lastIndexOf(prefix, 0) !== -1) {\r\n                        pars.splice(i, 1);\r\n                    }\r\n                }\r\n\r\n                url = urlparts[0] + '?' + pars.join('&');\r\n                return url;\r\n            } else {\r\n                return url;\r\n            }\r\n        },\r\n\r\n        showModal: function (contentNode, options) {\r\n            options = options || {};\r\n\r\n            contentNode.hidden = false;\r\n            if (window.$ && contentNode instanceof $) {\r\n                contentNode = contentNode.get(0);\r\n            }\r\n            contentNode.classList.add(TC.Consts.classes.VISIBLE);\r\n            const closeButton = contentNode.querySelectorAll('.tc-modal-close');\r\n            if (closeButton && closeButton.length > 0) {\r\n                for (var i = 0; i < closeButton.length; i++) {\r\n                    var closeCallback = modalCloseHandlers.get(closeButton[i]);\r\n                    if (closeCallback) {\r\n                        modalCloseHandlers.delete(closeButton[i]);\r\n                    }\r\n                    else {\r\n                        closeCallback = function (e) {\r\n                            e.stopPropagation();\r\n                            return TC.Util.closeModal(options.closeCallback, e.target);\r\n                        };\r\n                        modalCloseHandlers.set(closeButton[i], closeCallback);\r\n                    }\r\n                    modalCloseHandlers.set(closeButton[i], closeCallback);\r\n                    closeButton[i].addEventListener('click', closeCallback);\r\n                    if (Util.isFunction(options.openCallback)) {\r\n                        options.openCallback();\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        closeModal: function (callback, target) {\r\n\r\n            const hide = function (modal) {\r\n                modal.classList.remove(TC.Consts.classes.VISIBLE);\r\n            };\r\n\r\n            var modal;\r\n            if (target) {\r\n                modal = target;\r\n                while (modal && !modal.matches('.tc-modal')) {\r\n                    modal = modal.parentElement;\r\n                }\r\n\r\n                hide(modal);\r\n            } else {\r\n                Array.prototype.forEach.call(document.querySelectorAll('.tc-modal'), function (modal) {\r\n                    hide(modal);\r\n                });\r\n            }\r\n\r\n            if (callback) {\r\n                callback();\r\n            }\r\n        },\r\n\r\n        closeAlert: function (btn) {\r\n            var elm = btn;\r\n            do {\r\n                elm = elm.parentElement;\r\n                if (elm.matches('.tc-alert')) {\r\n                    elm.style.display = 'none';\r\n                }\r\n            }\r\n            while (elm);\r\n        },\r\n\r\n        swipe: function (target, options) {\r\n            const addListeners = function (handlers) {\r\n                target.addEventListener('mousedown', handlers.start);\r\n                target.addEventListener('touchstart', handlers.start, { passive: true });\r\n                target.addEventListener('mouseup', handlers.end);\r\n                target.addEventListener('touchend', handlers.end, { passive: true });\r\n            };\r\n\r\n            if (options === 'disable') {\r\n                const handlers = swipeHandlers.get(target);\r\n                if (handlers) {\r\n                    target.removeEventListener('mousedown', handlers.start);\r\n                    target.removeEventListener('touchstart', handlers.start);\r\n                    target.removeEventListener('mouseup', handlers.end);\r\n                    target.removeEventListener('touchend', handlers.end);\r\n                }\r\n                return;\r\n            }\r\n            else if (options === 'enable') {\r\n                const handlers = swipeHandlers.get(target);\r\n                if (handlers) {\r\n                    addListeners(handlers);\r\n                }\r\n                return;\r\n            }\r\n\r\n            options = options || {};\r\n            const minDistance = options.minDistance || 30;\r\n            const maxCrossDistance = options.maxCrossDistance || 30;\r\n            const maxAllowedTime = options.maxAllowedTime || 1000;\r\n            var touchStartCoords = { 'x': -1, 'y': -1 }, // X and Y coordinates on mousedown or touchstart events.\r\n                touchEndCoords = { 'x': -1, 'y': -1 },// X and Y coordinates on mouseup or touchend events.\r\n                startTime = 0,// Time on swipeStart\r\n                elapsedTime = 0;// Elapsed time between swipeStart and swipeEnd\r\n\r\n            const getDirection = function (startCoords, endCoords) {\r\n                const dx = endCoords.x - startCoords.x;\r\n                const dy = endCoords.y - startCoords.y;\r\n                const adx = Math.abs(dx);\r\n                const ady = Math.abs(dy);\r\n                if (adx > ady && adx > minDistance && ady <= maxCrossDistance) {\r\n                    return dx < 0 ? 'left' : 'right';\r\n                }\r\n                if (ady > adx && ady > minDistance && adx <= maxCrossDistance) {\r\n                    return dy < 0 ? 'up' : 'down';\r\n                }\r\n                return 'none';\r\n            };\r\n\r\n            const mustSwipe = function (e) {\r\n                if (options.noSwipe) {\r\n                    var elm = e.target;\r\n                    while (elm && elm !== target) {\r\n                        if (elm.matches && elm.matches(options.noSwipe)) {\r\n                            return false;\r\n                        }\r\n                        elm = elm.parentNode;\r\n                    }\r\n                }\r\n                return true;\r\n            };\r\n\r\n            const swipeStart = function (e) {\r\n                if (mustSwipe(e)) {\r\n                    e = 'changedTouches' in e ? e.changedTouches[0] : e;\r\n                    touchStartCoords.x = e.pageX;\r\n                    touchStartCoords.y = e.pageY;\r\n                    startTime = new Date().getTime();\r\n                }\r\n            };\r\n\r\n            const swipeEnd = function (e) {\r\n                if (startTime) {\r\n                    e = 'changedTouches' in e ? e.changedTouches[0] : e;\r\n                    touchEndCoords.x = e.pageX;\r\n                    touchEndCoords.y = e.pageY;\r\n                    elapsedTime = new Date().getTime() - startTime;\r\n                    if (elapsedTime <= maxAllowedTime) {\r\n                        const callback = options[getDirection(touchStartCoords, touchEndCoords)];\r\n                        if (callback) {\r\n                            callback.call(target);\r\n                        }\r\n                    }\r\n                    startTime = 0;\r\n                }\r\n            };\r\n\r\n            const handlers = {\r\n                start: swipeStart,\r\n                end: swipeEnd\r\n            };\r\n            swipeHandlers.set(target, handlers);\r\n            addListeners(handlers);\r\n        },\r\n\r\n        getParameterByName: function (name) {\r\n            name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\r\n            var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\", \"i\"),\r\n                results = regex.exec(location.search);\r\n            return results === null ? \"\" : decodeURIComponent(results[1].replace(/\\+/g, \" \"));\r\n        },\r\n\r\n        getLocaleUserChoice: function (options) {\r\n            var result = 'en-US';\r\n            options = options || {};\r\n            var cookieName = options.cookieName || 'SITNA.language';\r\n            var paramName = options.paramName || 'lang';\r\n            // Obtenemos preferencia de lenguaje\r\n            var browserLanguage = (navigator.languages && navigator.languages.length) ? navigator.languages[0] : navigator.language || navigator.userLanguage;\r\n            var lang = TC.Util.getParameterByName(paramName) || TC.Util.storage.getCookie(cookieName) || browserLanguage;\r\n            var hyphenIdx = lang.indexOf('-');\r\n            if (hyphenIdx >= 0) {\r\n                lang = lang.substr(0, hyphenIdx);\r\n            }\r\n            var expirationDate = new Date(new Date().getTime() + 365 * 24 * 60 * 60 * 1000);\r\n            TC.Util.storage.setCookie(cookieName, lang, { expires: expirationDate });\r\n\r\n            switch (lang) {\r\n                case 'eu':\r\n                    result = 'eu-ES';\r\n                    break;\r\n                case 'es':\r\n                    result = 'es-ES';\r\n                    break;\r\n                default:\r\n                    result = 'en-US';\r\n                    break;\r\n            }\r\n            return result;\r\n        },\r\n\r\n        getValidFilename: function (filename) {\r\n            return (filename || '').replace(/[/\\\\?%*:|\"<>]/g, '-');\r\n        },\r\n\r\n        downloadBlob: function (filename, blob) {\r\n            var link = document.createElement(\"a\");\r\n            if (link.download !== undefined) {\r\n                var url = URL.createObjectURL(blob);\r\n                link.setAttribute(\"href\", url);\r\n                link.setAttribute(\"download\", TC.Util.getValidFilename(filename));\r\n                link.style.visibility = 'hidden';\r\n                document.body.appendChild(link);\r\n                link.click();\r\n                document.body.removeChild(link);\r\n            }\r\n        },\r\n\r\n        downloadFile: function (filename, type, data) {\r\n            var blob = new Blob([data], { type: type });\r\n            filename = TC.Util.getValidFilename(filename);\r\n            if (navigator.msSaveBlob) { // IE 10+\r\n                navigator.msSaveBlob(blob, filename);\r\n            } else {\r\n                TC.Util.downloadBlob(filename, blob);\r\n            }\r\n        },\r\n\r\n        downloadDataURI: function (filename, type, dataURI) {\r\n            var binary = atob(dataURI.split(',')[1]);\r\n\r\n            var array = [];\r\n            for (var i = 0; i < binary.length; i++) {\r\n                array.push(binary.charCodeAt(i));\r\n            }\r\n            var blob = new Blob([new Uint8Array(array)], { type: type });\r\n\r\n            filename = TC.Util.getValidFilename(filename);\r\n            if (navigator.msSaveBlob) { // IE 10+\r\n                navigator.msSaveBlob(blob, filename);\r\n            } else {\r\n                TC.Util.downloadBlob(filename, blob);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Acorta una URL utilizando el servicio de Bit.ly. No funciona para URLs locales.\r\n         */\r\n        shortenUrl: function (url) {\r\n            return new Promise(function (resolve, reject) {\r\n                TC.ajax({\r\n                    url: \"https://api-ssl.bitly.com/v3/shorten\",\r\n                    data: { access_token: \"6c466047309f44bd8173d83e81491648b243ee3d\", longUrl: url },\r\n                })\r\n                    .then(function (response) {\r\n                        resolve(response.data);\r\n                    })\r\n                    .catch(function (e) {\r\n                        reject(e);\r\n                    });\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Convierte a Base64.\r\n         */\r\n        utf8ToBase64: function (str) {\r\n            return window.btoa(unescape(encodeURIComponent(str)));\r\n        },\r\n\r\n        /**\r\n         * Decodifica un string en Base64.\r\n         */\r\n        base64ToUtf8: function (str) {\r\n            var result;\r\n            try {\r\n                result = decodeURIComponent(escape(window.atob(str)));\r\n            }\r\n            catch (error) {\r\n                result = null;\r\n            }\r\n            return result;\r\n        },\r\n\r\n        colorArrayToString: function (color) {\r\n            if (Array.isArray(color)) {\r\n                color = color\r\n                    .slice(0, 3)\r\n                    .reduce(function (prev, cur) {\r\n                        const str = cur.toString(16);\r\n                        return prev + '00'.substring(0, 2 - str.length) + str;\r\n                    }, '#');\r\n            }\r\n            return color;\r\n        },\r\n\r\n        // Generic helper function that can be used for the three operations:        \r\n        operation: function (list1, list2, comparerFn, operationIsUnion) {\r\n            var result = [];\r\n\r\n            for (var i = 0; i < list1.length; i++) {\r\n                var item1 = list1[i],\r\n                    found = false;\r\n                for (var j = 0; j < list2.length; j++) {\r\n                    if (comparerFn(item1, list2[j])) {\r\n                        found = true;\r\n                        break;\r\n                    }\r\n                }\r\n                if (found === operationIsUnion) {\r\n                    result.push(item1);\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n        isSecureURL: function (url) {\r\n            //sino empieza por http ni por https la consideramos segura\r\n            if (!/^(f|ht)tps?:\\/\\//i.test(url))\r\n                return true;\r\n            return (/^(f|ht)tps:\\/\\//i.test(url));\r\n        },\r\n\r\n        // Following functions are to be used:\r\n        inBoth: function (list1, list2, comparerFn) {\r\n            return this.operation(list1, list2, comparerFn, true);\r\n        },\r\n\r\n        inFirstOnly: function (list1, list2, comparerFn) {\r\n            return this.operation(list1, list2, comparerFn, false);\r\n        },\r\n\r\n        inSecondOnly: function (list1, list2, comparerFn) {\r\n            return this.inFirstOnly(list2, list1, comparerFn);\r\n        },\r\n\r\n        toDataUrl: function (canvas, backgroundColour) {\r\n            var defaultOptions = { type: 'image/png', encoderOptions: 0.92 };\r\n\r\n            var _ref = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : defaultOptions,\r\n                type = _ref.type,\r\n                encoderOptions = _ref.encoderOptions;\r\n\r\n            var context = canvas.getContext('2d');\r\n\r\n            if (!context) {\r\n                return '';\r\n            }\r\n\r\n            var width = canvas.width;\r\n            var height = canvas.height;\r\n\r\n            var data = context.getImageData(0, 0, width, height);\r\n            var compositeOperation = context.globalCompositeOperation;\r\n\r\n            if (backgroundColour) {\r\n\r\n                context.globalCompositeOperation = 'destination-over';\r\n                context.fillStyle = backgroundColour;\r\n                context.fillRect(0, 0, width, height);\r\n            }\r\n\r\n            var imageData = canvas.toDataURL(type, encoderOptions);\r\n\r\n            if (backgroundColour) {\r\n                context.clearRect(0, 0, width, height);\r\n                context.putImageData(data, 0, 0);\r\n                context.globalCompositeOperation = compositeOperation;\r\n            }\r\n\r\n            return imageData;\r\n        },\r\n\r\n        imgToDataUrl: function (src, outputFormat) {\r\n\r\n            var createCanvas = function (img) {\r\n                var canvas = document.createElement('CANVAS');\r\n                var ctx = canvas.getContext('2d');\r\n                canvas.height = img.height;\r\n                canvas.width = img.width;\r\n                ctx.drawImage(img, 0, 0);\r\n\r\n                return canvas;\r\n            };\r\n\r\n            return new Promise(function (resolve, reject) {\r\n                if (!outputFormat) {\r\n                    switch (src.substr(src.lastIndexOf('.') + 1).toLowerCase()) {\r\n                        case 'svg':\r\n                            outputFormat: 'image/svg+xml';\r\n                            break;\r\n                        case 'png':\r\n                            outputFormat: 'image/png';\r\n                            break;\r\n                        case 'gif':\r\n                            outputFormat: 'image/gif';\r\n                            break;\r\n                        default:\r\n                            outputFormat = 'image/jpeg';\r\n                    }\r\n                }\r\n\r\n                var img = new Image();\r\n                img.crossOrigin = 'anonymous';\r\n                img.onload = function () {\r\n                    var canvas = createCanvas(img);\r\n                    var dataURL;\r\n\r\n                    try {\r\n                        dataURL = TC.Util.toDataUrl(canvas, '#ffffff', {\r\n                            type: outputFormat,\r\n                            encoderOptions: 1.0\r\n                        });\r\n                        resolve({ dataUrl: dataURL, canvas: canvas });\r\n                    } catch (error) {\r\n                        img.src = TC.proxify(src);\r\n                    }\r\n                };\r\n\r\n                img.onerror = function (error) {\r\n                    var xhr = new XMLHttpRequest();\r\n                    xhr.open('GET', TC.proxify(src), true);\r\n                    xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n\r\n                    xhr.responseType = 'arraybuffer';\r\n                    xhr.onload = function (e) {\r\n                        if (this.status === 200) {\r\n                            var uInt8Array = new Uint8Array(this.response);\r\n                            var i = uInt8Array.length;\r\n                            var binaryString = new Array(i);\r\n                            while (i--) {\r\n                                binaryString[i] = String.fromCharCode(uInt8Array[i]);\r\n                            }\r\n                            var data = binaryString.join('');\r\n                            var type = xhr.getResponseHeader('content-type');\r\n                            if (type.indexOf('image') === 0) {\r\n                                img.src = 'data:' + type + ';base64,' + window.btoa(data);\r\n                                img.onload = function () {\r\n                                    var canvas = createCanvas(img);\r\n                                    dataURL = TC.Util.toDataUrl(canvas, '#ffffff', {\r\n                                        type: outputFormat || 'image/jpeg',\r\n                                        encoderOptions: 1.0\r\n                                    });\r\n                                    resolve({ dataUrl: dataURL, canvas: canvas });\r\n                                }\r\n                            }\r\n                        }\r\n                    };\r\n                    xhr.onreadystatechange = function () {\r\n                        if (xhr.readyState === 4) {\r\n                            if (xhr.status !== 200) {\r\n                                reject(Error('HTTP error ' + xhr.status));\r\n                            }\r\n                        }\r\n                    };\r\n\r\n                    xhr.send();\r\n                };\r\n\r\n                img.src = src;\r\n                if (img.complete || img.complete === undefined) {\r\n                    img.src = \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==\";\r\n                    img.src = src;\r\n                }\r\n            });\r\n        },\r\n\r\n        imgTagToDataUrl: function (img, outputFormat) {\r\n            var createCanvas = function (img) {\r\n                var canvas = document.createElement('CANVAS');\r\n                var ctx = canvas.getContext('2d');\r\n                canvas.height = img.height;\r\n                canvas.width = img.width;\r\n                ctx.drawImage(img, 0, 0);\r\n\r\n                return canvas;\r\n            };\r\n\r\n            var canvas = createCanvas(img);\r\n            var dataURL;\r\n\r\n            try {\r\n                dataURL = TC.Util.toDataUrl(canvas, '#ffffff', {\r\n                    type: outputFormat || 'image/jpeg',\r\n                    encoderOptions: 1.0\r\n                });\r\n                return { base64: dataURL, canvas: canvas };\r\n            } catch (error) {\r\n                return null;\r\n            }\r\n        },\r\n\r\n        addToCanvas: function (canvas, img, position, size) {\r\n            var newCanvas = TC.Util.cloneCanvas(canvas);\r\n            var context = newCanvas.getContext('2d');\r\n\r\n            return new Promise(function (resolve, reject) {\r\n                var newImage = new Image();\r\n                img.crossOrigin = 'anonymous';\r\n                newImage.src = img;\r\n                newImage.onload = function () {\r\n                    if (size) {\r\n                        context.drawImage(newImage, position.x || 0, position.y || 0, size.width, size.height);\r\n                    } else {\r\n                        context.drawImage(newImage, position.x || 0, position.y || 0);\r\n                    }\r\n                    resolve(newCanvas);\r\n                }\r\n            });\r\n        },\r\n\r\n        cloneCanvas: function (oldCanvas) {\r\n            //create a new canvas\r\n            var newCanvas = document.createElement('canvas');\r\n            var context = newCanvas.getContext('2d');\r\n\r\n            //set dimensions\r\n            newCanvas.width = oldCanvas.width;\r\n            newCanvas.height = oldCanvas.height;\r\n\r\n            //apply the old canvas to the new one\r\n            context.drawImage(oldCanvas, 0, 0);\r\n\r\n            //return the new canvas\r\n            return newCanvas;\r\n        },\r\n\r\n        calculateAspectRatioFit: function (srcWidth, srcHeight, maxWidth, maxHeight) {\r\n            var ratio = Math.min(maxWidth / srcWidth, maxHeight / srcHeight);\r\n\r\n            return { width: srcWidth * ratio, height: srcHeight * ratio };\r\n        },\r\n\r\n        getFormattedDate: function (date, hasTime) {\r\n            function pad(s) { return (s < 10) ? '0' + s : s; }\r\n\r\n            var d = new Date(date);\r\n            return [d.getFullYear(), pad(d.getMonth() + 1), pad(d.getDate())].concat(hasTime ? [\"_\", pad(d.getHours()), pad(d.getMinutes()), pad(d.getSeconds())] : []).join('');\r\n\r\n        },\r\n\r\n        replaceSpecialCharacters: function (t) {\r\n            var translate = {\r\n                \"ä\": \"a\", \"ö\": \"o\", \"ü\": \"u\",\r\n                \"Ä\": \"A\", \"Ö\": \"O\", \"Ü\": \"U\",\r\n                \"á\": \"a\", \"é\": \"e\", \"i\": \"i\", \"ó\": \"o\", \"ú\": \"u\",\r\n                \"Á\": \"A\", \"É\": \"E\", \"Í\": \"I\", \"Ó\": \"O\", \"Ú\": \"U\",\r\n                \"ñ\": \"n\", \"Ñ\": \"N\"\r\n            };\r\n            return t.replace(/[öäüÖÄÜáéíóúÁÉÍÓÚñÑ]/g, function (match) {\r\n                return translate[match];\r\n            });\r\n        },\r\n\r\n        downloadFileForm: async function (url, data) {\r\n            var download = async function (url, data) {\r\n\r\n                var response = await new Promise(function (resolve, reject) {\r\n                    const request = new XMLHttpRequest();\r\n                    request.responseType = \"blob\";\r\n                    request.open(\"POST\", url);\r\n                    request.setRequestHeader('Content-Type', 'application/xml; charset=UTF-8');\r\n\r\n                    request.onreadystatechange = function (e) {\r\n                        if (request.readyState === 4) { // DONE\r\n                            if (request.status !== 200) {\r\n                                reject({\r\n                                    status: request.status,\r\n                                    msg: request.statusText,\r\n                                    url: url\r\n                                });\r\n                            } else {\r\n\r\n                                try {\r\n                                    //URI: Miro si devuelve una cabecera content-disposition attachment. Si es asi uso el filenae como nombre de fichero. Esta descarga seguramente venga\r\n                                    //de un proxy con postproceso de zippeado\r\n                                    const contentDispositionHeader = request.getResponseHeader(\"Content-disposition\");\r\n                                    var filename = \"\";\r\n                                    if (contentDispositionHeader) {\r\n                                        filename = contentDispositionHeader.split(\"; \")[1].substring(9);\r\n                                        if (contentDispositionHeader.split(\"; \")[0] !== \"attachment\") {\r\n                                            filename = filename.substring(0, filename.lastIndexOf(\".\"));\r\n                                        }\r\n                                    }\r\n                                    resolve({ data: request.response, contentType: request.getResponseHeader(\"Content-type\"), filename: filename });\r\n                                }\r\n                                catch (error) {\r\n                                    reject(error);\r\n                                }\r\n                            }\r\n                        }\r\n                    };\r\n\r\n                    try {\r\n                        request.send(data);\r\n                    } catch (error) {\r\n                        reject(error);\r\n                    }\r\n                });\r\n                var format = \"\";\r\n                if (response.data.type.indexOf(\"kml\") >= 0)\r\n                    format = \".kml\";\r\n                else if (response.data.type.indexOf(\"json\") >= 0)\r\n                    format = \".geojson\";\r\n                else if (response.data.type.indexOf(\"xml\") >= 0) {\r\n                    format = \".gml\";\r\n                    if (/outputFormat=\"\\S{1,}\"/.exec(data)[0].includes(\".kml\") || /outputFormat=\"\\S{1,}\"/.exec(data)[0].includes(\"shape-zip\")) {\r\n                        throw { key: TC.Consts.DownloadError.MIMETYPE_NOT_SUPORTED, url: url, data: data, format: /outputFormat=\"\\S{1,}\"/.exec(data)[0] };\r\n                    }\r\n                }\r\n                TC.Util.downloadFile((response.filename ? response.filename : TC.getUID()) + format, response.contentType, response.data);\r\n\r\n            };\r\n            var htmlObj = [];\r\n            var _err;\r\n            if (Array.isArray(url)) {\r\n                var arrDownloads = url;\r\n                for (var i = 0; i < arrDownloads.length; i++) {\r\n                    try {\r\n                        await download(arrDownloads[i].url, arrDownloads[i].data);\r\n                    }\r\n                    catch (err) {\r\n                        _err = err;\r\n                    }\r\n                }\r\n                if (_err) {\r\n                    throw _err;\r\n                }\r\n            }\r\n            else {\r\n                await download(url, data);\r\n            }\r\n        },\r\n        WFSQueryBuilder: function (layers, filter, capabilities, outputFormat, onlyHits, srsName, maxFeatures, fields) {\r\n            const getSRSAttribute = function () {\r\n                if (srsName) {\r\n                    return ' srsName=\"' + srsName + '\"'\r\n                }\r\n                else\r\n                    return '';\r\n            }\r\n            const getFields = function () {\r\n                if (!fields) return '';\r\n                var tagName = '';\r\n                switch (capabilities.version) {\r\n                    case \"1.0.0\":\r\n                        tagName = \"ogc:PropertyName\";\r\n                        break;\r\n                    case \"1.1.0\":\r\n                        tagName = \"wfs:PropertyName\";\r\n                        break;\r\n                    case \"2.0.0\":\r\n                        tagName = \"wfs:PropertyName\";\r\n                    default:\r\n\r\n                        break;\r\n                }\r\n                return (fields instanceof Array ? fields : [fields]).reduce(function (vi, va) {\r\n                    return (vi + '<' + tagName + '>' + va + '</' + tagName + '>')\r\n                }, '')\r\n\r\n            };\r\n            if (!Array.isArray(layers) && !(layers instanceof Object))\r\n                layers = [layers];\r\n\r\n            var query = '<wfs:GetFeature ' + _queryHeaderConstructor(capabilities).format({ resultType: (onlyHits ? 'resultType=\"hits\"' : ''), format: 'outputFormat=\"' + outputFormat + '\"' }) + (capabilities.version !== \"2.0.0\" && maxFeatures ? ' maxFeatures=\"' + maxFeatures + '\"' : '') + '>';\r\n            var queryBody = '';\r\n            if (Array.isArray(layers)) {\r\n                var queryItem = '<wfs:Query typeName' + (capabilities.version === \"2.0.0\" ? 's' : '') + '=\"{typeName}\"' + getSRSAttribute() + '>{fields}{filter}</wfs:Query>';\r\n                layers.forEach(function (value) {\r\n                    queryBody += queryItem.format({ typeName: value, filter: (filter && filter instanceof TC.filter.Filter ? filter.getText(capabilities.version) : \"\"), fields: getFields() });\r\n                });\r\n            }\r\n            else {\r\n                var queryItem = '';\r\n                for (var layer in layers) {\r\n                    var queryItem = ('<wfs:Query typeName' + (capabilities.version === \"2.0.0\" ? 's' : '') + '=\"{typeName}\"' + getSRSAttribute() + '>{fields}{filter}</wfs:Query>');\r\n                    let filter = layers[layer]\r\n                    queryBody += queryItem.format({ typeName: layer, filter: (filter && filter instanceof TC.filter.Filter ? filter.getText(capabilities.version) : \"\"), fields: getFields() });\r\n                }\r\n            }\r\n\r\n            query += queryBody + '</wfs:GetFeature>'\r\n            return query;\r\n        },\r\n\r\n        WFGetPropertyValue: function (layer, valueReference, filter, capabilities) {\r\n            /*if (capabilities.version === \"2.0.0\") {\r\n                var query = '<wfs:GetPropertyValue ' + _queryHeaderConstructor(capabilities).format({ resultType: '', format: '' }) + ' valueReference=\"' + valueReference + '\" >';\r\n                var queryBody = '';\r\n                var queryItem = ('<wfs:Query typeName' + (capabilities.version === \"2.0.0\" ? 's' : '') + '=\"{typeName}\"' + '>{filter}</wfs:Query>');\r\n                queryBody += queryItem.format({ typeName: layer, filter: (filter && filter instanceof TC.filter.Filter ? filter.getText(capabilities.version) : \"\") });\r\n                query += queryBody + '</wfs:GetPropertyValue>'\r\n                return query;\r\n            }\r\n            else*/\r\n                return TC.Util.WFSQueryBuilder([layer], filter, capabilities, \"JSON\", false, null, null, valueReference);\r\n\r\n            \r\n        },\r\n\r\n        WFSFilterBuilder: function (feature, version, srsName) {\r\n            var filter = '';\r\n            if (Util.isPlainObject(feature)) {\r\n                filter = '<{prefix}:Filter><{prefix}:Intersects><fes:ValueReference></fes:ValueReference><{prefix}:Function name=\"querySingle\"><{prefix}:Literal>{clipLayer}</{prefix}:Literal><{prefix}:Literal>{geometryName}</{prefix}:Literal><{prefix}:Literal>{where}</{prefix}:Literal></{prefix}:Function></{prefix}:Intersects></{prefix}:Filter>'\r\n                    .format({ prefix: (version === \"2.0.0\" ? \"fes\" : \"ogc\"), \"clipLayer\": feature.clipLayer, \"geometryName\": feature.geometryName, \"where\": feature.where })\r\n            }\r\n            else {\r\n                switch (true) {\r\n                    case !feature:\r\n                        break;\r\n                    case Array.isArray(feature)://bbox\r\n                        var gmlEnvelope = ('<gml:Envelope>' +\r\n                            '<gml:lowerCorner>{lowerCorner}</gml:lowerCorner>' +\r\n                            '<gml:upperCorner>{upperCorner}</gml:upperCorner>' +\r\n                            '</gml:Envelope>').format({ lowerCorner: (feature[0] + ' ' + feature[1]), upperCorner: (feature[2] + ' ' + feature[3]) });\r\n                        switch (true) {\r\n                            case version === \"1.0.0\":\r\n                            case version === \"1.1.0\":\r\n                                filter += '<ogc:Filter><ogc:BBOX>' + gmlEnvelope + '</ogc:BBOX></ogc:Filter>';\r\n                                break;\r\n                            case version === \"2.0.0\":\r\n                                filter += '<fes:Filter><fes:BBOX>' + gmlEnvelope + '</fes:BBOX></fes:Filter>';\r\n                                break;\r\n                        }\r\n                        break;\r\n                    case feature instanceof TC.Feature:\r\n                        switch (true) {\r\n                            case version === \"1.0.0\":\r\n                            case version === \"1.1.0\":\r\n                                filter += '<ogc:Filter><ogc:Intersects><ogc:PropertyName></ogc:PropertyName>' + TC.Util.writeGMLGeometry(feature, { version: \"2.0\", srsName: srsName }) + '</ogc:Intersects></ogc:Filter>';\r\n                                break;\r\n                            case version === \"2.0.0\":\r\n                                filter += '<fes:Filter><fes:Intersects><fes:ValueReference></fes:ValueReference>' + TC.Util.writeGMLGeometry(feature, { version: \"3.2\", srsName: srsName }) + '</fes:Intersects></fes:Filter>';\r\n                                break;\r\n                        }\r\n\r\n                        break;\r\n                    default:\r\n                        TC.error(\"Geometr\\u00eda no v\\u00e1lida\");\r\n                        break;\r\n                }\r\n            }\r\n\r\n            return filter;\r\n        },\r\n\r\n        writeGMLGeometry: function (feature, options) {\r\n            options = options || {};\r\n            const gmlVersion = options.version;\r\n            const getSRSName = function () {\r\n                if (options.srsName) {\r\n                    return ' srsName=\"' + options.srsName + '\"'\r\n                }\r\n                else\r\n                    return '';\r\n            };\r\n            var getGmlCoordinates = function (coords) {\r\n                var result;\r\n                if (gmlVersion.indexOf('3') === 0) {\r\n                    result = coords.toString();\r\n                    while (result.indexOf(\",\") >= 0) {\r\n                        result = result.replace(\",\", \" \");\r\n                    }\r\n                }\r\n                else {\r\n                    result = coords.map(function (coord) {\r\n                        return coord.join(',');\r\n                    }).join(' ');\r\n                }\r\n                return result;\r\n            };\r\n\r\n            switch (gmlVersion) {\r\n                case \"3.1.1\":\r\n                    break;\r\n                case \"3.2\":\r\n                    switch (true) {\r\n                        case TC.feature.Polyline && feature instanceof TC.feature.Polyline:\r\n                            return \"<gml:LineString srsDimension=\\\"2\\\"\" + getSRSName() + \"><gml:posList>\" +\r\n                                getGmlCoordinates(feature.geometry) +\r\n                                \"</gml:posList></gml:LineString>\";\r\n                            break;\r\n                            break;\r\n                        default:\r\n                            return \"<gml:Polygon srsDimension=\\\"2\\\"\" + getSRSName() + \"><gml:exterior><gml:LinearRing><gml:posList>\" +\r\n                                getGmlCoordinates(feature.geometry[0]) +\r\n                                \"</gml:posList></gml:LinearRing></gml:exterior></gml:Polygon>\";\r\n                            break;\r\n                    }\r\n                    break;\r\n                case \"2.0\":\r\n                default:\r\n                    switch (true) {\r\n                        case TC.feature.Polyline && feature instanceof TC.feature.Polyline:\r\n                            return \"<gml:LineString\" + getSRSName() + \"><gml:coordinates>\" +\r\n                                getGmlCoordinates(feature.geometry[0]) +\r\n                                \"</gml:coordinates></gml:LineString>\";\r\n                            break;\r\n                        default:\r\n                            return \"<gml:Polygon\" + getSRSName() + \"><gml:outerBoundaryIs><gml:LinearRing><gml:coordinates>\" +\r\n                                getGmlCoordinates(feature.geometry[0]) +\r\n                                \"</gml:coordinates></gml:LinearRing></gml:outerBoundaryIs></gml:Polygon>\";\r\n                            break;\r\n                    }\r\n                    break;\r\n            }\r\n        },\r\n\r\n        isServiceWorker: function () {\r\n            if (navigator.serviceWorker) {\r\n                if (navigator.serviceWorker.controller && navigator.serviceWorker.controller.state === \"activated\") {\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            } else {\r\n                return false;\r\n            }\r\n        },\r\n\r\n        isSameOriginByLocation: function (uri, location) {\r\n            var result = uri.indexOf(\"http\") !== 0 && uri.indexOf(\"//\") !== 0;\r\n            var urlParts = !result && uri.match(TC.Consts.url.SPLIT_REGEX);\r\n            if (urlParts) {\r\n                var uProtocol = urlParts[1];\r\n                result = (uProtocol == location.protocol || uProtocol == undefined) && urlParts[3] == location.hostname;\r\n                var uPort = urlParts[4], lPort = location.port;\r\n                if (uPort != 80 && uPort !== \"\" || lPort != \"80\" && lPort !== \"\") {\r\n                    result = result && uPort == lPort;\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n\r\n        isSameProtocol: function (uri, location) {\r\n            if (uri.match(/^(\\/\\/)/i)) {\r\n                return true;\r\n            }\r\n            var protocolRegex = /^(https?:\\/\\/)/i;\r\n            var uriProtocol = uri.match(protocolRegex);\r\n            if (uriProtocol && uriProtocol.length > 1) {\r\n                var locationProtocol = location.match(protocolRegex);\r\n                if (locationProtocol && locationProtocol.length > 1) {\r\n                    return uriProtocol[0].trim() === locationProtocol[0].trim();\r\n                }\r\n            }\r\n\r\n            return false;\r\n        },\r\n\r\n        consoleRegister: function (msg) {\r\n            if (TC.isDebug) {\r\n                console.log(msg);\r\n            }\r\n        },\r\n\r\n        getSorterByProperty: function (propName) {\r\n            return function (a, b) {\r\n                if (a[propName] > b[propName]) {\r\n                    return 1;\r\n                }\r\n                if (a[propName] < b[propName]) {\r\n                    return -1;\r\n                }\r\n                return 0;\r\n            };\r\n        },\r\n\r\n        getSoundexDifference: function (a, b) {\r\n            var res = 0\r\n\r\n            for (var i = 0; i < a.length; i++) {\r\n                if (a.charAt(i) == b.charAt(i)) {\r\n                    res++;\r\n                }\r\n            }\r\n\r\n            return res;\r\n        },\r\n\r\n        toAbsolutePath: function (href) {\r\n            var link = document.createElement(\"a\");\r\n            link.href = href;\r\n            return link.href;\r\n        },\r\n\r\n        explodeGeometry: function (obj) {\r\n            const origin = obj.origin;\r\n            const iterationFunction = function (elm, idx, arr) {\r\n                if (Array.isArray(elm)) {\r\n                    elm.forEach(iterationFunction);\r\n                }\r\n                else {\r\n                    if (idx === 0) {\r\n                        arr[0] = elm + origin[0];\r\n                    }\r\n                    if (idx === 1) {\r\n                        arr[1] = elm + origin[1];\r\n                    }\r\n                }\r\n            };\r\n            obj.geom.forEach(iterationFunction);\r\n            return obj.geom;\r\n        },\r\n\r\n        cloneMappingFunction: function (elm) {\r\n            if (Array.isArray(elm)) {\r\n                return elm.map(TC.Util.cloneMappingFunction);\r\n            }\r\n            return elm;\r\n        },\r\n\r\n        isGeometry: function (type) {\r\n            switch (type) {\r\n                case 'gml:LinearRingPropertyType':\r\n                case 'gml:PolygonPropertyType':\r\n                case 'gml:MultiPolygonPropertyType':\r\n                case 'gml:MultiSurfacePropertyType':\r\n                case 'gml:LineStringPropertyType':\r\n                case 'gml:MultiLineStringPropertyType':\r\n                case 'gml:PointPropertyType':\r\n                case 'gml:MultiPointPropertyType':\r\n                case 'gml:BoxPropertyType':\r\n                case 'gml:GeometryCollectionPropertyType':\r\n                case 'gml:GeometryAssociationType':\r\n                case 'gml:GeometryPropertyType':\r\n                case 'gml:MultiCurvePropertyType':\r\n                case 'gml:CurvePropertyType':\r\n                    return true;\r\n                    break;\r\n                default:\r\n                    return false;\r\n                    break;\r\n            }\r\n        },\r\n\r\n        compactGeometry: function (geometry, precision) {\r\n            const origin = [Number.MAX_VALUE, Number.MAX_VALUE];\r\n            const newGeom = geometry.map(TC.Util.cloneMappingFunction);\r\n            const firstIterationFunction = function (elm, idx) {\r\n                if (Array.isArray(elm)) {\r\n                    elm.forEach(firstIterationFunction);\r\n                }\r\n                else {\r\n                    if (idx === 0 && elm < origin[0]) {\r\n                        origin[0] = elm;\r\n                    }\r\n                    else if (idx === 1 && elm < origin[1]) {\r\n                        origin[1] = elm;\r\n                    }\r\n                }\r\n            };\r\n            newGeom.forEach(firstIterationFunction);\r\n\r\n            const round = function (val) {\r\n                return Math.round(val * precision) / precision;\r\n            }\r\n            origin[0] = round(origin[0]);\r\n            origin[1] = round(origin[1]);\r\n            const secondIterationFunction = function (elm, idx, arr) {\r\n                if (Array.isArray(elm)) {\r\n                    elm.forEach(secondIterationFunction);\r\n                }\r\n                else {\r\n                    if (idx === 0) {\r\n                        arr[0] = round(elm - origin[0]);\r\n                    }\r\n                    if (idx === 1) {\r\n                        arr[1] = round(elm - origin[1]);\r\n                    }\r\n                }\r\n            };\r\n            newGeom.forEach(secondIterationFunction);\r\n            return {\r\n                origin: origin,\r\n                geom: newGeom\r\n            }\r\n        },\r\n\r\n        hasStyleOptions: function (options) {\r\n            return options.hasOwnProperty('strokeColor') ||\r\n                options.hasOwnProperty('strokeWidth') ||\r\n                options.hasOwnProperty('fillColor') ||\r\n                options.hasOwnProperty('strokeOpacity') ||\r\n                options.hasOwnProperty('fillOpacity') ||\r\n                options.hasOwnProperty('url') ||\r\n                options.hasOwnProperty('radius') ||\r\n                options.hasOwnProperty('anchor') ||\r\n                options.hasOwnProperty('width') ||\r\n                options.hasOwnProperty('height') ||\r\n                options.hasOwnProperty('labelOutlineWidth') ||\r\n                options.hasOwnProperty('labelOutlineColor') ||\r\n                options.hasOwnProperty('labelOffset') ||\r\n                options.hasOwnProperty('fontColor') ||\r\n                options.hasOwnProperty('fontSize');\r\n        },\r\n\r\n        formatCoord: function (x, nDecimales) {\r\n            return x.toLocaleString(TC.Util.getLocaleUserChoice(), { maximumFractionDigits: nDecimales });\r\n\r\n            // No respeta el formato de los números según el idioma\r\n            //var result;            \r\n            //result = x.toFixed(nDecimales);\r\n            //if (nDecimales <= 3) {\r\n            //    result = result.replace(/\\B(?=(\\d{3})+(?!\\d))/g, \"|\");\r\n            //}\r\n\r\n            //result = result.replace(\".\", \",\").replace(/\\|/g, \".\");\r\n            //return result;\r\n        },\r\n\r\n        getWebWorkerCrossOriginURL: function (url) {\r\n            return new Promise(function (resolve, reject) {\r\n                if (window.hasOwnProperty('Worker')) {\r\n                    // Para evitar problemas con IE10 y Opera evitamos el uso de blobs cuando es evitable\r\n                    if (TC.Util.isSameOrigin(url)) {\r\n                        resolve(url);\r\n                    }\r\n                    else {\r\n                        TC.ajax({\r\n                            url: url,\r\n                            method: 'GET',\r\n                            responseType: 'text'\r\n                        }).then(\r\n                            function (response) {\r\n                                const data = response.data;\r\n                                var blob = new Blob([data], { type: \"text/javascript\" });\r\n                                var url = window.URL.createObjectURL(blob);\r\n                                resolve(url);\r\n                            },\r\n                            function (e) {\r\n                                reject(Error(e));\r\n                            }\r\n                        );\r\n                    }\r\n                }\r\n                else {\r\n                    reject(new Error('No support for service workers'));\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    String.prototype.format = function () {\r\n        var str = this.toString();\r\n        if (!arguments.length)\r\n            return str;\r\n        var args = typeof arguments[0],\r\n            args = ((\"string\" == args || \"number\" == args) ? arguments : arguments[0]);\r\n        for (arg in args)\r\n            str = str.replace(RegExp(\"\\\\{\" + arg + \"\\\\}\", \"gi\"), args[arg]);\r\n        return str;\r\n    };\r\n    const _queryHeaderConstructor = function (capabilities) {\r\n        var queryHeader = 'xsi:schemaLocation=\"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd\" ' +\r\n            ' service=\"WFS\" {resultType} {format} ';\r\n        switch (capabilities.version) {\r\n            case \"1.0.0\":\r\n            case \"1.1.0\":\r\n                queryHeader += 'xmlns:gml=\"http://www.opengis.net/gml\" xmlns:wfs=\"http://www.opengis.net/wfs\" ';\r\n                break;\r\n            case \"2.0.0\":\r\n                queryHeader += 'xmlns:wfs=\\\"http://www.opengis.net/wfs/2.0\\\" xmlns:gml=\\\"http://www.opengis.net/gml/3.2\\\" ';\r\n                break;\r\n        }\r\n        for (var i in capabilities) {\r\n            if (typeof (capabilities[i]) === \"string\" && i.indexOf(\"gml\") < 0 && capabilities[i].indexOf(\"wfs\") < 0)\r\n                queryHeader += (i + '=\"' + capabilities[i] + '\" ');\r\n        }\r\n        return queryHeader\r\n    };\r\n    \r\n    var fncOvelaps = function (elem1, elem2, comparisonFnc) {\r\n        return comparisonFnc(elem1.getBoundingClientRect(), elem2.getBoundingClientRect());\r\n    }\r\n    if (this.HTMLElement) {\r\n        HTMLElement.prototype.colliding = function (other) {\r\n            return fncOvelaps(this, other, function (rect1, rect2) {\r\n                return !(\r\n                    rect1.top > rect2.bottom ||\r\n                    rect1.right < rect2.left ||\r\n                    rect1.bottom < rect2.top ||\r\n                    rect1.left > rect2.right\r\n                );\r\n            });\r\n        };\r\n        HTMLElement.prototype.containing = function (other) {\r\n            fncOvelaps(this, other, function (rect1, rect2) {\r\n                return !(\r\n                    rect1.left <= rect2.left &&\r\n                    rect2.left < rect1.width &&\r\n                    rect1.top <= rect2.top &&\r\n                    rect2.top < rect1.height\r\n                );\r\n            });\r\n        };\r\n        HTMLElement.prototype.inside = function (other) {\r\n            return fncOvelaps(this, other, function (rect1, rect2) {\r\n                return (\r\n                    ((rect2.top <= rect1.top) && (rect1.top <= rect2.bottom)) &&\r\n                    ((rect2.top <= rect1.bottom) && (rect1.bottom <= rect2.bottom)) &&\r\n                    ((rect2.left <= rect1.left) && (rect1.left <= rect2.right)) &&\r\n                    ((rect2.left <= rect1.right) && (rect1.right <= rect2.right))\r\n                );\r\n            });\r\n        };\r\n    }\r\n    return Util;\r\n});\r\n"]}