{"version":3,"sources":["workers/tc-jsonpack-web-worker.js"],"names":["define","amd","n","t","r","i","exports","self","jsonpack","o","replace"," ","+","|","^","%","l","%2B","%7C","%5E","%25","Number","prototype","toString","call","toUpperCase","s","parseInt","u","Array","indexOf","this","length","JSON","pack","h","c","a","verbose","console","log","parse","strings","integers","floats","y","v","w","p","stringify","type","index","hasOwnProperty","push","Error","join","b","e","f","shift","slice","TypeError","debug","dictionary","ast","packed","unpack","k","split","parseFloat","g","charAt","d","undefined","onmessage","data","action","result","object","postMessage","id","error"],"mappings":"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","sourcesContent":["/*\r\n Copyright (c) 2013, Rodrigo Gonz√°lez, Sapienlab All Rights Reserved.\r\n Available via MIT LICENSE. See https://github.com/rgcl/jsonpack/blob/master/LICENSE.md for details.\r\n */\r\n(function (n) { n([], function () { var f = -1, e = -2, i = -3, n = -4, r = -5, h = function (s, h) { var l, c, a; h = h || {}; l = h.verbose || !1; l && console.log(\"Normalize the JSON Object\"); s = typeof s == \"string\" ? this.JSON.parse(s) : s; l && console.log(\"Creating a empty dictionary\"); c = { strings: [], integers: [], floats: [] }; l && console.log(\"Creating the AST\"); var y = function v(s) { var y, w, a, p, h; if (l && console.log(\"Calling recursiveAstBuilder with \" + this.JSON.stringify(s)), y = typeof s, s === null) return { type: \"null\", index: i }; if (typeof s == \"undefined\") return { type: \"undefined\", index: r }; if (s instanceof Array) { a = [\"@\"]; for (w in s) s.hasOwnProperty(w) && a.push(v(s[w])); return a } if (y === \"object\") { a = [\"$\"]; for (p in s) s.hasOwnProperty(p) && (a.push(v(p)), a.push(v(s[p]))); return a } if (s === \"\") return { type: \"empty\", index: n }; if (y === \"string\") return h = u.call(c.strings, s), h == -1 && (c.strings.push(o(s)), h = c.strings.length - 1), { type: \"strings\", index: h }; if (y === \"number\" && s % 1 == 0) return h = u.call(c.integers, s), h == -1 && (c.integers.push(t(s)), h = c.integers.length - 1), { type: \"integers\", index: h }; if (y === \"number\") return h = u.call(c.floats, s), h == -1 && (c.floats.push(s), h = c.floats.length - 1), { type: \"floats\", index: h }; if (y === \"boolean\") return { type: \"boolean\", index: s ? f : e }; throw new Error(\"Unexpected argument of type \" + typeof s); }(s), p = c.strings.length, w = c.integers.length, k = c.floats.length; return (l && console.log(\"Parsing the dictionary\"), a = c.strings.join(\"|\"), a += \"^\" + c.integers.join(\"|\"), a += \"^\" + c.floats.join(\"|\"), l && console.log(\"Parsing the structure\"), a += \"^\" + function b(u) { var e, s, f, o; if (l && console.log(\"Calling a recursiveParser with \" + this.JSON.stringify(u)), u instanceof Array) { e = u.shift(); for (s in u) u.hasOwnProperty(s) && (e += b(u[s]) + \"|\"); return (e[e.length - 1] === \"|\" ? e.slice(0, -1) : e) + \"]\" } if (f = u.type, o = u.index, f === \"strings\") return t(o); if (f === \"integers\") return t(p + o); if (f === \"floats\") return t(p + w + o); if (f === \"boolean\") return u.index; if (f === \"null\") return i; if (f === \"undefined\") return r; if (f === \"empty\") return n; throw new TypeError(\"The item is alien!\"); }(y), l && console.log(\"Ending parser\"), h.debug) ? { dictionary: c, ast: y, packed: a } : a }, c = function (t, u) { var p, v, o, w, h, a, k, c; if (u = u || {}, p = t.split(\"^\"), u.verbose && console.log(\"Building dictionary\"), v = [], o = p[0], o !== \"\") for (o = o.split(\"|\"), u.verbose && console.log(\"Parse the strings dictionary\"), h = 0, w = o.length; h < w; h++) v.push(l(o[h])); if (o = p[1], o !== \"\") for (o = o.split(\"|\"), u.verbose && console.log(\"Parse the integers dictionary\"), h = 0, w = o.length; h < w; h++) v.push(s(o[h])); if (o = p[2], o !== \"\") for (o = o.split(\"|\"), u.verbose && console.log(\"Parse the floats dictionary\"), h = 0, w = o.length; h < w; h++) v.push(parseFloat(o[h])); o = null; u.verbose && console.log(\"Tokenizing the structure\"); var b = \"\", y = [], g = p[3].length; for (h = 0; h < g; h++) a = p[3].charAt(h), a === \"|\" || a === \"$\" || a === \"@\" || a === \"]\" ? (b && (y.push(s(b)), b = \"\"), a !== \"|\" && y.push(a)) : b += a; return k = y.length, c = 0, u.verbose && console.log(\"Starting recursive parser\"), function d() { var h = y[c++], t, s, o; if (u.verbose && console.log(\"Reading collection type \" + (h === \"$\" ? \"object\" : \"Array\")), h === \"@\") { for (t = []; c < k; c++) { if (o = y[c], u.verbose && console.log(\"Read \" + o + \" symbol\"), o === \"]\") return t; if (o === \"@\" || o === \"$\") t.push(d()); else switch (o) { case f: t.push(!0); break; case e: t.push(!1); break; case i: t.push(null); break; case r: t.push(undefined); break; case n: t.push(\"\"); break; default: t.push(v[o]) } } return u.verbose && console.log(\"Parsed \" + this.JSON.stringify(t)), t } if (h === \"$\") { for (t = {}; c < k; c++) { if (s = y[c], s === \"]\") return t; if (s = s === n ? \"\" : v[s], o = y[++c], o === \"@\" || o === \"$\") t[s] = d(); else switch (o) { case f: t[s] = !0; break; case e: t[s] = !1; break; case i: t[s] = null; break; case r: t[s] = undefined; break; case n: t[s] = \"\"; break; default: t[s] = v[o] } } return u.verbose && console.log(\"Parsed \" + this.JSON.stringify(t)), t } throw new TypeError(\"Bad token \" + h + \" isn't a type\"); }() }, a = function (s, h) { var c = typeof h, l; if (c === \"boolean\") return h ? f : e; if (h === null) return i; if (typeof h == \"undefined\") return r; if (h === \"\") return n; if (c === \"string\" && (h = o(h), l = u.call(s.strings, h), l === -1 && (s.strings.push(h), l = s.strings.length - 1)), c !== \"string\" && c !== \"number\") throw new Error(\"The type is not a JSON type\"); return c === \"string\" ? h = o(h) : h % 1 == 0 && (h = t(h)), h = c === \"number\" ? t(h) : o(h), l = u.call(s[c], h), l === -1 && (s[c].push(h), l = s[c].length - 1), c === \"number\" ? \"+\" + l : l }, o = function (n) { return typeof n != \"string\" ? n : n.replace(/[\\+ \\|\\^\\%]/g, function (n) { return { \" \": \"+\", \"+\": \"%2B\", \"|\": \"%7C\", \"^\": \"%5E\", \"%\": \"%25\" }[n] }) }, l = function (n) { return typeof n != \"string\" ? n : n.replace(/\\+|%2B|%7C|%5E|%25/g, function (n) { return { \"+\": \" \", \"%2B\": \"+\", \"%7C\": \"|\", \"%5E\": \"^\", \"%25\": \"%\" }[n] }) }, t = function (n) { return Number.prototype.toString.call(n, 36).toUpperCase() }, s = function (n) { return parseInt(n, 36) }, u = Array.prototype.indexOf || function (n, t) { for (var i = t || 0, r = this.length; i < r; i++) if (this[i] === n) return i; return -1 }; return { JSON: JSON, pack: h, unpack: c } }) })(typeof define == \"undefined\" || !define.amd ? function (n, t) { var i = t(), r; if (typeof exports != \"undefined\") for (r in i) exports[r] = i[r]; else self.jsonpack = i } : define);\r\n\r\nonmessage = function (e) {\r\n    if (e.data.action) {\r\n        try {\r\n            const result = jsonpack[e.data.action](e.data.object);\r\n            postMessage({\r\n                id: e.data.id,\r\n                action: e.data.action,\r\n                result: result\r\n            });\r\n        }\r\n        catch (error) {\r\n            postMessage({\r\n                id: e.data.id,\r\n                action: e.data.action,\r\n                error: error.toString()\r\n            });\r\n        }\r\n    }\r\n};\r\n"]}