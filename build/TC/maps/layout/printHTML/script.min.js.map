{"version":3,"sources":["layout/printHTML/script.js"],"names":["$","size","TC","Util","getParameterByName","orientation","title","addClass","document","querySelector","textContent","window","loadJS","_hbs","compile","url","templatingFull","src","html","template","Name","on","detectIE","remove","printpr","print","doPrint","showModal","body","insertAdjacentHTML","WebBrowser1","ExecWB","outerHTML","ex"],"mappings":"AAAAA,EAAE,WAEE,IAAIC,EAAOC,GAAGC,KAAKC,mBAAmB,QAClCC,EAAcH,GAAGC,KAAKC,mBAAmB,eACzCE,EAAQJ,GAAGC,KAAKC,mBAAmB,SAEvCJ,EAAE,QAAQO,SAAS,YAAcF,EAAc,IAAMJ,GACrDO,SAASC,cAAc,SAASC,aAAe,+BAAiCT,EAAO,IAAMI,EAAc,mCAEvGC,IACAK,OAAOH,SAASF,MAAQA,GAE5BJ,GAAGU,QACEV,GAAGW,OAASX,GAAGW,KAAKC,QACrBZ,GAAGa,IAAIC,eACH,WACI,IAAIC,EAAMjB,EAAE,2BAA2BkB,OACvC,MAAMC,EAAWjB,GAAGW,KAAKC,QAAQG,GAEjCjB,EAAE,2BAA2BkB,KAAKC,EAAS,CAAEC,KAAMd,OAK/DN,EAAE,cAAcqB,GAAG,QAAS,WAExB,GADUnB,GAAGC,KAAKmB,WACT,CACLtB,EAAE,eAAeuB,SACjBC,eAGAb,OAAOc,YAKnB,SAASC,UACLxB,GAAGC,KAAKwB,UAAUnB,SAASC,cAAc,kBAI7C,SAASe,UACL,IAKIhB,SAASoB,KAAKC,mBAAmB,YADhB,4GAEjBC,YAAYC,OAJG,EACF,GAIbD,YAAYE,UAAY,GAE5B,MAAOC,GACHtB,OAAOc,QAGX,OAAO","sourcesContent":["$(function () {\r\n\r\n    var size = TC.Util.getParameterByName(\"size\");\r\n    var orientation = TC.Util.getParameterByName(\"orientation\");\r\n    var title = TC.Util.getParameterByName(\"title\");\r\n\r\n    $(\"body\").addClass(\"tc-print-\" + orientation + \"-\" + size);\r\n    document.querySelector('style').textContent += \"@media print { @page {size: \" + size + \" \" + orientation + \"; margin: 10mm 10mm 10mm 10mm;}}\";\r\n\r\n    if (title) {\r\n        window.document.title = title;\r\n    }\r\n    TC.loadJS(\r\n        !TC._hbs || !TC._hbs.compile,\r\n        TC.url.templatingFull,\r\n            function () {\r\n                var src = $('#print-preview-controls').html();\r\n                const template = TC._hbs.compile(src);\r\n\r\n                $('#print-preview-controls').html(template({ Name: title }));\r\n\r\n            });\r\n\r\n    //Cuando se cierre el alert, se lanza la impresi√≥n\r\n    $(\".tc-button\").on(\"click\", function () {\r\n        var iev = TC.Util.detectIE();\r\n        if (iev) {\r\n            $(\"head script\").remove();\r\n            printpr();\r\n        }\r\n        else {\r\n            window.print();\r\n        }\r\n    });\r\n});\r\n\r\nfunction doPrint() {\r\n    TC.Util.showModal(document.querySelector('#printMessage'));\r\n\t\r\n}\r\n\r\nfunction printpr() {\r\n    try {\r\n        /* OLECMDID values:    * 6 - print    * 7 - print preview    * 1 - open window    * 4 - Save As    */\r\n        var OLECMDID = 7;\r\n        var PROMPT = 1; // 2 DONTPROMPTUSER\r\n        var WebBrowser = '<OBJECT ID=\"WebBrowser1\" WIDTH=0 HEIGHT=0 CLASSID=\"CLSID:8856F961-340A-11D0-A96B-00C04FD705A2\"></OBJECT>';\r\n        document.body.insertAdjacentHTML('beforeEnd', WebBrowser);\r\n        WebBrowser1.ExecWB(OLECMDID, PROMPT);\r\n        WebBrowser1.outerHTML = \"\";\r\n    }\r\n    catch (ex) {\r\n        window.print();\r\n    }\r\n\r\n    return false;\r\n}"]}