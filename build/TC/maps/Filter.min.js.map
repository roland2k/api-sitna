{"version":3,"sources":["filter.js"],"names":["TC","filter","Filter","tagName","this","tagName_","_defaultNSURL","_defaultPrefixNS","_wfsPrefixNS","_fieldTitle","_wfsNSURL","_wfs2prefixNS","_wfs2NSURL","_wfs2FieldTitle","_escapeAttrName","_wfs2EscapeAttrName","prototype","getTagName","writeFilterCondition_","format","prefix","NSURL","tag","inner","writeInnerCondition_","LogicalNary","write","ComparisonBinary","Comparison","Spatial","Function","writeInnerArrayCondition_","filters","parent","conditions","reduce","vi","va","index","getText","wfsVersion","parseFloat","and","params","concat","Array","slice","call","arguments","bind","apply","And","or","Or","not","condition","Not","intersects","Object","toString","Intersects","within","Within","equalTo","propertyName","expression","opt_matchCase","EqualTo","notEqualTo","NotEqualTo","lessThan","LessThan","lessThanOrEqualTo","LessThanOrEqualTo","greaterThan","GreaterThan","greaterThanOrEqualTo","GreaterThanOrEqualTo","isNull","IsNull","between","lowerBoundary","upperBoundary","IsBetween","functionName","like","pattern","opt_wildCard","opt_singleChar","opt_escapeChar","IsLike","inherit","values","LowerBoundary","UpperBoundary","Pattern","isArray","a","b","i","fmt","text","value","matchCase","escape","escapeChar","singleChar","wildCard","name","fieldTitle","undefined","_paramsToText","param","_text","attr","key","geometryName","geometry","opt_srsName","srsName","wrap","getAxisOrientation","match","code","def","ol","proj","get","axisOrientation_","toGML","bbox","Bbox","extent","lowerCorner","upperCorner","BBOX"],"mappings":"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","sourcesContent":["TC.filter = {};\r\n\r\nTC.filter.Filter = function (tagName) {\r\n    this.tagName_ = tagName;\r\n    \r\n    this._defaultNSURL = \"http://www.opengis.net/ogc\";\r\n    this._defaultPrefixNS = this._wfsPrefixNS = \"ogc\";\r\n    this._fieldTitle = \"PropertyName\";\r\n\r\n    this._defaultNSURL = this._wfsNSURL = \"http://www.opengis.net/ogc\";\r\n    this._wfs2prefixNS = \"fes\";\r\n    this._wfs2NSURL = \"http://www.opengis.net/fes/2.0\";\r\n    this._wfs2FieldTitle = \"ValueReference\";\r\n    this._escapeAttrName = \"escape\";\r\n    this._wfs2EscapeAttrName = \"escapeChar\";\r\n};\r\n\r\nTC.filter.Filter.prototype.getTagName = function () {\r\n    return this.tagName_;\r\n};\r\n\r\nTC.filter.Filter.prototype.writeFilterCondition_ = function () {\r\n\r\n    //return '<{prefix}:{tag}>{childs}</{prefix}:{tag}>'.format({prefix:\"ogc\",tag:filter.getTagName(),childs:\"\"});\r\n    var filter = this;\r\n    return '<{prefix}:Filter xmlns:{prefix}=\\\"{NSURL}\">{inner}</{prefix}:Filter>'.format({\r\n        prefix: this._defaultPrefixNS,\r\n        NSURL: this._defaultNSURL,\r\n        tag: filter.getTagName(),\r\n        inner: this.writeInnerCondition_(filter)\r\n    });\r\n\r\n    /*ol.xml.pushSerializeAndPop(item,\r\n        ol.format.WFS.GETFEATURE_SERIALIZERS_,\r\n        ol.xml.makeSimpleNodeFactory(filter.getTagName()),\r\n        [filter], objectStack);*/\r\n}\r\nTC.filter.Filter.prototype.writeInnerCondition_ = function (filter) {\r\n    if (filter != this) {\r\n        filter._defaultNSURL = this._defaultNSURL;\r\n        filter._defaultPrefixNS = this._defaultPrefixNS;\r\n        filter._fieldTitle = this._fieldTitle;\r\n    }\r\n\r\n    if (filter instanceof TC.filter.LogicalNary) {\r\n        return filter.write()\r\n    }\r\n    else if (filter instanceof TC.filter.ComparisonBinary) {\r\n        return filter.write();\r\n    }\r\n    else if (filter instanceof TC.filter.Comparison) {\r\n        return filter.write();\r\n    }\r\n    else if (filter instanceof TC.filter.Spatial) {\r\n        return filter.write();\r\n    }\r\n    else if (filter instanceof TC.filter.Function) {\r\n        return filter.write();\r\n    }\r\n    else\r\n        return filter.write();\r\n};\r\nTC.filter.Filter.prototype.writeInnerArrayCondition_ = function (filters) {\r\n    const parent = this;\r\n    return parent.conditions.reduce(function (vi, va, index) {\r\n        return (vi instanceof TC.filter.Filter ? parent.writeInnerCondition_(vi) : vi) + parent.writeInnerCondition_(va);\r\n    });\r\n}\r\n\r\nTC.filter.Filter.prototype.getText = function (wfsVersion) {\r\n    if (wfsVersion && parseFloat(wfsVersion,10) >= 2) {\r\n        this._defaultPrefixNS = this._wfs2prefixNS;\r\n        this._defaultNSURL = this._wfs2NSURL;\r\n        this._fieldTitle = this._wfs2FieldTitle;\r\n        this._escapeAttrName = this._wfs2EscapeAttrName;\r\n    }\r\n    return this.writeFilterCondition_();\r\n};\r\n\r\nTC.filter.and = function (conditions) {\r\n    var params = [null].concat(Array.prototype.slice.call(arguments));\r\n    return new (Function.prototype.bind.apply(TC.filter.And, params));\r\n};\r\n\r\nTC.filter.or = function (conditions) {\r\n    var params = [null].concat(Array.prototype.slice.call(arguments));\r\n    return new (Function.prototype.bind.apply(TC.filter.Or, params));\r\n};\r\n\r\nTC.filter.not = function (condition) {\r\n    return new TC.filter.Not(condition);\r\n};\r\n\r\n\r\nTC.filter.intersects = function () {\r\n    if (Object.prototype.toString.call(arguments[0]) !== \"[object String]\")\r\n        return new TC.filter.Intersects(null, arguments[0], arguments[1]);\r\n    else\r\n        return new TC.filter.Intersects(arguments[0], arguments[1], arguments[2]);\r\n};\r\n\r\n\r\nTC.filter.within = function () {\r\n    if (Object.prototype.toString.call(arguments[0]) !== \"[object String]\")\r\n        return new TC.filter.Within(null, arguments[0], arguments[1]);\r\n    else\r\n        return new TC.filter.Within(arguments[0], arguments[1], arguments[2]);\r\n};\r\n\r\n\r\nTC.filter.equalTo = function (propertyName, expression, opt_matchCase) {\r\n    return new TC.filter.EqualTo(propertyName, expression, opt_matchCase);\r\n};\r\n\r\nTC.filter.notEqualTo = function (propertyName, expression, opt_matchCase) {\r\n    return new TC.filter.NotEqualTo(propertyName, expression, opt_matchCase);\r\n};\r\n\r\nTC.filter.lessThan = function (propertyName, expression) {\r\n    return new TC.filter.LessThan(propertyName, expression);\r\n};\r\n\r\nTC.filter.lessThanOrEqualTo = function (propertyName, expression) {\r\n    return new TC.filter.LessThanOrEqualTo(propertyName, expression);\r\n};\r\n\r\nTC.filter.greaterThan = function (propertyName, expression) {\r\n    return new TC.filter.GreaterThan(propertyName, expression);\r\n};\r\n\r\nTC.filter.greaterThanOrEqualTo = function (propertyName, expression) {\r\n    return new TC.filter.GreaterThanOrEqualTo(propertyName, expression);\r\n};\r\n\r\nTC.filter.isNull = function (propertyName) {\r\n    return new TC.filter.IsNull(propertyName);\r\n};\r\n\r\nTC.filter.between = function (propertyName, lowerBoundary, upperBoundary) {\r\n    return new TC.filter.IsBetween(propertyName, lowerBoundary, upperBoundary);\r\n};\r\n\r\nTC.filter[\"function\"] = function (functionName, params) {\r\n    return new TC.filter.Function(functionName, params);\r\n};\r\n\r\nTC.filter.like = function (propertyName, pattern,\r\n    opt_wildCard, opt_singleChar, opt_escapeChar, opt_matchCase) {\r\n    return new TC.filter.IsLike(propertyName, pattern,\r\n        opt_wildCard, opt_singleChar, opt_escapeChar, opt_matchCase);\r\n};\r\n\r\nTC.filter.LogicalNary = function (tagName, conditions) {\r\n\r\n    TC.filter.Filter.call(this, tagName);\r\n\r\n    this.conditions = Array.prototype.slice.call(arguments, 1);\r\n};\r\nTC.inherit(TC.filter.LogicalNary, TC.filter.Filter);\r\n\r\nTC.filter.And = function (conditions) {\r\n    var params = ['And'].concat(Array.prototype.slice.call(arguments));\r\n    TC.filter.LogicalNary.apply(this, params);\r\n};\r\nTC.inherit(TC.filter.And, TC.filter.LogicalNary);\r\n\r\nTC.filter.Or = function (conditions) {\r\n    var params = ['Or'].concat(Array.prototype.slice.call(arguments));\r\n    TC.filter.LogicalNary.apply(this, params);\r\n};\r\nTC.inherit(TC.filter.Or, TC.filter.LogicalNary);\r\n\r\nTC.filter.LogicalNary.prototype.write = function () {\r\n    return '<{prefix}:{tag}>{inner}</{prefix}:{tag}>'.format({\r\n        prefix: this._defaultPrefixNS,\r\n        tag: this.getTagName(),\r\n        inner: this.writeInnerArrayCondition_()\r\n    });\r\n}\r\n\r\nTC.filter.Not = function (condition) {\r\n    this.condition = condition;\r\n    TC.filter.Filter.call(this, 'Not');\r\n    \r\n};\r\nTC.inherit(TC.filter.Not, TC.filter.Filter);\r\n\r\nTC.filter.Filter.prototype.write=function () {\r\n    return '<{prefix}:{tag}>{inner}</{prefix}:{tag}>'.format({\r\n        prefix: this._defaultPrefixNS,\r\n        tag: this.getTagName(),\r\n        inner: this.writeInnerCondition_(this.condition)\r\n    });\r\n}\r\n\r\nTC.filter.Comparison = function (tagName, propertyName) {\r\n\r\n    TC.filter.Filter.call(this, tagName);\r\n\r\n    this.propertyName = propertyName;\r\n};\r\nTC.inherit(TC.filter.Comparison, TC.filter.Filter);\r\n\r\nTC.filter.Comparison.prototype.write = function () {\r\n    var values = '';\r\n    //isbetween\r\n    if (this.lowerBoundary && this.upperBoundary)\r\n        values = '<{prefix}:LowerBoundary><{prefix}:Literal>{LowerBoundary}</{prefix}:Literal></{prefix}:LowerBoundary><{prefix}:UpperBoundary><{prefix}:Literal>{UpperBoundary}</{prefix}:Literal></{prefix}:UpperBoundary>'.format({\r\n            prefix:this._defaultPrefixNS,\r\n            LowerBoundary: this.lowerBoundary,\r\n            UpperBoundary: this.upperBoundary\r\n        });\r\n    if (this.pattern)\r\n        values = '<{prefix}:Literal><![CDATA[{Pattern}]]></{prefix}:Literal>'.format({\r\n            prefix: this._defaultPrefixNS,\r\n            Pattern: this.pattern\r\n        });\r\n    if (this.params)\r\n        if (Array.isArray(this.params))\r\n            values = this.params.reduce(function (a, b, i) {\r\n                var fmt = function (text) {\r\n                    return '<{prefix}:Literal><![CDATA[{value}]]></{prefix}:Literal>'.format({ prefix: this._defaultPrefixNS, value: text });\r\n                }\r\n                return (i > 0 ? a : fmt(a)) + fmt(b);\r\n            });\r\n        else\r\n            values = '<{prefix}:Literal><![CDATA[{value}]]></{prefix}:Literal>'.format({ prefix: this._defaultPrefixNS, value: this.params });\r\n\r\n    return '<{prefix}:{tag}{matchCase}{escape}{singleChar}{wildCard}><{prefix}:{fieldTitle}>{name}</{prefix}:{fieldTitle}>{values}</{prefix}:{tag}>'.format({\r\n        prefix: this._defaultPrefixNS,\r\n        tag: this.getTagName(),\r\n        matchCase: (typeof (this.matchCase) !== \"undefined\" ? \" matchCase=\\\"\" + this.matchCase + \"\\\"\" : \"\"),\r\n        escape: (typeof (this.escapeChar) !== \"undefined\" ? (\" \" + this._escapeAttrName +\"=\\\"\" + this.escapeChar + \"\\\"\") : \"\"),\r\n        singleChar: (typeof (this.singleChar) !== \"undefined\" ? \" singleChar=\\\"\" + this.singleChar + \"\\\"\" : \"\"),\r\n        wildCard: (typeof (this.wildCard) !== \"undefined\" ? \" wildCard=\\\"\" + this.wildCard + \"\\\"\" : \"\"),\r\n        name: this.propertyName,\r\n        values: values,\r\n        fieldTitle: this._fieldTitle\r\n    });\r\n}\r\n\r\nTC.filter.ComparisonBinary = function (\r\n    tagName, propertyName, expression, opt_matchCase) {\r\n\r\n    TC.filter.Comparison.call(this, tagName, propertyName);\r\n\r\n    this.expression = expression;\r\n\r\n    this.matchCase = opt_matchCase;\r\n};\r\nTC.inherit(TC.filter.ComparisonBinary, TC.filter.Comparison);\r\n\r\nTC.filter.ComparisonBinary.prototype.write = function () {\r\n    var _str = '<{prefix}:{tag}{matchCase}>' + (this.propertyName instanceof TC.filter.Filter ? '{name}' : '<{prefix}:{fieldTitle}>{name}</{prefix}:{fieldTitle}>') + '<{prefix}:Literal><![CDATA[{value}]]></{prefix}:Literal></{prefix}:{tag}>';\r\n    return _str.format({\r\n        prefix: this._defaultPrefixNS,\r\n        tag: this.getTagName(),\r\n        matchCase: (typeof (this.matchCase) !== \"undefined\" ? \" matchCase=\\\"\" + this.matchCase + \"\\\"\" : \"\"),\r\n        //escape:(typeof(this.escapeChar)!==\"undefined\"? \" escape=\\\"\" + this.escapeChar+ \"\\\"\":\"\"),\r\n        //singleChar:(typeof(this.singleChar)!==\"undefined\"? \" singleChar=\\\"\" + this.singleChar+ \"\\\"\":\"\"),\r\n        //wildCard:(typeof(this.wildCard)!==\"undefined\"? \" wildCard=\\\"\" + this.wildCard+ \"\\\"\":\"\"),\r\n        name: this.propertyName instanceof TC.filter.Filter ? this.propertyName.write() : this.propertyName,\r\n        value: this.expression,\r\n        fieldTitle: this._fieldTitle\r\n    });\r\n}\r\nTC.filter.EqualTo = function (propertyName, expression, opt_matchCase) {\r\n    TC.filter.ComparisonBinary.call(this, 'PropertyIsEqualTo', propertyName, expression, opt_matchCase);\r\n};\r\nTC.inherit(TC.filter.EqualTo, TC.filter.ComparisonBinary);\r\n\r\nTC.filter.GreaterThan = function (propertyName, expression) {\r\n    TC.filter.ComparisonBinary.call(this, 'PropertyIsGreaterThan', propertyName, expression);\r\n};\r\nTC.inherit(TC.filter.GreaterThan, TC.filter.ComparisonBinary);\r\n\r\nTC.filter.GreaterThanOrEqualTo = function (propertyName, expression) {\r\n    TC.filter.ComparisonBinary.call(this, 'PropertyIsGreaterThanOrEqualTo', propertyName, expression);\r\n};\r\nTC.inherit(TC.filter.GreaterThanOrEqualTo, TC.filter.ComparisonBinary);\r\n\r\nTC.filter.LessThan = function (propertyName, expression) {\r\n    TC.filter.ComparisonBinary.call(this, 'PropertyIsLessThan', propertyName, expression);\r\n};\r\nTC.inherit(TC.filter.LessThan, TC.filter.ComparisonBinary);\r\n\r\nTC.filter.LessThanOrEqualTo = function (propertyName, expression) {\r\n    TC.filter.ComparisonBinary.call(this, 'PropertyIsLessThanOrEqualTo', propertyName, expression);\r\n};\r\nTC.inherit(TC.filter.LessThanOrEqualTo, TC.filter.ComparisonBinary);\r\n\r\nTC.filter.NotEqualTo = function (propertyName, expression, opt_matchCase) {\r\n    TC.filter.ComparisonBinary.call(this, 'PropertyIsNotEqualTo', propertyName, expression, opt_matchCase);\r\n};\r\nTC.inherit(TC.filter.NotEqualTo, TC.filter.ComparisonBinary);\r\n\r\nTC.filter.IsLike = function (propertyName, pattern,\r\n    opt_wildCard, opt_singleChar, opt_escapeChar, opt_matchCase) {\r\n    TC.filter.Comparison.call(this, 'PropertyIsLike', propertyName);\r\n\r\n    this.pattern = pattern;\r\n\r\n    this.wildCard = (opt_wildCard !== undefined) ? opt_wildCard : '*';\r\n\r\n    this.singleChar = (opt_singleChar !== undefined) ? opt_singleChar : '.';\r\n\r\n    this.escapeChar = (opt_escapeChar !== undefined) ? opt_escapeChar : '!';\r\n\r\n    this.matchCase = opt_matchCase;\r\n};\r\nTC.inherit(TC.filter.IsLike, TC.filter.Comparison);\r\n\r\nTC.filter.IsNull = function (propertyName) {\r\n    TC.filter.Comparison.call(this, 'PropertyIsNull', propertyName);\r\n};\r\nTC.inherit(TC.filter.IsNull, TC.filter.Comparison);\r\n\r\nTC.filter.IsBetween = function (propertyName, lowerBoundary, upperBoundary) {\r\n    TC.filter.Comparison.call(this, 'PropertyIsBetween', propertyName);\r\n    this.lowerBoundary = lowerBoundary;\r\n    this.upperBoundary = upperBoundary;\r\n};\r\nTC.inherit(TC.filter.IsBetween, TC.filter.Comparison);\r\n\r\nTC.filter.Function = function (functionName, params) {\r\n    TC.filter.Filter.call(this, functionName);\r\n    this.params = params\r\n};\r\nTC.inherit(TC.filter.Function, TC.filter.Filter);\r\n\r\nTC.filter.Function.prototype.write = function () {\r\n    var values = '';\r\n    if (this.params) {\r\n        var _paramsToText = function (param, prefix) {\r\n            if (typeof (param) === \"string\") {\r\n                return '<{prefix}:Literal><![CDATA[{value}]]></{prefix}:Literal>'.format({ prefix: prefix, value: param });\r\n            }\r\n            if (typeof (param) === \"object\") {\r\n                var _text = '';\r\n                for (var attr in param) {\r\n                    _text = _text + '<{prefix}:{key}>{value}</{prefix}:{key}>'.format({ prefix: prefix, value: param[attr], key: attr })\r\n                }\r\n                return _text;\r\n            }\r\n        }\r\n        if (Array.isArray(this.params)) {\r\n            var prefix = this._defaultPrefixNS;\r\n            values = this.params.reduce(function (a, b, i) {\r\n                var fmt = function (param) {\r\n                    return _paramsToText(param, prefix);\r\n                }\r\n                return (i > 1 ? a : fmt(a)) + fmt(b);\r\n            });\r\n        }\r\n        else\r\n            values = _paramsToText(this.params, this._defaultPrefixNS);\r\n    }\r\n    return '<{prefix}:Function name=\"{tag}\">{inner}</{prefix}:Function>'.format({\r\n        prefix: this._defaultPrefixNS,\r\n        tag: this.getTagName(),\r\n        inner: values\r\n    });\r\n};\r\n\r\nTC.filter.Spatial = function (tagName, geometryName, geometry, opt_srsName) {\r\n    TC.filter.Filter.call(this, tagName);\r\n    this.geometryName = geometryName;\r\n    this.geometry = geometry;\r\n    this.srsName = opt_srsName;\r\n    this.wrap = new TC.wrap.Filter(this);\r\n};\r\n\r\nTC.wrap.Filter = function (filter) {\r\n    this.parent = filter;\r\n};\r\n\r\nTC.wrap.Filter.prototype.getAxisOrientation = function () {\r\n    // Establecemos el srsName a EPSG:xxxx o urn:x-ogc:def:crs:EPSG:xxxx dependiendo del orden de eje de coordenadas del CRS.\r\n    // Esto se debe a que GeoServer hace asunciones en el orden de los ejes dependiendo del formato de srsName que se use.\r\n    // Más información: https://docs.geoserver.org/latest/en/user/services/wfs/basics.html#wfs-basics-axis\r\n    var srsName = this.parent.srsName;\r\n    if (srsName) {\r\n        const match = srsName.match(/\\d{4,6}$/);\r\n        if (match) {\r\n            const code = match[0];\r\n            const def = ol.proj.get(srsName);\r\n            if (def) {\r\n                return ((def.axisOrientation_ === 'neu' ? 'urn:x-ogc:def:crs:EPSG:' : 'EPSG:') + code);\r\n            }\r\n        }\r\n    }\r\n    return srsName;\r\n};\r\n\r\nTC.inherit(TC.filter.Spatial, TC.filter.Filter);\r\n\r\nTC.filter.Spatial.prototype.write = function () {\r\n    var pattern = null;\r\n    if (this.geometryName) {\r\n        pattern = '<{prefix}:{tag}><{prefix}:{fieldTitle}>{name}</{prefix}:{fieldTitle}>{geometry}</{prefix}:{tag}>';\r\n    }\r\n    else {\r\n        pattern = '<{prefix}:{tag}><{prefix}:{fieldTitle}/>{geometry}</{prefix}:{tag}>';\r\n    }\r\n\r\n    return pattern.format({\r\n        prefix: this._defaultPrefixNS,\r\n        tag: this.getTagName(),\r\n        name: this.geometryName,\r\n        geometry: (this.geometry instanceof TC.filter.Function ? this.writeInnerCondition_(this.geometry) : this.geometry.wrap.toGML(undefined, this.wrap.getAxisOrientation())),\r\n        fieldTitle: this._fieldTitle\r\n    });\r\n};\r\n\r\nTC.filter.bbox = function () {\r\n    if (Object.prototype.toString.call(arguments[0]) !== \"[object String]\")\r\n        return new TC.filter.Bbox(null, arguments[0], arguments[1]);\r\n    else\r\n        return new TC.filter.Bbox(arguments[0], arguments[1], arguments[2]);\r\n};\r\n\r\nTC.filter.Bbox = function (geometryName, extent, opt_srsName) {\r\n    TC.filter.Filter.call(this, 'BBOX');\r\n    this.geometryName = geometryName;\r\n    this.extent = extent;\r\n    this.srsName = opt_srsName;\r\n};\r\nTC.inherit(TC.filter.Bbox, TC.filter.Spatial);\r\n\r\nTC.filter.Bbox.prototype.write = function () {\r\n    var bbox = '<gml:Envelope{srsName}><gml:lowerCorner>{lowerCorner}</gml:lowerCorner><gml:upperCorner>{upperCorner}</gml:upperCorner></gml:Envelope>'\r\n\t.format({\r\n\t    srsName: (typeof (this.srsName) !== \"undefined\" ? \" srsName=\\\"\" + this.srsName + \"\\\"\" : \"\"),\r\n\t    lowerCorner: (this.extent[0] + ' ' + this.extent[1]),\r\n\t    upperCorner: (this.extent[2] + ' ' + this.extent[3])\r\n\t});\r\n    var pattern = null;\r\n    if (this.geometryName)\r\n        pattern='<{prefix}:{tag}><{prefix}:{fieldTitle}>{name}</{prefix}:{fieldTitle}>{BBOX}</{prefix}:{tag}>';\r\n    else\r\n        pattern='<{prefix}:{tag}><{prefix}:{fieldTitle}/>{BBOX}</{prefix}:{tag}>';\r\n    return pattern.format({\r\n        prefix: this._defaultPrefixNS,\r\n        tag: this.getTagName(),\r\n        fieldTitle:  this._fieldTitle,\r\n        name: this.geometryName,\r\n        BBOX: bbox\r\n    });\r\n};\r\n\r\nTC.filter.Intersects = function (geometryName, geometry, opt_srsName) {\r\n    TC.filter.Spatial.call(this, 'Intersects', geometryName, geometry, opt_srsName);\r\n};\r\nTC.inherit(TC.filter.Intersects, TC.filter.Spatial);\r\n\r\nTC.filter.Within = function (geometryName, geometry, opt_srsName) {\r\n    TC.filter.Spatial.call(this, 'Within', geometryName, geometry, opt_srsName);\r\n};\r\nTC.inherit(TC.filter.Within, TC.filter.Spatial);"]}