{"version":3,"sources":["control/WFSQuery.js"],"names":["TC","control","Object","assign","defineProperty","value","target","varArgs","TypeError","to","index","arguments","length","nextSource","nextKey","prototype","hasOwnProperty","call","writable","configurable","Control","syncLoadJS","apiLocation","infoShare","filter","Feature","feature","Point","Polyline","Polygon","MultiPolyline","MultiPolygon","WFSQuery","options","apply","this","_dialogDiv","Util","getDiv","dialogDiv","document","body","appendChild","exportsState","styles","highlightStyles","highLightStyles","download","resultsPanel","geometryPanel","filters","extend","polygon","strokeColor","DEFAULT_STROKE_COLOR","strokeWidth","fillColor","fillOpacity","line","cs","CLASS","_selectors","ELEVATION_CHECKBOX","INTERPOLATION_RADIO","INTERPOLATION_DISTANCE","inherit","mix","ctlProto","loadingCssClass","Consts","classes","LOADING","hiddenCssClass","HIDDEN","modalBody","timer","logicalOperator","AND","timerAutocomplete","controller","locale","empty","node","children","removeChild","filterByOperation","eq","Ctor","equalTo","key","neq","notEqualTo","gt","greaterThan","lt","lessThan","gte","greaterThanOrEqualTo","lte","lessThanOrEqualTo","contains","like","starts","ends","btw","between","nbtw","intersects","within","null","isNull","_currentLayer","_currentLayerName","_currentLayercapabilities","_currentLayerTitle","_currentLayerURL","_getStyles","_getHighLightStyles","getLocaleString","type","template","1","container","depth0","helpers","partials","data","stack1","alias1","nullContext","lookupProperty","parent","propertyName","escapeExpression","name","hash","loc","start","column","end","fn","program","inverse","noop","2","lambda","alias2","compiler","main","useData","3","alias3","4","6","8","blockParams","depths","5","10","11","13","15","16","17","18","invokePartial","indent","decorators","usePartial","useDepths","7","9","12","14","19","21","checkInput","input","createElement","setAttribute","dateInputMask","inputMaskNumber","_createDateMask","txtBox","Promise","resolve","reject","setTimeout","loadJS","isDebug","console","log","then","IMask","mask","Date","pattern","lazy","format","date","day","getDate","month","getMonth","year","getFullYear","join","parse","str","split","blocks","d","MaskedRange","from","maxLength","m","Y","_destroyDateMask","el","destroy","_changeAttributeEvent","form","combo","parentElement","querySelectorAll","forEach","element","offsetTop","numericSection","querySelector","textSection","dateSection","geomSection","whereSection","opSection","valueField","disabled","dataset","UI","autocomplete","classList","add","selectedOptions","substring","indexOf","remove","destroyNumberMask","html","isGeometry","insertAdjacentHTML","className","parentNode","insertBefore","nextSibling","firstElementChild","addEventListener","checked","detectIE","Number","scale","signed","thousandsSeparator","padFractionalZeros","normalizeZeros","radix","step","slice","reduce","vi","va","_autocompleteConstructor","getElementsByClassName","_renderFilterConditions","ctl","getForm","whereDiv","getRenderedHtml","conditions","map","f","isSpatial","Spatial","field","opText","_abbr","valueToShow","_valueToShow","getTemplateObjFromFilter","innerHTML","btn","idx","event","CLICK","zoomToFeatures","geometry","showGeometryPanel","passive","removeFilter","_getLayerName","_createResultPanel","layerName","self","_layerName","async","save","fileName","ccontainer","getControlsByClass","ControlContainer","panelOptions","content","titles","max","_self","getDownloadDialog","title","elevation","displayElevation","open","resultsLayer","features","_downloadClickHandler","share","resize","addControl","caller","position","_showMessage","Message","messageDiv","clearTimeout","msgType","INFO","WARNING","ERROR","property","listCtrl","minLength","source","text","callback","window","_capabilities","abort","signal","AbortController","toolProxification","fetch","WFGetPropertyValue","undefined","contentType","method","startsWith","xmlDoc","DOMParser","parseFromString","responseText","error","arr","item","JSON","properties","pv","cv","Array","concat","err","DOMException","_getPossibleValues","sort","e","currentTarget","buildHTML","style","maxHeight","results","cp","i","_highlightText","which","RegExp","replace","_select","_addFeature","layer","result","addPoint","getCoords","addPolyline","addPolygon","addMultiPolygon","addMultiPolyline","getLayer","addLayer","id","layerType","VECTOR","owner","stealth","render","_set1stRenderPromise","all","register","on","LAYERERROR","modalDialog","reason","WFSErrors","MAX_NUM_FEATURES","limit","ctrl","_hbs","formatNumber","registerHelper","toLocaleString","styleFN","geomType","Cfg","bind","strokeOpacity","point","radius","height","width","fontSize","fontColor","labelOutlineColor","labelOutlineWidth","label","angle","_default","texts","ready","addLayerTool","renderFn","layerId","button","WMS","WFS","getWFSCapabilities","WFSCapabilities","Operations","GetFeature","layers","getDisgregatedLayerNames","featureType","l","FeatureTypes","catch","finally","updateEvents","actionFn","renderModalDialog","getShareDialog","Error","_onFeaturesUpdate","newData","totalFeatures","toShare","doZoom","_setQueryToSearch","serviceAttrName","layerAttrName","title_separator","Click","some","c","TITLE_SEPARATOR","find","path","getPath","allData","getData","clearData","setData","showResultsPanel","off","LAYERUPDATE","_onBeforeApplyQuery","query","_sendQuery","_url","getWFSURL","cacheHost","getAction","url","action","removeLayer","BEFOREAPPLYQUERY","setVisibility","clearFeatures","featurePrefix","refresh","geometryName","outputFormat","RESULTSPANELCLOSE","browserFeatures","touch","swipe","div","clearFilters","sendQuery","validateQuery","condition","keys","Filter","wms","names","getText","_getQueryToSearch","exportState","queryResult","stringify","importState","state","wait","getLoadingIndicator","addWait","loaded","sharedQueryToSearch","wmsLayer","workLayers","describeFeatureType","_manageDescribeFeature","removeWait","alert","layername","innerText","numero","dataTypes","_internalGetDataTypes","openTable","css","trClass","tdClass","thClass","tabla","maximize","col","j","tdNumeric","k","stopPropagation","feat","celdasHoja","celda","offsetWidth","scrollWidth","td","chkBox","nextElementSibling","FeatureInfoCommons","addSpecialAttributeEventListeners","v","mode","closeModal","ctlOptions","ctlContainer","POSITION","RIGHT","drawControl","cancel","showModal","closeCallback","close","getTableContainer","DRAWEND","showsPopup","op","Intersects","crs","Within","push","toggle","setMode","renderForm","entries","operators","attributes","controlId","dialog","removeAttribute","ipt","trim","createEvent","initEvent","dispatchEvent","radio","OR","masked","number","opcion","isComplete","test","checkValidity","_validate","unmaskedValue","toLocaleDateString","timeZone","dotOrComma","_getValueToShow","parseInt","parseFloat","toISOString","not","matchCase","onGeomClick","_renderQueryForm","args","capabilities","DescribeFeatureType","DCP","HTTP","Get","URL","host","location","CountDefault","_maxRecordCount","DefaultValue","selectedIndex","tbody","Title","toast","capabilitiesPromise","getCapabilitiesPromise","renderDialogPromise","a","b","elm","modal","childNodes","firstChild","coef","clientWidth","clientHeight","previousElementSibling","removedFilter","splice","removeFeature"],"mappings":"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","sourcesContent":["/// <reference path=\"popup.js\" />\r\n\r\n/**\r\n  * Opciones de control de consultas.\r\n  * \r\n  * Algunos servidores tienen servicios WMS y WFS que actúan en paralelo, es decir, están alojados dentro del mismo nombre de host y publican las mismas capas.\r\n  * Si el control `WFSQuery` está en el mapa, verifica si las capas de servicios WMS están asociadas a un WFS paralelo. Si es así, ofrece un interfaz de usuario\r\n  * para poder hacer consultas a la capa en base a los valores de las propiedades de los elementos de la capa. Esta interfaz de usuario es accesible desde el control\r\n  * `workLayerManager`.\r\n  * @typedef WFSQueryOptions\r\n  * @see MapControlOptions\r\n  * @property {StyleOptions} [styles] - Opciones de estilo de las geometrías de las entidades resultado de la consulta.\r\n  * @property {StyleOptions} [highlightStyles] - Opciones de estilo de las geometrías de las entidades resaltadas.\r\n  * @example <caption>[Ver en vivo](../examples/cfg.WFSQueryOptions.html)</caption> {@lang html}\r\n  * <div id=\"mapa\" />\r\n  * <script>\r\n  *     // Establecemos un layout simplificado apto para hacer demostraciones de controles.\r\n  *     SITNA.Cfg.layout = \"layout/ctl-container\";\r\n  *     // Añadimos el control de capas cargadas en la primera posición.\r\n  *     SITNA.Cfg.controls.workLayerManager = {\r\n  *         div: \"slot1\"\r\n  *     };\r\n  *     //Si se añade el control WFSQuery, el control busca un servicio WFS pareado al WMS de cada capa añadida al mapa y si lo encuentra habilita la lupa que da acceso al constructor de consultas.\r\n  *     SITNA.Cfg.controls.WFSQuery = {\r\n  *         //Establecemos el estilo de las geometrías de las entidades resultado de la consulta\r\n  *         styles: {\r\n  *             //Estilo de polígonos y multipolígonos\r\n  *             polygon: {\r\n  *                 strokeColor: \"#057f28\",\r\n  *                 strokeWidth: 4,\r\n  *                 fillColor: \"#057f28\",\r\n  *                 fillOpacity: 0.3\r\n  *             },\r\n  *             //Estilo de polilíneas y multipolilíneas\r\n  *             line: {\r\n  *                 strokeColor: \"#057f28\",\r\n  *                 strokeWidth: 4\r\n  *             },\r\n  *             //Estilo de puntos y multipuntos\r\n  *             point: {\r\n  *                 strokeColor: \"#057f28\"\r\n  *             }\r\n  *         },\r\n  *         //Establecemos el estilo de las geometrías de las entidades resaltadas\r\n  *         highlightStyles: {\r\n  *             //Estilo de polígonos y multipolígonos\r\n  *             polygon: {\r\n  *                 strokeColor: \"#ff7f27\",\r\n  *                 strokeWidth: 4,\r\n  *                 fillColor: \"#ff7f27\",\r\n  *                 fillOpacity: 0.3\r\n  *             },\r\n  *             //Estilo de polilíneas y multipolilíneas\r\n  *             line: {\r\n  *                 strokeColor: \"#ff7f27\",\r\n  *                 strokeWidth: 4\r\n  *             },\r\n  *             //Estilo de puntos y multipuntos\r\n  *             point: {\r\n  *                 strokeColor: \"#ff7f27\"\r\n  *             }\r\n  *         }\r\n  *     };\r\n  *     var map = new SITNA.Map(\"mapa\", {\r\n  *         workLayers: [{\r\n  *             id: \"paisajes\",\r\n  *             title: \"Paisajes singulares\",\r\n  *             type: SITNA.Consts.layerType.WMS,\r\n  *             url: \"//idena.navarra.es/ogc/wms\",\r\n  *             layerNames: \"IDENA:BIODIV_Pol_PaisajesSing\"\r\n  *         },\r\n  *         {\r\n  *             id: \"meteorologia\",\r\n  *             title: \"Meteorología\",\r\n  *             type: SITNA.Consts.layerType.WMS,\r\n  *             url: \"//idena.navarra.es/ogc/wms\",\r\n  *             layerNames: \"IDENA:estacMeteor\"\r\n  *         },\r\n  *         {\r\n  *             id: \"plazaola\",\r\n  *             title: \"Vía Verde del Plazaola\",\r\n  *             type: SITNA.Consts.layerType.WMS,\r\n  *             url: \"//idena.navarra.es/ogc/wms\",\r\n  *             layerNames: \"IDENA:DOTACI_Lin_VVPlazaola\"\r\n  *         }]\r\n  *     });\r\n  * </script>\r\n  */\r\n\r\nTC.control = TC.control || {};\r\n\r\n/*pollyfill*/\r\n\r\nif (typeof Object.assign != 'function') {\r\n    // Must be writable: true, enumerable: false, configurable: true\r\n    Object.defineProperty(Object, \"assign\", {\r\n        value: function assign(target, varArgs) { // .length of function is 2\r\n            'use strict';\r\n            if (target == null) { // TypeError if undefined or null\r\n                throw new TypeError('Cannot convert undefined or null to object');\r\n            }\r\n\r\n            var to = Object(target);\r\n\r\n            for (var index = 1; index < arguments.length; index++) {\r\n                var nextSource = arguments[index];\r\n\r\n                if (nextSource != null) { // Skip over if undefined or null\r\n                    for (var nextKey in nextSource) {\r\n                        // Avoid bugs when hasOwnProperty is shadowed\r\n                        if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\r\n                            to[nextKey] = nextSource[nextKey];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return to;\r\n        },\r\n        writable: true,\r\n        configurable: true\r\n    });\r\n}\r\n\r\n\r\nif (!TC.Control) {\r\n    TC.syncLoadJS(TC.apiLocation + 'TC/Control');\r\n}\r\n\r\nif (!TC.control.infoShare) {\r\n    TC.syncLoadJS(TC.apiLocation + 'TC/control/infoShare');\r\n}\r\n\r\nif (!TC.filter) {\r\n    TC.syncLoadJS(TC.apiLocation + 'TC/filter');\r\n}\r\n//cargo los objetos features si no, no resaltara las geometria\r\nif (!TC.Feature) {\r\n    TC.syncLoadJS(TC.apiLocation + 'TC/Feature');\r\n}\r\nif (!TC.feature.Point) {\r\n    TC.syncLoadJS(TC.apiLocation + 'TC/feature/Point');\r\n}\r\nif (!TC.feature.Polyline) {\r\n    TC.syncLoadJS(TC.apiLocation + 'TC/feature/Polyline');\r\n}\r\nif (!TC.feature.Polygon) {\r\n    TC.syncLoadJS(TC.apiLocation + 'TC/feature/Polygon');\r\n}\r\nif (!TC.feature.MultiPolyline) {\r\n    TC.syncLoadJS(TC.apiLocation + 'TC/feature/MultiPolyline');\r\n}\r\nif (!TC.feature.MultiPolygon) {\r\n    TC.syncLoadJS(TC.apiLocation + 'TC/feature/MultiPolygon');\r\n}\r\n\r\nTC.control.WFSQuery = function (options) {\r\n    var self = this;\r\n\r\n    TC.Control.apply(this, arguments);\r\n\r\n    self._dialogDiv = TC.Util.getDiv(self.options.dialogDiv);\r\n    if (!self.options.dialogDiv) {\r\n        document.body.appendChild(self._dialogDiv);\r\n    }\r\n\r\n    self.exportsState = true;\r\n\r\n    self.styles = self.options.styles;\r\n    self.highlightStyles = self.options.highlightStyles || self.options.highLightStyles;\r\n    self.download = self.options.download;\r\n    self.resultsPanel = null;\r\n    self.geometryPanel = null;\r\n    self.filters = [];\r\n    self.styles = TC.Util.extend(true, {\r\n        polygon: {\r\n            strokeColor: self.DEFAULT_STROKE_COLOR,\r\n            strokeWidth: 2, fillColor: \"#000\",\r\n            fillOpacity: 0.3\r\n        },\r\n        line: {\r\n            strokeColor: self.DEFAULT_STROKE_COLOR,\r\n            strokeWidth: 2, fillColor: \"#000\"\r\n        }\r\n    }, self.options.styles);\r\n\r\n    const cs = '.' + self.CLASS;\r\n    self._selectors = {\r\n        ELEVATION_CHECKBOX: cs + '-dialog-elev input[type=checkbox]',\r\n        INTERPOLATION_RADIO: 'input[type=radio][name=finfo-ip-coords]',\r\n        INTERPOLATION_DISTANCE: cs + '-dialog-ip-m'\r\n    };\r\n};\r\n\r\nTC.inherit(TC.control.WFSQuery, TC.Control);\r\nTC.mix(TC.control.WFSQuery, TC.control.infoShare);\r\n\r\n(function () {\r\n    const ctlProto = TC.control.WFSQuery.prototype;\r\n    ctlProto.DEFAULT_STROKE_COLOR = '#0000ff';\r\n\r\n    const loadingCssClass = TC.Consts.classes.LOADING;\r\n    const hiddenCssClass = TC.Consts.classes.HIDDEN;\r\n    const spatialCssClass = 'tc-spatial';\r\n    var modalBody = null;\r\n    var logicalOperator = TC.Consts.logicalOperator.AND;\r\n    var timer = null;\r\n    var timerAutocomplete = null;\r\n    var controller = null;\r\n    var locale = null;\r\n\r\n    const empty = function (node) {\r\n        if (node)\r\n            while (node.children.length) {\r\n                node.removeChild(node.children[0]);\r\n            }\r\n    };\r\n\r\n    const getTemplateObjFromFilter = function (ctl, filter) {\r\n        const isSpatial = filter instanceof TC.filter.Spatial;\r\n        return {\r\n            field: isSpatial ? ctl.getLocaleString('geometry') : filter.propertyName,\r\n            opText: ctl.getLocaleString(filterByOperation[filter._abbr].key),\r\n            valueToShow: filter._valueToShow,\r\n            isSpatial: isSpatial\r\n        }\r\n    };\r\n\r\n    const filterByOperation = {\r\n        eq: {\r\n            Ctor: TC.filter.equalTo,\r\n            key: 'query.equalTo'\r\n        },\r\n        neq: {\r\n            Ctor: TC.filter.notEqualTo,\r\n            key: 'query.notEqualTo'\r\n        },\r\n        gt: {\r\n            Ctor: TC.filter.greaterThan,\r\n            key: 'query.greaterThan'\r\n        },\r\n        lt: {\r\n            Ctor: TC.filter.lessThan,\r\n            key: 'query.lowerThan'\r\n        },\r\n        gte: {\r\n            Ctor: TC.filter.greaterThanOrEqualTo,\r\n            key: 'query.greaterThanOrEqualTo'\r\n        },\r\n        lte: {\r\n            Ctor: TC.filter.lessThanOrEqualTo,\r\n            key: 'query.lowerThanOrEqualTo'\r\n        },\r\n        contains: {\r\n            Ctor: TC.filter.like,\r\n            key: 'query.contains'\r\n        },\r\n        starts: {\r\n            Ctor: TC.filter.like,\r\n            key: 'query.startsBy'\r\n        },\r\n        ends: {\r\n            Ctor: TC.filter.like,\r\n            key: 'query.endsBy'\r\n        },\r\n        btw: {\r\n            Ctor: TC.filter.between,\r\n            key: 'query.equalTo'\r\n        },\r\n        nbtw: {\r\n            key: 'query.notEqualTo'\r\n        },\r\n        intersects: {\r\n            Ctor: TC.filter.like,\r\n            key: 'query.intersects'\r\n        },\r\n        within: {\r\n            Ctor: TC.filter.between,\r\n            key: 'query.within'\r\n        },\r\n        empty: {\r\n            Ctor: TC.filter.equalTo,\r\n            key: 'query.empty'\r\n        },\r\n        null: {\r\n            Ctor: TC.filter.isNull,\r\n            key: 'query.empty'\r\n        }\r\n    };\r\n\r\n    var _currentLayer = null;\r\n    var _currentLayerName = null;\r\n    var _currentLayercapabilities = null;\r\n    var _currentLayerTitle = null;\r\n    var _currentLayerURL = null;\r\n    var _getStyles = function () { return null };\r\n    var _getHighLightStyles = function () { return null };\r\n    var getLocaleString = null;\r\n    var type = null;\r\n    ctlProto.CLASS = 'tc-ctl-wfsquery';\r\n\r\n    ctlProto.template = {};\r\n    ctlProto.template[ctlProto.CLASS + \"-dialog\"] = TC.apiLocation + \"TC/templates/tc-ctl-wfsquery-dialog.hbs\";\r\n    ctlProto.template[ctlProto.CLASS + \"-form\"] = TC.apiLocation + \"TC/templates/tc-ctl-wfsquery-form.hbs\";\r\n    ctlProto.template[ctlProto.CLASS + \"-filter\"] = TC.apiLocation + \"TC/templates/tc-ctl-wfsquery-filter.hbs\";\r\n    ctlProto.template[ctlProto.CLASS + \"-table\"] = TC.apiLocation + \"TC/templates/tc-ctl-wfsquery-table.hbs\";\r\n    ctlProto.template[\"tc-ctl-finfo-attr-val\"] = TC.apiLocation + \"TC/templates/tc-ctl-finfo-attr-val.hbs\";\r\n    ctlProto.template[\"tc-ctl-finfo-object\"] = TC.apiLocation + \"TC/templates/tc-ctl-finfo-object.hbs\";\r\n    ctlProto.template[ctlProto.CLASS + \"-geom\"] = TC.apiLocation + \"TC/templates/tc-ctl-wfsquery-geom.hbs\";\r\n    ctlProto.template[ctlProto.CLASS + \"-share-dialog\"] = TC.apiLocation + \"TC/templates/tc-ctl-wfsquery-share-dialog.hbs\";\r\n\r\n\r\n    var checkInput = function (type) {\r\n        var input = document.createElement(\"input\");\r\n        input.setAttribute(\"type\", type);\r\n        return input.type == type;\r\n    };\r\n\r\n    var _loadDatePolyFill = function () {\r\n        return new Promise(function (resolve, reject) {\r\n            if (typeof (IMask) !== \"undefined\") {\r\n                setTimeout(function () {\r\n                    resolve();\r\n                }, 10);\r\n            }\r\n            else {\r\n                TC.loadJS(true,\r\n                    [TC.apiLocation + '/lib/polyfill/IMask' + (TC.isDebug ? '' : '.min') + '.js'],\r\n                    function () {\r\n                        console.log(\"Imask loaded\");\r\n                        resolve();\r\n                    });\r\n            }\r\n        });\r\n    };\r\n    var _loadNumberPolyFill = function () {\r\n        return new Promise(function (resolve, reject) {\r\n            if (typeof (IMask) !== \"undefined\") {\r\n                setTimeout(function () {\r\n                    resolve();\r\n                }, 10);\r\n            }\r\n            else {\r\n                TC.loadJS(true,\r\n                    [TC.apiLocation + '/lib/polyfill/IMask' + (TC.isDebug ? '' : '.min') + '.js'],\r\n                    function () {\r\n                        console.log(\"Imask loaded\");\r\n                        resolve();\r\n                    });\r\n            }\r\n        });\r\n    }\r\n\r\n    var _getValue = function (input) {\r\n        if (inputMaskNumber) {\r\n            return inputMaskNumber.unmaskedValue;\r\n\r\n        } else if (dateInputMask) {\r\n            //si es texto con mascara de fecha convertierto la fecha de dd/mm/yyyy a yyyy-mm-dd\r\n            return dateInputMask.unmaskedValue.substring(4) + \"-\" + dateInputMask.unmaskedValue.substring(2, 4) + \"-\" + dateInputMask.unmaskedValue.substring(0, 2)\r\n        }\r\n        return input.value;//en el resto de los casos la devuelvo tal cual\r\n\r\n    }\r\n    var _getValueToShow = function (input) {\r\n        if (inputMaskNumber) {\r\n            return inputMaskNumber.value;\r\n        }\r\n        else if (dateInputMask) {\r\n            //si es de tipo date devolvemos la fecha en formato dd/mm/yyyy\r\n            return dateInputMask.value;\r\n        }\r\n        else if (input.type === \"date\") {\r\n            return new Date(input.value).toLocaleDateString(locale,{timeZone: \"UTC\" })\r\n        }\r\n        else if (input.type === \"number\") {\r\n            var dotOrComma = 1.1.toLocaleString(locale).substring(1, 2);\r\n            return input.value.replace(\".\", dotOrComma);\r\n        }\r\n        return input.value;//en el resto de los casos la devuelvo tal cual\r\n\r\n    }\r\n    var dateInputMask = null;\r\n    var inputMaskNumber = null;\r\n    var _createDateMask = function (txtBox) {\r\n        if (checkInput(\"date\"))\r\n            txtBox.type = \"date\";\r\n        else {\r\n            txtBox.type = \"search\";\r\n            _loadDatePolyFill().then(function () {\r\n                //construir el polyfill\r\n                dateInputMask = new IMask(txtBox, {\r\n                    mask: Date,\r\n                    pattern: ((!locale || locale === \"es-ES\") ? 'd/`m/`Y' : (locale === \"eu-ES\" ? 'Y/`m/`d' : 'm/`d/`Y')),\r\n                    lazy: false,\r\n                    format: function (date) {\r\n                        var day = date.getDate();\r\n                        var month = date.getMonth() + 1;\r\n                        var year = date.getFullYear();\r\n                        if (day < 10) day = \"0\" + day;\r\n                        if (month < 10) month = \"0\" + month;\r\n                        switch (locale) {\r\n                            case \"eu-ES\":\r\n                                return [year, month, day].join('/');\r\n                                break;\r\n                            case \"en-US\":\r\n                                return [month, day, year].join('/');\r\n                                break;\r\n                            case \"es-ES\":\r\n                            default:\r\n                                return [day, month, year].join('/');\r\n                                break;\r\n                        }\r\n\r\n                    },\r\n                    // define str -> date convertion\r\n                    parse: function (str) {\r\n                        switch (locale) {\r\n                            case \"eu-ES\":\r\n                                return new Date(str.split('/')[1] + \"/\" + str.split('/')[2] + \"/\" + str.split('/')[0])\r\n                                break;\r\n                            case \"en-US\":\r\n                                return new Date(str)\r\n                                break;\r\n                            case \"es-ES\":\r\n                            default:\r\n                                return new Date(str.split('/')[1] + \"/\" + str.split('/')[0] + \"/\" + str.split('/')[2])\r\n                                break;\r\n                        }\r\n\r\n                    },\r\n                    blocks: {\r\n                        d: {\r\n                            mask: IMask.MaskedRange,\r\n                            from: 1,\r\n                            to: 31,\r\n                            maxLength: 2,\r\n                        },\r\n                        m: {\r\n                            mask: IMask.MaskedRange,\r\n                            from: 1,\r\n                            to: 12,\r\n                            maxLength: 2,\r\n                        },\r\n                        Y: {\r\n                            mask: IMask.MaskedRange,\r\n                            from: 1900,\r\n                            to: 9999,\r\n                        }\r\n                    }\r\n                });\r\n            });\r\n        }\r\n    };\r\n    var _destroyDateMask = function () {\r\n        if (dateInputMask) {\r\n            var input = dateInputMask.el.input;\r\n            dateInputMask.destroy();\r\n            dateInputMask = null;\r\n            input.value = \"\";\r\n            input.type = \"search\";\r\n        }\r\n    };\r\n    var destroyNumberMask = function () {\r\n        if (inputMaskNumber) {\r\n            var input = inputMaskNumber.el.input;\r\n            inputMaskNumber.destroy();\r\n            inputMaskNumber = null;\r\n            input.value = \"\";\r\n            input.type = \"search\";\r\n        }\r\n    };\r\n    var _getDataTypes = function () {\r\n        return _internalGetDataTypes();\r\n    }\r\n\r\n    var _manageComplexTypes = function (type, form) {\r\n\r\n        var html = '';\r\n        html += ('<option value=\"\">' + getLocaleString('query.chooseAttrCombo') + '</option>');\r\n        for (var key in type) {\r\n            if (!type[key].type || TC.Util.isGeometry(type[key].type)) continue;\r\n            html += '<option value=\"' + (type[key].name || key) + '\">' + key + '</option>';\r\n        }\r\n        var container = document.createElement(\"div\")\r\n        container.insertAdjacentHTML('beforeend', '<select class=\"' + this.className + '\" name=\"' + this.name + '\">' + html + '</select>');\r\n        this.parentNode.parentNode.insertBefore(container, this.parentNode.nextSibling).firstElementChild.addEventListener(\"change\", function () {\r\n            _changeAttributeEvent.apply(this, [form, type]);\r\n        });\r\n\r\n    }\r\n\r\n    const _changeAttributeEvent = function (form, data) {\r\n        //borrar los hijos\t\t\r\n        var combo = this;\r\n        combo.parentElement.parentElement.querySelectorAll(\"select\").forEach(function (element) {\r\n            if (combo.offsetTop < element.offsetTop) {\r\n                element.parentElement.parentElement.removeChild(element.parentElement);\r\n            }\r\n        });\r\n\r\n        const numericSection = form.querySelector(`.${ctlProto.CLASS}-numeric`);\r\n        const textSection = form.querySelector(`.${ctlProto.CLASS}-text`);\r\n        const dateSection = form.querySelector(`.${ctlProto.CLASS}-date`);\r\n        const geomSection = form.querySelector(`.${ctlProto.CLASS}-geom`);\r\n        const whereSection = form.querySelector(`.${ctlProto.CLASS}-where`);\r\n        const opSection = form.querySelector(`.${ctlProto.CLASS}-op`);\r\n        var valueField = whereSection.querySelector(\".tc-textbox\");\r\n        valueField.disabled = false;\r\n        if (valueField.dataset[\"autocomplete\"]) {\r\n            TC.UI.autocomplete.call(valueField, \"clear\");\r\n        }\r\n        numericSection.classList.add(hiddenCssClass);\r\n        dateSection.classList.add(hiddenCssClass);\r\n        textSection.classList.add(hiddenCssClass);\r\n        geomSection.classList.add(hiddenCssClass);\r\n        whereSection.classList.add(hiddenCssClass);\r\n        if (!data[this.selectedOptions[0].value.substring(this.selectedOptions[0].value.indexOf(\":\") + 1)]) {\r\n            opSection.classList.add(hiddenCssClass);\r\n            return;\r\n        }\r\n        type = data[this.selectedOptions[0].value.substring(this.selectedOptions[0].value.indexOf(\":\") + 1)].type;\r\n        opSection.classList.remove(hiddenCssClass);\r\n        TC.UI.autocomplete.call(valueField, \"destroy\");\r\n        //$(valueField).unbind(\"keydown\");\r\n        destroyNumberMask();\r\n        valueField.type = \"search\";\r\n        switch (true) {\r\n            case !type:\r\n                console.log(\"type es nulo\");\r\n                break;\r\n            case type instanceof Object:\r\n                _manageComplexTypes.apply(this, [type, form]);\r\n                break;\r\n            case TC.Util.isGeometry(type):\r\n                geomSection.classList.remove(hiddenCssClass);\r\n                whereSection.classList.remove(hiddenCssClass);\r\n                whereSection.classList.add(spatialCssClass);\r\n\r\n                if (geomSection.querySelectorAll(\"input:checked\").length === 0) {\r\n                    geomSection.firstElementChild.checked = true;\r\n                }\r\n                _destroyDateMask();\r\n                //const value = [].slice.call(form.querySelectorAll('select[name=' + this.name + ']')).reduce(function (vi, va) { return vi + (vi ? \"/\" : \"\") + va.value; }, \"\");\r\n                //_autocompleteConstructor(valueField, value, form.getElementsByClassName(ctlProto.CLASS + \"-list tc-ctl-search-list\")[0]);\r\n                break;\r\n            case type.indexOf(\"int\") >= 0:\r\n            case type.indexOf(\"float\") >= 0:\r\n            case type.indexOf(\"double\") >= 0:\r\n            case type.indexOf(\"long\") >= 0:\r\n            case type.indexOf(\"decimal\") >= 0:\r\n                numericSection.classList.remove(hiddenCssClass);\r\n                whereSection.classList.remove(hiddenCssClass, spatialCssClass);\r\n\r\n                if (numericSection.querySelectorAll(\"input:checked\").length === 0) {\r\n                    numericSection.firstElementChild.checked = true;\r\n                }\r\n                _destroyDateMask();\r\n\r\n                if (checkInput(\"number\")) {\r\n                    if (TC.Util.detectIE()) {\r\n                        valueField.type = \"text\";\r\n                        _loadNumberPolyFill().then(function () {\r\n                            inputMaskNumber = new IMask(valueField, {\r\n                                mask: Number,  // enable number mask\r\n                                scale: (type.indexOf(\"int\") >= 0 || type.indexOf(\"long\") >= 0) ? 0 : 2,  // digits after point, 0 for integers\r\n                                signed: false,  // disallow negative\r\n                                thousandsSeparator: (locale && locale === \"en-US\") ? ',' : '.',  // any single char\r\n                                padFractionalZeros: false,  // if true, then pads zeros at end to the length of scale\r\n                                normalizeZeros: true,  // appends or removes zeros at ends\r\n                                radix: (locale && locale === \"en-US\") ? '.' : ',',  // fractional delimiter\r\n                            })\r\n                        });\r\n                    }\r\n                    else {\r\n                        valueField.type = \"number\";\r\n                        if (type.indexOf(\"int\") >= 0 || type.indexOf(\"long\") >= 0)\r\n                            valueField.step = \"1\";\r\n                        else\r\n                            valueField.step = \"0.0001\";\r\n                    }\r\n                }\r\n                break\r\n                        case type.indexOf(\"dateTime\") >= 0:\r\n            case type.indexOf(\"date\") >= 0:            \r\n\r\n                dateSection.classList.remove(hiddenCssClass);\r\n                whereSection.classList.remove(hiddenCssClass, spatialCssClass);\r\n\r\n                if (dateSection.querySelectorAll(\"input:checked\").length === 0) {\r\n                    dateSection.firstElementChild.checked = true;\r\n                }\r\n                _createDateMask(valueField);\r\n                break;            \r\n            case type.indexOf(\"string\") >= 0:\r\n                textSection.classList.remove(hiddenCssClass);\r\n                whereSection.classList.remove(hiddenCssClass, spatialCssClass);\r\n\r\n                if (textSection.querySelectorAll(\"input:checked\").length === 0) {\r\n                    textSection.firstElementChild.checked = true;\r\n                }\r\n                _destroyDateMask();\r\n                const value = [].slice.call(form.querySelectorAll('select[name=' + this.name + ']')).reduce(function (vi, va) { return vi + (vi ? \"/\" : \"\") + va.value; }, \"\");\r\n                _autocompleteConstructor(valueField, value, form.getElementsByClassName(ctlProto.CLASS + \"-list tc-ctl-search-list\")[0]);\r\n                break;\r\n        }\r\n    };\r\n\r\n    const _renderFilterConditions = function (ctl) {\r\n        const form = ctl.getForm();\r\n        const whereDiv = form.querySelector(`.${ctl.CLASS}-where-list`);\r\n        empty(whereDiv);\r\n        ctlProto.getRenderedHtml(ctl.CLASS + \"-filter\", {\r\n            conditions: ctl.filters.map(f => getTemplateObjFromFilter(ctl, f))\r\n        }, function (html) {\r\n            whereDiv.innerHTML = html;\r\n            whereDiv.querySelectorAll(`.${ctl.CLASS}-where-cond-view`).forEach(function (btn, idx) {\r\n                btn.addEventListener(TC.Consts.event.CLICK, function () {\r\n                    ctl.map.zoomToFeatures([ctl.filters.filter(f => f instanceof TC.filter.Spatial)[idx].geometry]);\r\n                    ctl.showGeometryPanel();\r\n                }, { passive: true });\r\n            });\r\n            form.querySelectorAll(`.${ctl.CLASS}-del-cond`).forEach(function (btn, idx) {\r\n                btn.addEventListener(TC.Consts.event.CLICK, function () {\r\n                    ctl.removeFilter(idx);\r\n                }, { passive: true });\r\n            });\r\n        });\r\n    }\r\n\r\n    var _validate = function (form) {\r\n        var opcion = form.querySelector('.tc-ctl-wfsquery input[type=\"radio\"]:checked');\r\n\r\n        if (dateInputMask && !dateInputMask.masked.isComplete) {\r\n            if (/^(?=\\d)(?:(?:31(?!.(?:0?[2469]|11))|(?:30|29)(?!.0?2)|29(?=.0?2.(?:(?:(?:1[6-9]|[2-9]\\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00)))(?:\\x20|$))|(?:2[0-8]|1\\d|0?[1-9]))([-.\\/])(?:1[012]|0?[1-9])\\1(?:1[6-9]|[2-9]\\d)?\\d\\d(?:(?=\\x20\\d)\\x20|$))?(((0?[1-9]|1[012])(:[0-5]\\d){0,2}(\\x20[AP]M))|([01]\\d|2[0-3])(:[0-5]\\d){1,2})?$/.test(str) === false)\r\n                _showMessage(\"Fecha \" + str + \" inválida\", TC.Consts.msgType.ERROR);\r\n            return false;\r\n        }\r\n        if (opcion.length == 0) {\r\n            _showMessage(getLocaleString(\"query.msgNoCondition\"));\r\n            return false;\r\n        }\r\n        if (form.querySelectorAll('input[type=\\'date\\']').length && !form.querySelector('input[type=\\'date\\']').checkValidity()) {\r\n            _showMessage(getLocaleString(\"query.msgNoValidDate\"));\r\n            return false;\r\n        }\r\n        var number\r\n        if (form.querySelectorAll('input[type=\\'number\\']').length && ((number = form.querySelector('input[type=\\'number\\']')) != null) && !number.checkValidity()) {\r\n            if (number.step === \"1\")\r\n                _showMessage(getLocaleString(\"query.msgNoValidNumberMustInt\"));\r\n            else\r\n                _showMessage(getLocaleString(\"query.msgNoValidNumber\"));\r\n            return false;\r\n        }\r\n        if (form.querySelector('input.tc-textbox').value.trim() === \"\" && (opcion.value !== \"empty\" && opcion.value !== \"null\")) {\r\n            _showMessage(getLocaleString(\"query.msgNoValueCondition\"));\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    const _getLayerName = () => { return _currentLayerTitle };\r\n\r\n    var _createResultPanel = function (layerName) {\r\n        const self = this;\r\n        var _layerName = layerName;\r\n        var _downloadClickHandler = function (_self, layerName) {\r\n            const self = _self;\r\n            self.getDownloadDialog().then(function (control) {\r\n                var options = {\r\n                    title: layerName()\r\n                };\r\n                if (self.map.elevation || self.options.displayElevation) {\r\n                    options = Object.assign({}, options, {\r\n                        elevation: Object.assign({}, self.map.elevation && self.map.elevation.options, self.options.displayElevation)\r\n                    });\r\n                }\r\n\r\n                control.open(self.resultsLayer.features, options);\r\n            });\r\n        };\r\n        return new Promise(async function (resolve) {\r\n            if (!self.resultsPanel) {\r\n                var ccontainer = self.map.getControlsByClass(TC.control.ControlContainer);\r\n                const panelOptions = {\r\n                    content: \"table\",\r\n                    titles: {\r\n                        main: \"\",\r\n                        max: \"\"\r\n                    },\r\n                    save: {\r\n                        fileName: _layerName + \".xls\"\r\n                    },\r\n                    download: () => _downloadClickHandler(self, _getLayerName),\r\n                    share: true,\r\n                    resize: true\r\n                };\r\n                if (ccontainer.length == 0) {\r\n                    self.resultsPanel = await self.map.addControl('resultsPanel', panelOptions);\r\n                    self.resultsPanel.caller = self;\r\n                }\r\n                else {\r\n                    panelOptions.position = \"right\";\r\n                    self.resultsPanel = await ccontainer[0].addControl('resultsPanel', panelOptions);\r\n                    self.resultsPanel.caller = self;\r\n                }\r\n                self.resultsPanel.template[self.resultsPanel.CLASS + \"-table\"] = self.template[self.CLASS + \"-table\"];\r\n            }\r\n            else {\r\n                self.resultsPanel.options.save.fileName = _layerName + \".xls\";\r\n            }\r\n            self.resultsPanel.options.titles.max = self.resultsPanel.getLocaleString('geo.trk.chart.exp');\r\n            resolve();\r\n        });\r\n    };\r\n\r\n    var _showMessage = function (Message, type) {\r\n        var messageDiv = modalBody.getElementsByClassName(\"tc-ctl-wfsquery-message\")[0];\r\n        if (timer) {\r\n            clearTimeout(timer);\r\n        }\r\n        else {\r\n            messageDiv.innerHTML = Message;\r\n            switch (type) {\r\n                case TC.Consts.msgType.INFO:\r\n                    messageDiv.classList.add(\"tc-msg-info\")\r\n                    break;\r\n                case TC.Consts.msgType.WARNING:\r\n                    messageDiv.classList.add(\"tc-msg-warning\")\r\n                    break;\r\n                case TC.Consts.msgType.ERROR:\r\n                default:\r\n                    messageDiv.classList.add(\"tc-msg-error\")\r\n                    break;\r\n            }\r\n            messageDiv.classList.remove(hiddenCssClass);\r\n        }\r\n        timer = setTimeout(function () {\r\n            timer = null;\r\n            messageDiv.classList.add(hiddenCssClass);\r\n        }, 3000)\r\n    };\r\n    var _getPossibleValues = async function (field, value) {\r\n        var _capabilities = Object.assign({}, _currentLayercapabilities);\r\n        switch (document.querySelector(\".tc-ctl-wfsquery.tc-ctl-wfsquery-text input:checked\").value) {\r\n            case \"starts\":\r\n                value = (value + \"*\");\r\n                break;\r\n            case \"contains\":\r\n            case \"eq\":\r\n                value = (\"*\" + value + \"*\");\r\n                break;\r\n            case \"ends\":\r\n                value = (\"*\" + value);\r\n                break;\r\n        }\r\n\r\n        if (controller) {\r\n            controller.abort();\r\n        }\r\n        controller = new AbortController();\r\n        let signal = controller.signal;\r\n\r\n        try {\r\n            var data = await _currentLayer.toolProxification.fetch(_currentLayerURL, {\r\n                //URI:si el valor de field contiene \"/\" se supone que es un dato compuesto entonces no establezco propiedades a devolver sino que se deja vacío para que devuelva todos.\r\n                data: TC.Util.WFGetPropertyValue(_currentLayerName, field.indexOf(\"/\") >= 0 ? false : field, TC.filter.like(field, value, undefined, undefined, undefined, false), _capabilities),//TC.Util.WFSQueryBuilder([_currentLayerName], TC.filter.like(field, value, undefined, undefined, undefined, false), _capabilities, \"JSON\", false),\r\n                contentType: \"application/xml\",\r\n                method: \"POST\",\r\n                signal: signal\r\n            })\r\n\r\n            if (data.contentType.startsWith(\"application/xml\") || data.contentType.startsWith(\"text/xml\")) {\r\n                let xmlDoc = new DOMParser().parseFromString(data.responseText, \"text/xml\");\r\n                let error = xmlDoc.querySelector(\"Exception ExceptionText\");\r\n                if (error) {\r\n                    _showMessage(error.innerHTML, TC.Consts.msgType.ERROR);\r\n                    return [];\r\n                }\r\n                //parser de features XML\r\n                var arr = [];\r\n                xmlDoc.querySelectorAll(\"member > *\").forEach(function (item) { if (arr.indexOf(item.innerHTML) < 0) arr[arr.length] = item.innerHTML });\r\n                return arr;\r\n\r\n            }\r\n            if (data.contentType.startsWith(\"application/json\")) {\r\n                data = JSON.parse(data.responseText);\r\n            }\r\n            if (data.features && data.features.length > 0) {\r\n                var arr;\r\n                if (data.features.length === 1)\r\n                    arr = [field.split(\"/\").reduce(function (vi, va) { return vi[va.substring(va.indexOf(\":\") + 1)] }, data.features[0].properties)];\r\n                if (data.features.length > 1)\r\n                    arr = data.features.reduce(function (pv, cv) {\r\n                        if (pv && pv instanceof Array) {\r\n                            if (pv.indexOf(cv.properties[field]) < 0)\r\n                                return pv.concat(field.split(\"/\").reduce(function (vi, va) { return vi[va.substring(va.indexOf(\":\") + 1)] }, cv.properties));\r\n                            else\r\n                                return pv;\r\n                        }\r\n                    }, []);\r\n                //arr.sort();\r\n                return arr;\r\n            } else\r\n                return [];\r\n        }\r\n        catch (err) {\r\n            if (err instanceof DOMException && err.name !== \"AbortError\")\r\n                _showMessage(err, TC.Consts.msgType.ERROR);\r\n            return null\r\n        }\r\n    };\r\n    var _autocompleteConstructor = function (control, property, listCtrl) {\r\n\r\n        TC.UI.autocomplete.call(control, {\r\n            minLength: 3,\r\n            target: listCtrl,\r\n            source: function (text, callback) {\r\n                var _self = this;\r\n                _self.target.innerHTML = '<li><a class=\"tc-ctl-search-li-loading\" href=\"#\">' + getLocaleString(\"searching\") + '<span class=\"tc-ctl-search-loading-spinner tc-ctl-search-loading\"></span></a></li>'\r\n                _self.target.classList.remove(hiddenCssClass);\r\n                if (timerAutocomplete)\r\n                    window.clearTimeout(timerAutocomplete);\r\n                timerAutocomplete = window.setTimeout(async function () {\r\n                    if (!document.querySelector(\".tc-ctl-wfsquery.tc-ctl-wfsquery-text\").classList.contains(TC.Consts.classes.HIDDEN)) {\r\n                        var data = await _getPossibleValues(property, text)\r\n                        if (data) {\r\n                            if (data.length)\r\n                                callback(data.sort());\r\n                            else\r\n                                _self.target.classList.add(hiddenCssClass);\r\n                        }\r\n                    }\r\n                }, 500);\r\n            },\r\n            callback: function (e) {\r\n                control.value = e.currentTarget.dataset[\"value\"];\r\n                this.target.classList.add(hiddenCssClass);\r\n            },\r\n            buildHTML: function (data) {\r\n                var pattern = control.value;\r\n                this.target.style.maxHeight = \"\";\r\n                if (data.results.length > 1)\r\n                    return data.results.reduce(function (pv, cp, i) {\r\n                        return (i > 1 ? pv : _highlightText(pv, pattern)) + _highlightText(cp, pattern);\r\n                    });\r\n                else\r\n                    return _highlightText(data.results[0], pattern);\r\n            }\r\n        });\r\n        control.addEventListener(\"targetCleared.autocomplete\", function () {\r\n            listCtrl.classList.add(hiddenCssClass);\r\n        });\r\n        control.addEventListener('keypress', function (e) {\r\n            if (e.which == 13) {\r\n                TC.UI.autocomplete.call(control, \"clear\");\r\n            }\r\n        });\r\n        control.addEventListener(\"search\", function (e) {\r\n            if (control.value.length === 0) {\r\n                TC.UI.autocomplete.call(control, \"clear\")\r\n            }\r\n        });\r\n        control.addEventListener(\"input\", function (e) {\r\n            if (control.value.length === 0) {\r\n                TC.UI.autocomplete.call(control, \"clear\")\r\n            }\r\n        });\r\n    };\r\n    var _highlightText = function (text, pattern) {\r\n        pattern = new RegExp(pattern.replace(/\\W/g, ''), \"gi\");\r\n        return \"<li><a href=\\\"#\\\" data-value=\\\"\" + text + \"\\\">\" + text.replace(pattern, '<b>$&</b>') + \"</a></li>\";\r\n    };\r\n\r\n    var _select = function (feature) {\r\n        var _addFeature = function (layer, feature) {\r\n            var result\r\n            if (feature instanceof TC.feature.Point) {\r\n                result = layer.addPoint(feature.getCoords());\r\n            }\r\n            else if (feature instanceof TC.feature.Polyline) {\r\n                result = layer.addPolyline(feature.getCoords());\r\n            }\r\n            else if (feature instanceof TC.feature.Polygon) {\r\n                result = layer.addPolygon(feature.getCoords());\r\n            }\r\n            else if (feature instanceof TC.feature.MultiPolygon) {\r\n                result = layer.addMultiPolygon(feature.getCoords());\r\n            }\r\n            else if (feature instanceof TC.feature.MultiPolyline) {\r\n                result = layer.addMultiPolyline(feature.getCoords());\r\n            }\r\n            return result;\r\n        };\r\n        if (!feature.layer)\r\n            return;\r\n        var layer = feature.layer.map.getLayer(\"WFSQueryResultsHighlight\");\r\n        if (!layer) {\r\n            feature.layer.map.addLayer({\r\n                id: \"WFSQueryResultsHighlight\",\r\n                type: TC.Consts.layerType.VECTOR,\r\n                owner: self,\r\n                stealth: true,\r\n                styles: _getHighLightStyles()\r\n            }, function (layer) {\r\n                _addFeature(layer, feature);\r\n            });\r\n        }\r\n        else\r\n            _addFeature(layer, feature);\r\n    };\r\n    var _unselect = function (feature) {\r\n        var layer = feature.layer.map.getLayer(\"WFSQueryResultsHighlight\");\r\n        if (layer) {\r\n            layer.clearFeatures();\r\n        }\r\n    };\r\n    ctlProto.render = function (callback) {\r\n        const self = this;\r\n\r\n        return self._set1stRenderPromise(Promise.all([\r\n            TC.Control.prototype.render.call(self, callback),\r\n            self.getRenderedHtml(self.CLASS + '-share-dialog', {}, function (html) {\r\n                self._dialogDiv.innerHTML = html;\r\n            })\r\n        ]));\r\n    };\r\n\r\n    ctlProto.register = function (map) {\r\n        const self = this;\r\n        return new Promise(function (resolve, reject) {\r\n\r\n            map.on(TC.Consts.event.LAYERERROR, (e) => {\r\n                if (e.layer === self.resultsLayer) {\r\n                    if (self.modalDialog) {\r\n                        self.modalDialog.getElementsByClassName(\"tc-modal-body\")[0].classList.remove(loadingCssClass);\r\n                    }\r\n                    if (e.reason === TC.Consts.WFSErrors.MAX_NUM_FEATURES) {\r\n                        _showMessage(getLocaleString(\"query.msgTooManyResults\", { limit: e.data.limit }), TC.Consts.msgType.WARNING)\r\n                    }\r\n                    else {\r\n                        console.error(e.reason);\r\n                        _showMessage(getLocaleString(\"query.errorUndefined\"), TC.Consts.msgType.ERROR);\r\n                    }\r\n                }\r\n            })\r\n\r\n            TC.Control.prototype.register.call(self, map).then(function (ctrl) {\r\n                var self = ctrl;\r\n\r\n                if (TC._hbs && !TC._hbs.helpers.formatNumber) {\r\n                    TC._hbs.registerHelper(\"formatNumber\", function (value) {\r\n                        return value.toLocaleString(locale);\r\n                    });\r\n                }\r\n\r\n                _getStyles = function () {\r\n                    var styleFN = function (geomType, property) {\r\n                        return this.options.styles && this.options.styles[geomType] ? (this.options.styles[geomType][property] || TC.Cfg.styles[geomType][property]) : TC.Cfg.styles[geomType][property]\r\n                    }\r\n                    return {\r\n                        polygon: {\r\n                            fillColor: styleFN.bind(self, 'polygon', 'fillColor'),\r\n                            fillOpacity: styleFN.bind(self, 'polygon', 'fillOpacity'),\r\n                            strokeColor: styleFN.bind(self, 'polygon', 'strokeColor'),\r\n                            strokeOpacity: styleFN.bind(self, 'polygon', 'strokeOpacity'),\r\n                            strokeWidth: styleFN.bind(self, 'polygon', 'strokeWidth')\r\n                        },\r\n                        line: {\r\n                            strokeColor: styleFN.bind(self, 'line', 'strokeColor'),\r\n                            strokeOpacity: styleFN.bind(self, 'line', 'strokeOpacity'),\r\n                            strokeWidth: styleFN.bind(self, 'line', 'strokeWidth')\r\n                        },\r\n                        point: {\r\n                            radius: styleFN.bind(self, 'point', 'radius'),\r\n                            height: styleFN.bind(self, 'point', 'height'),\r\n                            width: styleFN.bind(self, 'point', 'width'),\r\n                            fillColor: styleFN.bind(self, 'point', 'fillColor'),\r\n                            fillOpacity: styleFN.bind(self, 'point', 'fillOpacity'),\r\n                            strokeColor: styleFN.bind(self, 'point', 'strokeColor'),\r\n                            strokeWidth: styleFN.bind(self, 'point', 'strokeWidth'),\r\n                            fontSize: styleFN.bind(self, 'point', 'fontSize'),\r\n                            fontColor: styleFN.bind(self, 'point', 'fontColor'),\r\n                            labelOutlineColor: styleFN.bind(self, 'point', 'labelOutlineColor'),\r\n                            labelOutlineWidth: styleFN.bind(self, 'point', 'labelOutlineWidth'),\r\n                            label: styleFN.bind(self, 'point', 'label'),\r\n                            angle: styleFN.bind(self, 'point', 'angle')\r\n                        }\r\n                    }\r\n                };\r\n                _getHighLightStyles = function () {\r\n                    var _default = {\r\n                        \"polygon\": TC.Util.extend(true, {}, TC.Cfg.styles.polygon, {\r\n                            fillColor: \"#0099FF\",\r\n                            fillOpacity: 1,\r\n                            strokeColor: \"#0099FF\",\r\n                            strokeWidth: 2\r\n                        }),\r\n                        \"line\": TC.Util.extend(true, {}, TC.Cfg.styles.line, {\r\n                            strokeColor: \"#0099FF\",\r\n                            strokeWidth: 2\r\n                        }),\r\n                        \"point\": TC.Util.extend(true, {}, TC.Cfg.styles.point, {\r\n                            strokeColor: \"#0099FF\"\r\n                        })\r\n                    };\r\n                    return self.highlightStyles ? {\r\n                        \"polygon\": TC.Util.extend(true, {}, _default.polygon, self.highlightStyles.polygon ? self.highlightStyles.polygon : {}),\r\n                        \"line\": TC.Util.extend(true, {}, _default.line, self.highlightStyles.line ? self.highlightStyles.line : {}),\r\n                        \"point\": TC.Util.extend(true, {}, _default.point, self.highlightStyles.point ? self.highlightStyles.point : {})\r\n                    } : _default;\r\n                };\r\n\r\n                locale = map.options.locale;\r\n\r\n                getLocaleString = function (key, texts) {\r\n                    return TC.Util.getLocaleString(locale, key, texts);\r\n                }\r\n\r\n                map.ready(function () {\r\n                    map.getControlsByClass('TC.control.WorkLayerManager').forEach(function (ctl) {\r\n                        ctl.addLayerTool({\r\n                            renderFn: function (container, layerId) {\r\n                                const className = self.CLASS + '-btn-open';\r\n                                let button = container.querySelector('button.' + className);\r\n                                if (!button) {\r\n                                    const layer = map.getLayer(layerId);\r\n                                    if (layer.type === TC.Consts.layerType.WMS || layer.type === TC.Consts.layerType.WFS) {\r\n                                        const text = self.getLocaleString('query.tooltipMagnifBtn');\r\n                                        button = document.createElement('button');\r\n                                        button.innerHTML = text;\r\n                                        button.setAttribute('title', text);\r\n                                        button.classList.add(className);\r\n                                        button.dataset.layerId = layerId;\r\n                                        container.appendChild(button);\r\n                                        if (layer.type === TC.Consts.layerType.WMS) {\r\n                                            button.classList.add(loadingCssClass);\r\n                                            layer.getWFSCapabilities().then((WFSCapabilities) => {\r\n                                                //check si tiene GetFeature Disponible\r\n                                                if (!WFSCapabilities.Operations.GetFeature) {\r\n                                                    button.classList.add(hiddenCssClass);\r\n                                                    return;\r\n                                                }\r\n                                                //check si las capas hijas están en capabilties WFS\r\n                                                var layers = layer.getDisgregatedLayerNames ? layer.getDisgregatedLayerNames() : layer.featureType;\r\n                                                layers = layers.filter(function (l) {\r\n                                                    return WFSCapabilities.FeatureTypes.hasOwnProperty(l.substring(l.indexOf(\":\") + 1));\r\n                                                });\r\n                                                if (!layers.length) {\r\n                                                    button.classList.add(hiddenCssClass);\r\n                                                    return;\r\n                                                }\r\n                                            }).catch(() => button.classList.add(hiddenCssClass))\r\n                                                .finally(() => button.classList.remove(loadingCssClass));\r\n                                        }\r\n                                    }\r\n                                }\r\n                                return button;\r\n                            },\r\n                            updateEvents: [],\r\n                            actionFn: function () {\r\n                                const button = this;\r\n                                if (button.classList.contains('tc-unavailable') || button.classList.contains('tc-loading')) {\r\n                                    return;\r\n                                }\r\n                                const layer = self.map.getLayer(button.dataset.layerId);\r\n                                self.renderModalDialog(layer);\r\n                            }\r\n                        });\r\n                    });\r\n                });\r\n\r\n                self.getShareDialog().then(function () {\r\n                    resolve(self);\r\n                }).catch(function (err) {\r\n                    reject(err instanceof Error ? err : Error(err));\r\n                });\r\n            });\r\n        });\r\n    };\r\n\r\n    const _onFeaturesUpdate = function (e) {\r\n        const ctl = e.layer.owner;\r\n        if (ctl && e.layer == ctl.resultsLayer) {            \r\n            if (e.newData && e.newData.totalFeatures === 0) {\r\n                ctl.modalDialog.getElementsByClassName(\"tc-modal-body\")[0].classList.remove(loadingCssClass);\r\n                _showMessage(getLocaleString(\"query.msgNoResults\"), TC.Consts.msgType.INFO);\r\n                return;\r\n            }\r\n            var features = e.layer.features;\r\n            if (features.length > 0) {\r\n                if (ctl.toShare && ctl.toShare.doZoom) {                    \r\n                    ctl._setQueryToSearch({ doZoom: false });\r\n                    ctl.map.zoomToFeatures(features);\r\n                }\r\n                const serviceAttrName = 'h3_' + ctl.getLocaleString('service');\r\n                const layerAttrName = 'h4_' + ctl.getLocaleString('layer');\r\n                const title_separator = ctl.map.getControlsByClass(TC.control.Click).some((c) => { return c.TITLE_SEPARATOR }) ? ctl.map.getControlsByClass(TC.control.Click).find((c) => { return c.TITLE_SEPARATOR }).TITLE_SEPARATOR : ' • ';\r\n                \r\n\t\t\t\tfor(var i=0;i<features.length;i++){\r\n\t\t\t\t\tconst path = _currentLayer.getPath(_currentLayerName).slice(1)\r\n\t\t\t\t\tif (path) {\r\n\t\t\t\t\t\tconst newData = {};\r\n\t\t\t\t\t\tnewData[serviceAttrName] = _currentLayer.title;\r\n                        newData[layerAttrName] = path.join(title_separator);\t\t\t\t\t\t\r\n\t\t\t\t\t\tconst allData = TC.Util.extend(newData, features[i].getData());\r\n\t\t\t\t\t\tfeatures[i].clearData();\r\n\t\t\t\t\t\tfeatures[i].setData(allData);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n                ctl.showResultsPanel(\r\n                    (features.length > 1 ?\r\n                        features.reduce(function (vi, va, index) {\r\n                            return (vi instanceof Array ? vi : [vi.data]).concat([va.data])\r\n                        })\r\n                        :\r\n                        [features[0].data])\r\n                    , _currentLayerTitle);\r\n            }\r\n\r\n            e.layer.map.off(TC.Consts.event.LAYERUPDATE, _onFeaturesUpdate);\r\n        }\r\n    };\r\n\r\n    const _onBeforeApplyQuery = function (e) {\r\n        const ctl = e.layer.owner;\r\n        if (ctl && e.layer == ctl.resultsLayer && e.query) {\r\n            ctl._setQueryToSearch({ filter: e.query });\r\n        }\r\n    };\r\n\r\n    ctlProto._sendQuery = async function (filter) {\r\n        const self = this;\r\n\r\n        if (_currentLayer && _currentLayerName && _currentLayerTitle && filter) {\r\n            var _url = await _currentLayer.getWFSURL();\r\n            await _createResultPanel.apply(self, [_currentLayerTitle]);\r\n            _currentLayer.toolProxification.cacheHost.getAction(_url).then(function (cacheHost) {\r\n                const url = cacheHost.action(_url);\r\n                if (self.resultsLayer && self.resultsLayer.url !== url) {\r\n                    self.map.removeLayer(self.resultsLayer);\r\n                    self.resultsLayer = null;\r\n                }\r\n                if (!self.resultsLayer) {\r\n                    self.map.on(TC.Consts.event.BEFOREAPPLYQUERY, _onBeforeApplyQuery);\r\n                    self.map\r\n                        .addLayer({\r\n                            id: \"WFSQueryResults\",\r\n                            type: TC.Consts.layerType.WFS,\r\n                            url: url,\r\n                            owner: self,\r\n                            stealth: true,\r\n                            geometryName: \"the_geom\",\r\n                            featurePrefix: _currentLayerName.substring(0, _currentLayerName.indexOf(\":\")),\r\n                            featureType: _currentLayerName.substring(_currentLayerName.indexOf(\":\") + 1),\r\n                            properties: filter,\r\n                            outputFormat: TC.Consts.format.JSON,\r\n                            styles: _getStyles()\r\n                        })\r\n                        .then(function (layer) {\r\n                            self.resultsLayer = layer;                            \r\n                            layer.map.on(TC.Consts.event.LAYERUPDATE, _onFeaturesUpdate);\r\n                        });\r\n\r\n                    self.map.on(TC.Consts.event.RESULTSPANELCLOSE, function (e) {\r\n                        if (e.control !== self.resultsPanel)\r\n                            return;\r\n                        if (TC.browserFeatures.touch()) {\r\n                            TC.Util.swipe(e.control.div, \"enable\");\r\n                        }\r\n                        self.resultsLayer.clearFeatures();\r\n                        self.resultsLayer.setVisibility(false);\r\n                        self.clearFilters();\r\n                        self.map.off(TC.Consts.event.LAYERUPDATE, _onFeaturesUpdate);\r\n                        self.map.off(TC.Consts.event.BEFOREAPPLYQUERY, _onBeforeApplyQuery);\r\n                        delete self.toShare;\r\n                    });\r\n                }\r\n                else {\r\n                    self.map.off(TC.Consts.event.BEFOREAPPLYQUERY, _onBeforeApplyQuery);\r\n                    self.map.on(TC.Consts.event.BEFOREAPPLYQUERY, _onBeforeApplyQuery);\r\n                    self.resultsLayer.setVisibility(false);\r\n                    self.resultsLayer.clearFeatures();\r\n                    //borro el evento featureUpdate por si hago una búsqueda sin cerra el panel previamente\r\n                    self.map.off(TC.Consts.event.LAYERUPDATE, _onFeaturesUpdate);\r\n                    self.map.on(TC.Consts.event.LAYERUPDATE, _onFeaturesUpdate);\r\n                    self.resultsLayer.url = url;\r\n                    self.resultsLayer.featurePrefix = _currentLayerName.substring(0, _currentLayerName.indexOf(\":\"));\r\n                    self.resultsLayer.featureType = _currentLayerName.substring(_currentLayerName.indexOf(\":\") + 1);\r\n                    self.resultsLayer.properties = filter;\r\n                    self.resultsLayer.setVisibility(true);\r\n                    self.resultsLayer.refresh();\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    ctlProto.sendQuery = async function () {\r\n        const self = this;\r\n        if (!self.validateQuery()) {\r\n            _showMessage(getLocaleString(\"query.msgNoQueryFilter\"));\r\n            return;\r\n        }\r\n        self.modalDialog.getElementsByClassName(\"tc-modal-body\")[0].classList.add(loadingCssClass);\r\n\r\n        let filter;\r\n        if (self.filters.length > 1) {\r\n            const condition = self.modalDialog.querySelector(\".tc-ctl-wfsquery-logOpRadio:checked\").value;\r\n            filter = TC.filter[TC.Consts.logicalOperator[condition]].apply(null, self.filters);\r\n        }\r\n        else {\r\n            filter = self.filters[0];\r\n        }\r\n\r\n        self._sendQuery.call(self, filter);\r\n    };\r\n\r\n    ctlProto._setQueryToSearch = function (options) {\r\n        const self = this;\r\n        if (Object.keys(options).length === 1 && options.hasOwnProperty(\"doZoom\")) {\r\n            self.toShare = TC.Util.extend(self.toShare, { doZoom: options.doZoom });\r\n        } else if (options.filter || self.resultsLayer && self.resultsLayer.properties instanceof TC.filter.Filter) {\r\n            self.toShare = TC.Util.extend(self.toShare, {\r\n                wms: {\r\n                    url: _currentLayer.url, names: _currentLayer.names\r\n                },\r\n                title: _currentLayerTitle,\r\n                name: _currentLayerName,\r\n                filter: options.filter ? options.filter : self.resultsLayer.properties.getText(),\r\n                doZoom: options.hasOwnProperty('doZoom') ? options.doZoom : true\r\n            });\r\n        }   \r\n    };\r\n\r\n    ctlProto._getQueryToSearch = function () {\r\n        const self = this;\r\n        return self.toShare;\r\n    };\r\n\r\n    ctlProto.exportState = function () {\r\n        const self = this;\r\n        if (self.toShare) {\r\n            return {\r\n                id: self.id,\r\n                queryResult: JSON.stringify(self.toShare)\r\n            };\r\n        }\r\n        //else if (self.exportsState && self.resultsLayer) {\r\n        //    return {\r\n        //        id: self.id,\r\n        //        layer: self.resultsLayer.exportState({\r\n        //            exportStyles: false\r\n        //        })\r\n        //    };\r\n        //}\r\n        return null;\r\n    };\r\n\r\n    ctlProto.importState = function (state) {\r\n        const self = this;        \r\n\r\n        if (state.queryResult) {\r\n            let wait = self.map.getLoadingIndicator().addWait();\r\n            self.map.loaded(function () {\r\n                let sharedQueryToSearch = JSON.parse(state.queryResult);\r\n                if (sharedQueryToSearch.wms && sharedQueryToSearch.filter) {\r\n                    let wmsLayer = self.map.workLayers.filter(l => l.url && l.url === sharedQueryToSearch.wms.url &&\r\n                        l.names.join() === sharedQueryToSearch.wms.names.join());\r\n                    if (wmsLayer.length > 0) {\r\n                        _currentLayer = wmsLayer[0];\r\n                        _currentLayerName = sharedQueryToSearch.name;\r\n                        _currentLayerTitle = sharedQueryToSearch.title;\r\n\r\n                        self._setQueryToSearch({ doZoom: sharedQueryToSearch.doZoom });\r\n\r\n                        _currentLayer.describeFeatureType(_currentLayerName).then(function (data) {\r\n                            _manageDescribeFeature(data, self, false);\r\n                            self._sendQuery(sharedQueryToSearch.filter);\r\n                            // registramos el estado compartido por si se comparte de nuevo sin hacer uso del control\r\n                            self._setQueryToSearch({ filter: sharedQueryToSearch.filter, doZoom: sharedQueryToSearch.doZoom });\r\n\r\n                            self.map.getLoadingIndicator().removeWait(wait);\r\n                        });\r\n                    }\r\n                } else {\r\n                    alert('shared query error');\r\n                }\r\n            });\r\n        }\r\n        //else if (self.resultsLayer) {\r\n        //    self.resultsLayer.then(function () {\r\n        //        self.resultsLayer.importState(state.layer).then(function () {\r\n        //            self.resultsLayer.features.forEach(function (f) {\r\n        //                f.setStyle(null); // Los estilos vienen dados exclusivamente por la capa, borramos estilos propios de la feature\r\n        //            });\r\n        //        });\r\n        //    });\r\n        //}\r\n    };\r\n\r\n    ctlProto.validateQuery = function () {\r\n        return this.filters.length > 0\r\n    };\r\n\r\n    ctlProto.showResultsPanel = function (data, layername) {\r\n        const self = this;        \r\n\r\n        //en funcion del número de elementos cargo un título en singular o plural\r\n\r\n        self.resultsPanel.div.querySelector(\".prpanel-title-text\").innerText = self.resultsPanel.getLocaleString(data.length > 1 ? 'query.titleResultPaneMany' : 'query.titleResultPanelOne', { \"numero\": data.length, \"layerName\": layername });\r\n\r\n        self.resultsPanel.div.classList.add(\"tc-ctl-wfsquery-results\");\r\n\r\n        if (self.modalDialog) {\r\n            self.modalDialog.parentElement.removeChild(self.modalDialog);\r\n        }\r\n\r\n        const dataTypes = _getDataTypes();\r\n        \r\n        self.resultsPanel.openTable({\r\n            data: data,\r\n            css: {\r\n                trClass: \"trClass\",\r\n                tdClass: \"tdClass\",\r\n                thClass: \"thClass\",\r\n            },\r\n            sort:true,\r\n            callback: function (tabla) {\r\n\r\n                self.resultsPanel.maximize();\r\n                console.log(\"render del panel de resultados\");\r\n                var col = tabla.querySelectorAll(\".table>tbody>tr\");                \r\n                var j = 1;\r\n                for (var i in data[0]) {\r\n                    if (dataTypes.hasOwnProperty(i)) {\r\n                        if (dataTypes[i].type && !(dataTypes[i].type instanceof Object))\r\n                            if ((dataTypes[i].type.indexOf(\"int\") >= 0 ||\r\n                                dataTypes[i].type.indexOf(\"float\") >= 0 ||\r\n                                dataTypes[i].type.indexOf(\"double\") >= 0 ||\r\n                                dataTypes[i].type.indexOf(\"long\") >= 0 ||\r\n                                dataTypes[i].type.indexOf(\"decimal\") >= 0)) {\r\n                                var tdNumeric = tabla.querySelectorAll(\"td:nth-child(\" + j + \")\");\r\n                                for (var k = 0; k < tdNumeric.length; k++) {\r\n                                    tdNumeric[k].classList.add(\"tc-numeric\");\r\n                                }\r\n                            }                            \r\n                        if (dataTypes[i].type && (dataTypes[i].type instanceof Object)) {\r\n                            console.log(\"aki lo que sea\");\r\n                        }\r\n                        j++;\r\n                    }                    \r\n                }\r\n\r\n                for (var i = 0; i < col.length; i++) {\r\n                    col[i].addEventListener(\"click\", function (e) {\r\n                        e.stopPropagation();\r\n                        var index = this.dataset.index;\r\n                        if (index != undefined)\r\n                            self.resultsLayer.map.zoomToFeatures([self.resultsLayer.features[index]]);\r\n                    });\r\n                    col[i].addEventListener(\"mouseenter\", function () {\r\n                        var index = this.dataset.index;\r\n                        if (index == undefined) return;\r\n                        var feat = self.resultsLayer.features[index]\r\n                        if (feat && feat.geometry) {\r\n                            //feat.select();\r\n                            _select(feat);\r\n                        }\r\n                        var celdasHoja = this.querySelectorAll(\"td.value div\");\r\n                        if (celdasHoja.length > 0) {\r\n                            celdasHoja.forEach(function (celda) {\r\n                                if (celda.offsetWidth < celda.scrollWidth)\r\n                                    celda.title = celda.innerText;\r\n                            })\r\n                        }\r\n                        else\r\n                            this.querySelectorAll(\"td\").forEach(function (td) {\r\n                                if (td.offsetWidth < td.scrollWidth)\r\n                                    td.title = td.innerText;\r\n                            });\r\n\r\n                    });\r\n                    col[i].addEventListener(\"mouseleave\", function () {\r\n                        var index = this.dataset.index;\r\n                        if (index == undefined) return;\r\n                        var feat = self.resultsLayer.features[index]\r\n                        if (feat && feat.geometry) {\r\n                            //feat.unselect();\r\n                            _unselect(feat)\r\n                            //esto es porque el unselect no devulve al estilo por defecto\r\n                            //feat.setStyle(TC.Cfg.styles[feat.STYLETYPE]);\r\n                        }\r\n                    });\r\n                }\r\n                tabla.querySelectorAll(\".complexAttr label,.complexAttr input\").forEach(function (label) {\r\n                    label.addEventListener(\"click\", function (e) {\r\n                        e.stopPropagation();\r\n                    })\r\n                });\r\n                tabla.querySelectorAll(\".complexAttr input\").forEach(function (chkBox) {\r\n                    chkBox.addEventListener(\"change\", function (e) {\r\n                        if (this.checked) {\r\n                            this.nextElementSibling.querySelectorAll(\"td.value div\").forEach(function (div) {\r\n                                if (div.offsetWidth < div.scrollWidth)\r\n                                    div.title = div.innerText;\r\n                            });\r\n                        }\r\n                    })\r\n                });\r\n\r\n                TC.control.FeatureInfoCommons.addSpecialAttributeEventListeners(tabla);\r\n                tabla.querySelectorAll(\"td > img, td > video, td > audio, td > iframe\").forEach((e) => { e.parentNode.classList.add(\"tc-multimedia\") })\r\n                tabla.querySelectorAll(\"video\").forEach((v) => { v.addEventListener(TC.Consts.event.CLICK, function(e) {\n                        e.stopPropagation(); // No queremos zoom si pulsamos en un enlace\n                    }, { passive: true });})\r\n\r\n                ////se deshabilita el swipe para que se pueda hacer scroll horizontal del panel de resultados\r\n                if (TC.browserFeatures.touch()) {\r\n                    TC.Util.swipe(self.resultsPanel.div, 'disable');\r\n                }\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n    ctlProto.showGeometryPanel = async function (mode) {\r\n        const self = this;\r\n        TC.Util.closeModal();\r\n        if (!self.geometryPanel) {\r\n            const ctlOptions = {\r\n                titles: {\r\n                    main: self.getLocaleString('query.spatialFilter')\r\n                }\r\n            };\r\n            const ctlContainer = self.map.getControlsByClass(TC.control.ControlContainer)[0];\r\n            if (ctlContainer) {\r\n                ctlOptions.position = ctlContainer.POSITION.RIGHT;\r\n                self.geometryPanel = await ctlContainer.addControl('resultsPanel', ctlOptions);\r\n            }\r\n            else {\r\n                self.geometryPanel = await self.map.addControl('resultsPanel', ctlOptions);\r\n            }\r\n            self.map\r\n                .on(TC.Consts.event.RESULTSPANELCLOSE, function onResultsPanelClose(e) {\r\n                    if (e.control === self.geometryPanel) {\r\n                        setTimeout(() => self.drawControl.cancel(), 500); // timeout para evitar una llamada indeseada a GFI.\r\n                        TC.Util.showModal(self.modalDialog, {\r\n                            closeCallback: () => self.clearFilters()\r\n                        });\r\n                    }\r\n                });\r\n            const html = await self.getRenderedHtml(self.CLASS + '-geom');\r\n            self.geometryPanel.open(html);\r\n            self.geometryPanel.div.querySelector(`.${self.CLASS}-geom-btn-ok`).addEventListener(TC.Consts.event.CLICK, function () {\r\n                self.geometryPanel.close();\r\n            }, { passive: true });\r\n            if (!self.drawControl) {\r\n                self.drawControl = await self.map.addControl('draw', {\r\n                    div: self.geometryPanel.getTableContainer().querySelector(`.${self.CLASS}-geom-draw`),\r\n                    styles: self.styles\r\n                });\r\n                self.drawControl.on(TC.Consts.event.DRAWEND, function (e) {\r\n                    e.feature.showsPopup = false;\r\n                    self.geometryPanel.close();\r\n\r\n                    const op = self.modalDialog.querySelector(`input[name=\"${self.id}-condition\"]:checked`).value;\r\n                    let filter;\r\n                    switch (op) {\r\n                        case 'intersects':\r\n                            filter = new TC.filter.Intersects(null, e.feature, self.map.crs);\r\n                            break;\r\n                        default:\r\n                            filter = new TC.filter.Within(null, e.feature, self.map.crs);\r\n                    }\r\n                    filter._abbr = op;\r\n                    switch (e.target.mode) {\r\n                        case 'polygon':\r\n                            filter._valueToShow = self.getLocaleString('polygon');\r\n                            break;\r\n                        case 'line':\r\n                            filter._valueToShow = self.getLocaleString('line');\r\n                            break;\r\n                        case 'rectangle':\r\n                            filter._valueToShow = self.getLocaleString('box');\r\n                            break;\r\n                    }\r\n                    self.filters.push(filter);\r\n                    _renderFilterConditions(self);\r\n                    TC.Util.showModal(self.modalDialog, {\r\n                        closeCallback: () => self.clearFilters()\r\n                    });\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            self.geometryPanel.open();\r\n        }\r\n        self.geometryPanel.div.querySelector(`.${self.CLASS}-geom-draw`).classList.toggle(TC.Consts.classes.HIDDEN, !mode);\r\n        self.geometryPanel.div.querySelector(`.${self.CLASS}-geom-btn`).classList.toggle(TC.Consts.classes.HIDDEN, !!mode);\r\n        if (mode) {\r\n            self.drawControl.setMode(mode, true);\r\n        }\r\n    };\r\n\r\n    const _manageDescribeFeature = function (data, ctl, renderForm) {\r\n        let entries = Object.entries(data);\r\n        entries = entries.length > 1 ? data : entries[0][1];\r\n\r\n        _internalGetDataTypes = function () {\r\n            return data;\r\n        };\r\n        for (var key in data) {\r\n            const value = data[key];\r\n            if (TC.Util.isGeometry(value.type)) {\r\n                value.isGeometry = true;\r\n            }\r\n        }\r\n\r\n        if (renderForm) {\r\n            ctl.clearFilters();\r\n            ctlProto.getRenderedHtml(ctlProto.CLASS + \"-form\",\r\n                {\r\n                    operators: filterByOperation,\r\n                    attributes: data,\r\n                    controlId: ctl.id\r\n                }, function (html) {\r\n                    const dialog = ctl.modalDialog;\r\n                    const form = ctl.getForm();\r\n                    empty(form);\r\n                    form.insertAdjacentHTML('beforeend', html);\r\n                    modalBody.classList.remove(loadingCssClass);\r\n                    TC.loadJS(\r\n                        true,\r\n                        [TC.apiLocation + 'TC/ui/autocomplete.js'],\r\n                        function () {\r\n                            console.log(\"autocomplete loaded\");\r\n                        });\r\n                    var combo = form.getElementsByClassName(\"tc-combo\");\r\n                    if (combo.length == 0)\r\n                        dialog.getElementsByClassName(\"tc-button tc-ctl-wlm-btn-launch\")[0].setAttribute(\"disabled\", \"\");\r\n                    else {\r\n                        dialog.getElementsByClassName(\"tc-button tc-ctl-wlm-btn-launch\")[0].removeAttribute(\"disabled\");\r\n                        combo[0].addEventListener(\"change\", function () {\r\n                            _changeAttributeEvent.apply(this, [form, data]);\r\n                        });\r\n                        form.querySelectorAll(`input[name=\"${ctl.id}-condition\"]`).forEach(ipt => {\r\n                            ipt.addEventListener('change', async function (e) {\r\n                                form.querySelector(`.${ctlProto.CLASS}-geomtype-line-btn`).disabled = e.target.value === 'within';\r\n                                const valueField = modalBody.querySelector(\".tc-ctl-wfsquery-value input\");\r\n                                valueField.disabled = false;\r\n                                if (this.parentElement.classList.contains(\"tc-ctl-wfsquery-text\") && this.value === \"empty\") {\r\n                                    valueField.value = \"\";\r\n                                    valueField.disabled = true;\r\n                                    TC.UI.autocomplete.call(valueField, \"clear\");\r\n                                }\r\n                                if (this.parentElement.classList.contains(\"tc-ctl-wfsquery-date\") && this.value === \"null\") {\r\n                                    valueField.value = \"\";\r\n                                    valueField.disabled = true;\r\n                                }\r\n                                if (valueField.value.trim() != \"\") {\r\n                                    if (this.parentElement.classList.contains(\"tc-ctl-wfsquery-text\") && this.value !== \"empty\") {\r\n                                        var e = document.createEvent('HTMLEvents');\n                                        e.initEvent(\"keyup\", false, true);\n                                        valueField.dispatchEvent(e);\r\n                                    }\r\n                                }\r\n                            });\r\n                        });\r\n                        form.querySelectorAll(`.tc-ctl-wfsquery-where input[type=\"radio\"][name=\"${ctl.id}-log-op\"]`).forEach(radio => radio.addEventListener(\"change\", function () {\r\n                            logicalOperator = this.value === \"OR\" ? TC.Consts.logicalOperator.OR : TC.Consts.logicalOperator.AND                            \r\n                        }));\r\n\r\n                        form.querySelector(\".tc-button\").addEventListener(TC.Consts.event.CLICK, function () {\r\n                            var valueField = form.querySelector('input.tc-textbox');\r\n                            TC.UI.autocomplete.call(valueField, \"clear\");\r\n                            if (inputMaskNumber)\r\n                                inputMaskNumber.masked.remove();\r\n                            if (!_validate(form)) {\r\n                                return;\r\n                            }\r\n                            var field = [].reduce.call(form.querySelectorAll('.tc-combo'), function (vi, va) {\r\n                                return vi + (vi ? \"/\" : \"\") + va.value;\r\n                            }, '');\r\n                            const checkedOp = form.querySelector('.tc-ctl-wfsquery input[type=\"radio\"]:checked');\r\n                            var op = checkedOp.value;\r\n\r\n                            var value = _getValue(valueField);\r\n                            let valueToShow = _getValueToShow(valueField);\r\n                            switch (true) {\r\n                                case type.indexOf(\"int\") >= 0:\r\n                                    valueToShow = parseInt(value, 10)\r\n                                    break;\r\n                                case type.indexOf(\"float\") >= 0:\r\n                                case type.indexOf(\"double\") >= 0:\r\n                                case type.indexOf(\"long\") >= 0:\r\n                                case type.indexOf(\"decimal\") >= 0:\r\n                                    valueToShow = parseFloat(value, 10)\r\n                                    break;\r\n                                case type.indexOf(\"string\") >= 0 && op !== \"empty\":\r\n                                    valueToShow = '\"' + valueToShow + '\"';\r\n                                    break;\r\n                                case type.indexOf(\"date\") >= 0 && op === \"null\":\r\n                                    valueToShow = '';\r\n                                    break;\r\n                            }\r\n\r\n                            //se añade asterisco al principio y/o final del valor para las busquedas: \"empieza por\", \"termina en\" o \"contiene\"\r\n                            var f;\r\n                            if (type.indexOf(\"dateTime\") >= 0 || type.indexOf(\"date\") >= 0) {\r\n                                if (value) {\r\n                                    const from = new Date(value + \"T00:00:00\").toISOString();\r\n                                    const to = new Date(value + \"T23:59:59\").toISOString();\r\n                                    if (op === \"nbtw\") {\r\n                                        //el not bettween es un caso es especial por que concatena un filtro not y otro between\r\n                                        f = new TC.filter.not(TC.filter.between(field, from, to));\r\n                                    }\r\n                                    else {\r\n                                        f = new filterByOperation[op].Ctor(field, from, to);\r\n                                    }\r\n                                }\r\n                                else {\r\n                                    f = new filterByOperation[op].Ctor(field);\r\n                                }\r\n                                \r\n                            }\r\n                            else {\r\n                                f = new filterByOperation[op].Ctor(\r\n                                    field,\r\n                                    (((op === \"ends\" || op === \"contains\") ? '*' : '') + value + ((op === \"starts\" || op === \"contains\") ? '*' : '')));\r\n                            }\r\n                            f.matchCase = false;\r\n                            f._abbr = op;\r\n                            f._valueToShow = valueToShow;\r\n                            ctl.filters.push(f);\r\n\r\n                            _renderFilterConditions(ctl);\r\n                            valueField.value = \"\";\r\n                        }, { passive: true });\r\n\r\n                        const onGeomClick = function (e) {\r\n                            ctl.showGeometryPanel(e.target.value);\r\n                        };\r\n                        form.querySelectorAll(\"button[name='geometry']\").forEach(btn => btn.addEventListener(TC.Consts.event.CLICK, onGeomClick, { passive: true }));\r\n                    }\r\n                });\r\n        }\r\n    };\r\n\r\n    const _renderQueryForm = function (args) {\r\n        const self = args[0], layer = args[1], dialog = args[2], capabilities = args[3];\r\n        self.modalDialog = dialog;\r\n        _currentLayer = layer;\r\n        _currentLayercapabilities = capabilities;\r\n        _currentLayerURL = capabilities.Operations.DescribeFeatureType.DCP.HTTP.Get[\"href\"];\r\n        if (new URL(_currentLayerURL).host === document.location.host)\r\n            _currentLayerURL = _currentLayerURL.substring(_currentLayerURL.indexOf(\":\") + 1);\r\n        if (capabilities.Operations.GetFeature.CountDefault)\r\n            _maxRecordCount = capabilities.Operations.GetFeature.CountDefault.DefaultValue;\r\n        else\r\n            _maxRecordCount = null;\r\n        //analizamos si es una o varias capas, si es una agrupación la disgregamos \r\n        var layers = layer.getDisgregatedLayerNames ? layer.getDisgregatedLayerNames() : layer.featureType;\r\n        //quitamos aquellas que no estén disponibles en el WFS\r\n        layers = layers.filter(function (l) {\r\n            return capabilities.FeatureTypes.hasOwnProperty(l.substring(l.indexOf(\":\") + 1));\r\n        });\r\n        if (layers.length > 1) {\r\n            modalBody.classList.remove(loadingCssClass);\r\n            //bindeamos el onchange de combo\r\n            dialog.getElementsByClassName(\"tc-combo\")[0].addEventListener(\"change\", function () {\r\n                if (!this.value) {\r\n                    var form = self.getForm();\r\n                    empty(form);\r\n                    for (var i = 0; i < form.children.length; i++) form.removeChild(form.children[i]);\r\n                    self.clearFilters();\r\n                    return;\r\n                }\r\n                dialog.querySelector(\".tc-modal-body .tc-ctl-wfsquery-message\", dialog).classList.add(hiddenCssClass);\r\n                _currentLayerTitle = this.options[this.selectedIndex].text;\r\n                modalBody.classList.add(loadingCssClass);\r\n                _currentLayerName = this.value;\r\n                _currentLayer.describeFeatureType(this.value).then(function (data) {\r\n                    _manageDescribeFeature(data, self, true);\r\n                }, function (err) {\r\n                    var tbody = dialog.getElementsByClassName(\"tc-modal-body\")[0];\r\n                    tbody.classList.remove(loadingCssClass);\r\n                    if (!err)\r\n                        tbody.insertAdjacentHTML('beforeend', \"<div class=\\\"tc-ctl-wfsquery-message tc-msg-warning\\\">\" + getLocaleString(\"query.LayerNotAvailable\") + \"</div>\");\r\n                    else\r\n                        tbody.insertAdjacentHTML('beforeend', \"<div class=\\\"tc-ctl-wfsquery-message tc-msg-error\\\">\" + err + \"</div>\");\r\n                });\r\n            });\r\n        }\r\n        else if (layers.length === 1) {\r\n            //comprabamos que la capa existe en el capabilities\r\n            var layerCapabilities = capabilities.FeatureTypes[layers[0].substring(layers[0].indexOf(\":\") + 1)];\r\n            if (layerCapabilities) {\r\n                _currentLayerTitle = capabilities.FeatureTypes[layers[0].substring(layers[0].indexOf(\":\") + 1)].Title;\r\n                _currentLayerName = layers[0];\r\n                _currentLayer.describeFeatureType(layers[0]).then(function (data) {\r\n                    _manageDescribeFeature(data, self, true);\r\n                }, function (err) {\r\n                    var tbody = dialog.getElementsByClassName(\"tc-modal-body\")[0];\r\n                    tbody.classList.remove(loadingCssClass);\r\n                    if (!err)\r\n                        tbody.insertAdjacentHTML('beforeend', \"<div class=\\\"tc-ctl-wfsquery-message tc-msg-warning\\\">\" + getLocaleString(\"query.LayerNotAvailable\") + \"</div>\");\r\n                    else\r\n                        tbody.insertAdjacentHTML('beforeend', \"<div class=\\\"tc-ctl-wfsquery-message tc-msg-error\\\">\" + err + \"</div>\");\r\n\r\n                });\r\n            }\r\n            else {\r\n                var tbody = dialog.getElementsByClassName(\"tc-modal-body\")[0];\r\n                tbody.classList.remove(loadingCssClass);\r\n                tbody.insertAdjacentHTML('beforeend', \"<div class=\\\"tc-ctl-wfsquery-message tc-msg-warning\\\">\" + getLocaleString(\"query.LayerNotAvailable\") + \"</div>\");\r\n                //TC.Util.closeModal();\r\n                //layer.map.toast(\"Mal\", { type: TC.Consts.msgType.WARNING });\r\n            }\r\n\r\n        }\r\n        else {\r\n            TC.Util.closeModal();\r\n            layer.map.toast(TC.Util.getLocaleString(layer.map.options.locale, \"query.LayerNotAvailable\"), { type: TC.Consts.msgType.ERROR });\r\n        }\r\n    };\r\n\r\n    const _renderModalDialog = function (layer, layerName, capabilities, callback) {\r\n        const self = this;\r\n        let layers;\r\n        if (layer.getDisgregatedLayerNames) {\r\n            layers = [];\r\n            layer.getDisgregatedLayerNames().forEach(function (value, index) {\r\n                var path = layer.getPath(value);\r\n                //quitamos aquellas que no estén disponibles en el WFS\r\n                if (capabilities.FeatureTypes.hasOwnProperty(value.substring(value.indexOf(\":\") + 1)))\r\n                    layers.push({ name: value, title: path[path.length - 1] });\r\n            });\r\n            layers.sort(function (a, b) {\r\n                if (a.title < b.title) return -1;\r\n                if (a.title > b.title) return 1;\r\n                return 0;\r\n            });\r\n        }\r\n        else {\r\n            layers = layer.featureType;\r\n        }\r\n\r\n        self.getRenderedHtml(self.CLASS + \"-dialog\",\r\n            {\r\n                layerName: getLocaleString(\"query.titleDialog\", { \"layerName\": layerName }),\r\n                layers: layers\r\n            }, function (html) {\r\n                // Borramos diálogos previos\r\n                document.body.querySelectorAll(`.${self.CLASS}-dialog`).forEach(elm => elm.remove());\r\n\r\n                var d = document.createElement(\"div\");\r\n                d.insertAdjacentHTML('beforeEnd', html);\r\n                var modal = null;\r\n                if (d.childNodes.length > 0) {\r\n                    modal = d.firstChild;\r\n                    document.body.appendChild(modal);\r\n                }\r\n                modalBody = modal.getElementsByClassName(\"tc-modal-body\")[0]\r\n                modalBody.classList.add(loadingCssClass);\r\n\r\n                TC.Util.showModal(modal, {\r\n                    closeCallback: () => self.clearFilters()\r\n                });\r\n                //IE me hace la puñeta con los estilos, no me fuciona el calc el el max-height así que lo calculo cada vez que muestro el dialogo\r\n                if (TC.Util.detectIE()) {\r\n                    var coef = 1;\r\n                    switch (true) {\r\n                        case document.body.clientWidth > 768 && document.body.clientWidth < document.body.clientHeight:\r\n                        case document.body.clientWidth > 1024:\r\n                            coef = 0.8;\r\n                        case document.body.clientWidth > 1140:\r\n                            coef = 0.7;\r\n                            break;\r\n                    }\r\n                    modalBody.style.maxHeight = (document.body.clientHeight * coef) - modalBody.nextElementSibling.clientHeight - modalBody.previousElementSibling.clientHeight;\r\n                }\r\n                self.modalDialog = modal;\r\n                modal.getElementsByClassName(\"tc-button tc-ctl-wlm-btn-launch\")[0].addEventListener(\"click\", function () {\r\n                    self.sendQuery();\r\n                })\r\n                if (callback) callback(modal);\r\n            });\r\n    };\r\n\r\n    ctlProto.renderModalDialog = function (layer) {\r\n        const self = this;\r\n        let title;\r\n        let capabilitiesPromise;\r\n        if (layer.type === TC.Consts.layerType.WMS) {\r\n            const path = layer.getPath();\r\n            title = path[path.length - 1];\r\n            capabilitiesPromise = layer.getWFSCapabilities();\r\n        }\r\n        else if (layer.type === TC.Consts.layerType.WFS) {\r\n            title = layer.title;\r\n            capabilitiesPromise = layer.getCapabilitiesPromise();\r\n        }\r\n        else {\r\n            return;\r\n        }\r\n        let renderDialogPromise = new Promise(function (resolve, reject) {\r\n            capabilitiesPromise.then(function (capabilities) {\r\n                _renderModalDialog.apply(self, [\r\n                    layer,\r\n                    title,\r\n                    capabilities,\r\n                    function (modal) {\r\n                        resolve(modal);\r\n                    }]);\r\n            })\r\n        });\r\n\r\n        Promise.all([self, layer, renderDialogPromise, capabilitiesPromise]).then(_renderQueryForm);\r\n    };\r\n\r\n    ctlProto.removeFilter = function (filter) {\r\n        const self = this;\r\n        let idx = filter;\r\n        if (filter instanceof TC.filter.Filter) {\r\n            idx = self.filters.indexOf(filter);\r\n        }\r\n        if (idx >= 0 && idx < self.filters.length) {\r\n            const removedFilter = self.filters.splice(idx, 1)[0];\r\n            if (removedFilter instanceof TC.filter.Spatial) {\r\n                removedFilter.geometry.layer.removeFeature(removedFilter.geometry);\r\n            }\r\n            _renderFilterConditions(self);\r\n        }\r\n    }\r\n\r\n    ctlProto.clearFilters = function () {\r\n        const self = this;\r\n        self.filters\r\n            .filter(f => f instanceof TC.filter.Spatial)\r\n            .forEach(f => f.geometry.layer.removeFeature(f.geometry));\r\n        self.filters.length = 0;\r\n    };\r\n\r\n    ctlProto.getForm = function () {\r\n        const self = this;\r\n        return self.modalDialog && self.modalDialog.querySelector('.tc-modal-form');\r\n    };   \r\n\r\n})();"]}