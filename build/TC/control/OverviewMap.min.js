TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.OverviewMap=function(){TC.Control.apply(this,arguments);this.isLoaded=!1;this.layer=null};TC.inherit(TC.control.OverviewMap,TC.Control);!function(){var e=TC.control.OverviewMap.prototype;e.CLASS="tc-ctl-ovmap";e.template={compiler:[8,">= 4.3.0"],main:function(e,t,a,n,r){return'<div class="tc-ctl-ovmap-load tc-hidden"></div>'},useData:!0};e.register=function(e){const t=this,a=function(t){return function(t){var a,n=function(e,t){for(var a=null,n=0;n<t.length;n++){var r=t[n];if((r.id||r)===e){a=r;break}}return a};if("string"==typeof t){var r=n(t,e.options.availableBaseLayers);TC.Util.isPlainObject(r)||(r=n(t,e.options.baseLayers));TC.Util.isPlainObject(r)&&(a=new TC.layer.Raster(r))}else a=t instanceof TC.Layer?t:t.type===TC.Consts.layerType.VECTOR||t.type===TC.Consts.layerType.KML||t.type===TC.Consts.layerType.WFS?new TC.layer.Vector(t):new TC.layer.Raster(t);return a}(t)};return new Promise(function(n,r){TC.Control.prototype.register.call(t,e).then(function(r){t.wrap=new TC.wrap.control.OverviewMap(t);e.loaded(function(){t.defaultLayer=a(t.options.layer);t.layer=a(e.baseLayer.overviewMapLayer||t.options.layer||e.options.baseLayers[0]||e.options.availableBaseLayers[0]);t.wrap.register(e);!function(a){const n={};t.layer.getCapabilitiesPromise().then(function(){t.layer.isCompatible(e.crs)||0!==t.layer.wrap.getCompatibleMatrixSets(e.crs).length||(n.layer=t.layer.getFallbackLayer());t.wrap.reset(n)})}(e.crs);e.on(TC.Consts.event.PROJECTIONCHANGE+" "+TC.Consts.event.BASELAYERCHANGE,function(e){const t=this;if(t.map.baseLayer.type===TC.Consts.layerType.WMS||t.map.baseLayer.type===TC.Consts.layerType.WMTS||t.options.layer){var n=t.map.baseLayer.overviewMapLayer||t.options.layer;if(t.layer.id!==n){var r=a(n);t.wrap.reset({layer:r}).then(function(e){t.layer=e})}else TC.Consts.event.PROJECTIONCHANGE.indexOf(e.type)>-1&&t.wrap.reset({layer:t.layer}).then(function(e){t.layer=e})}}.bind(t))});n(r)}).catch(function(e){r(e)})})};e.loaded=function(e){TC.Util.isFunction(e)&&(this.isLoaded&&this.map&&this.map.isLoaded?e():this.on(TC.Consts.event.MAPLOAD,e))};e.activate=function(){this.enable()};e.deactivate=function(){this.disable()};e.enable=function(){TC.Control.prototype.enable.call(this);this.wrap.enable()};e.disable=function(){TC.Control.prototype.disable.call(this);this.wrap.disable()}}();
//# sourceMappingURL=../maps/control/OverviewMap.min.js.map