TC.control=TC.control||{};TC.control.Click||TC.syncLoadJS(TC.apiLocation+"TC/control/Click");TC.control.infoShare||TC.syncLoadJS(TC.apiLocation+"TC/control/infoShare");TC.Consts.event.POPUP=TC.Consts.event.POPUP||"popup.tc";TC.Consts.event.POPUPHIDE=TC.Consts.event.POPUPHIDE||"popuphide.tc";TC.Consts.event.DRAWCHART=TC.Consts.event.DRAWCHART||"drawchart.tc";TC.Consts.event.DRAWTABLE=TC.Consts.event.DRAWTABLE||"drawtable.tc";TC.Consts.event.RESULTSPANELCLOSE=TC.Consts.event.RESULTSPANELCLOSE||"resultspanelclose.tc";TC.Consts.event.FEATUREHIGHLIGHT="featurehighlight.tc";TC.Consts.event.FEATUREDOWNPLAY="featuredownplay.tc";TC.control.FeatureInfoCommons=function(){const e=this;TC.control.Click.apply(e,arguments);e._selectors={LIST_ITEM:`ul.${e.CLASS}-features li`,SHOW_ALL_CHECKBOX:`.${e.CLASS}-btn input[type="checkbox"].${e.CLASS}-btn-show-all`,SHOW_ALL_LABEL:`.${e.CLASS}-btn label.${e.CLASS}-btn-show-all`,ZOOM_ALL_BUTTON:`.${e.CLASS}-btn .${e.CLASS}-btn-zoom-all`,DEL_ALL_BUTTON:`.${e.CLASS}-btn .${e.CLASS}-btn-del-all`};e.resultsLayer=null;e.filterLayer=null;e._layersPromise=null;e.filterFeature=null;e.info=null;e._infoHistory={};e.popup=null;e.resultsPanel=null;e.lastFeatureCount=null;e.exportsState=!0;e._dialogDiv=TC.Util.getDiv(e.options.dialogDiv);window.$&&(e._$dialogDiv=$(e._dialogDiv));e.options.dialogDiv||document.body.appendChild(e._dialogDiv)};!function(){TC.inherit(TC.control.FeatureInfoCommons,TC.control.Click);TC.mix(TC.control.FeatureInfoCommons,TC.control.infoShare);var e=TC.control.FeatureInfoCommons.prototype;e.CLASS="tc-ctl-finfo";e.CURRENT_CLASS="tc-current";e.TITLE_SEPARATOR=" \u2022 ";e.DEFAULT_STROKE_COLOR="#0000ff";e.template={};e.template[e.CLASS]={1:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.escapeExpression,s=e.lambda,c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <span class="tc-ctl-finfo-coords-pair tc-ctl-finfo-coords-lat">'+i(c(n,"i18n").call(r,"lat",{name:"i18n",hash:{},data:a,loc:{start:{line:4,column:67},end:{line:4,column:81}}}))+': <span class="tc-ctl-finfo-coords-val">'+i(s(null!=(o=null!=t?c(t,"coords"):t)?c(o,"1"):o,t))+'</span></span>\r\n    <span class="tc-ctl-finfo-coords-pair tc-ctl-finfo-coords-lon">'+i(c(n,"i18n").call(r,"lon",{name:"i18n",hash:{},data:a,loc:{start:{line:5,column:67},end:{line:5,column:81}}}))+': <span class="tc-ctl-finfo-coords-val">'+i(s(null!=(o=null!=t?c(t,"coords"):t)?c(o,"0"):o,t))+"</span></span>\r\n"},3:function(e,t,n,l,a){var o,r=e.lambda,i=e.escapeExpression,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <span class="tc-ctl-finfo-coords-pair tc-ctl-finfo-coords-x">x: <span class="tc-ctl-finfo-coords-val">'+i(r(null!=(o=null!=t?s(t,"coords"):t)?s(o,"0"):o,t))+'</span></span>\r\n    <span class="tc-ctl-finfo-coords-pair tc-ctl-finfo-coords-x">y: <span class="tc-ctl-finfo-coords-val">'+i(r(null!=(o=null!=t?s(t,"coords"):t)?s(o,"1"):o,t))+"</span></span>\r\n"},5:function(e,t,n,l,a){var o=null!=t?t:e.nullContext||{},r=e.escapeExpression,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<span class="tc-ctl-finfo-coords-pair tc-ctl-finfo-elev" title="'+r(i(n,"i18n").call(o,"elevation",{name:"i18n",hash:{},data:a,loc:{start:{line:10,column:92},end:{line:10,column:112}}}))+'">'+r(i(n,"i18n").call(o,"ele",{name:"i18n",hash:{},data:a,loc:{start:{line:10,column:114},end:{line:10,column:128}}}))+': <span class="tc-ctl-finfo-coords-val"></span></span><span class="tc-ctl-finfo-coords-pair tc-ctl-finfo-height" title="'+r(i(n,"i18n").call(o,"heightOverTerrain",{name:"i18n",hash:{},data:a,loc:{start:{line:10,column:248},end:{line:10,column:276}}}))+'">'+r(i(n,"i18n").call(o,"height",{name:"i18n",hash:{},data:a,loc:{start:{line:10,column:278},end:{line:10,column:295}}}))+': <span class="tc-ctl-finfo-coords-val"></span></span>'},7:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"        <li>\r\n            <h3>"+(null!=(o=i(n,"if").call(r,null!=t?i(t,"title"):t,{name:"if",hash:{},fn:e.program(8,a,0),inverse:e.program(10,a,0),data:a,loc:{start:{line:16,column:16},end:{line:16,column:126}}}))?o:"")+'</h3>\r\n            <div class="tc-ctl-finfo-service-content">\r\n'+(null!=(o=i(n,"each").call(r,null!=t?i(t,"hasLimits"):t,{name:"each",hash:{},fn:e.program(15,a,0),inverse:e.program(17,a,0),data:a,loc:{start:{line:18,column:16},end:{line:64,column:25}}}))?o:"")+"            </div>\r\n        </li>\r\n"},8:function(e,t,n,l,a){var o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return e.escapeExpression(e.lambda(null!=t?o(t,"title"):t,t))},10:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=r(n,"if").call(null!=t?t:e.nullContext||{},null!=(o=null!=(o=null!=t?r(t,"layers"):t)?r(o,"0"):o)?r(o,"title"):o,{name:"if",hash:{},fn:e.program(11,a,0),inverse:e.program(13,a,0),data:a,loc:{start:{line:16,column:46},end:{line:16,column:119}}}))?o:""},11:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return e.escapeExpression(e.lambda(null!=(o=null!=(o=null!=t?r(t,"layers"):t)?r(o,"0"):o)?r(o,"title"):o,t))},13:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return e.escapeExpression(e.lambda(null!=(o=null!=t?r(t,"layer"):t)?r(o,"name"):o,t))},15:function(e,t,n,l,a){var o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                <span class="tc-ctl-finfo-errors">'+e.escapeExpression(e.lambda(null!=t?o(t,"hasLimits"):t,t))+"</span>\r\n"},17:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                    <ul class="tc-ctl-finfo-layers">\r\n'+(null!=(o=r(n,"each").call(null!=t?t:e.nullContext||{},null!=t?r(t,"layers"):t,{name:"each",hash:{},fn:e.program(18,a,0),inverse:e.program(39,a,0),data:a,loc:{start:{line:22,column:24},end:{line:62,column:33}}}))?o:"")+"                    </ul>\r\n"},18:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                        <li>\r\n                            <h4><span class="tc-ctl-finfo-layer-n">'+e.escapeExpression(e.lambda(null!=(o=null!=t?i(t,"features"):t)?i(o,"length"):o,t))+"</span> "+(null!=(o=i(n,"each").call(r,null!=t?i(t,"path"):t,{name:"each",hash:{},fn:e.program(19,a,0),inverse:e.noop,data:a,loc:{start:{line:24,column:94},end:{line:24,column:162}}}))?o:"")+'</h4>                                            \r\n                            <div class="tc-ctl-finfo-layer-content">\r\n                                <ul class="tc-ctl-finfo-features">\r\n'+(null!=(o=i(n,"each").call(r,null!=t?i(t,"features"):t,{name:"each",hash:{},fn:e.program(22,a,0),inverse:e.program(37,a,0),data:a,loc:{start:{line:27,column:36},end:{line:56,column:45}}}))?o:"")+"                                </ul>\r\n                            </div>\r\n                        </li>\r\n"},19:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(o=r(n,"unless").call(null!=t?t:e.nullContext||{},a&&r(a,"first"),{name:"unless",hash:{},fn:e.program(20,a,0),inverse:e.noop,data:a,loc:{start:{line:24,column:108},end:{line:24,column:145}}}))?o:"")+e.escapeExpression(e.lambda(t,t))},20:function(e,t,n,l,a){return" &bull; "},22:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"                                    <li>\r\n"+(null!=(o=r(n,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"rawContent"):t,{name:"if",hash:{},fn:e.program(23,a,0),inverse:e.program(32,a,0),data:a,loc:{start:{line:29,column:40},end:{line:52,column:47}}}))?o:"")+"                                    </li>\r\n"},23:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"                                            <h5>"+e.escapeExpression(i(n,"i18n").call(r,"feature",{name:"i18n",hash:{},data:a,loc:{start:{line:30,column:48},end:{line:30,column:66}}}))+"</h5>\r\n"+(null!=(o=i(n,"if").call(r,i(n,"eq").call(r,null!=t?i(t,"rawFormat"):t,"text/html",{name:"eq",hash:{},data:a,loc:{start:{line:31,column:54},end:{line:31,column:80}}}),{name:"if",hash:{},fn:e.program(24,a,0),inverse:e.program(30,a,0),data:a,loc:{start:{line:31,column:48},end:{line:44,column:55}}}))?o:"")},24:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=r(n,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"expandUrl"):t,{name:"if",hash:{},fn:e.program(25,a,0),inverse:e.noop,data:a,loc:{start:{line:32,column:52},end:{line:41,column:59}}}))?o:""},25:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"unless").call(r,i(n,"eq").call(r,null!=t?i(t,"expandUrl"):t,"",{name:"eq",hash:{},data:a,loc:{start:{line:33,column:66},end:{line:33,column:83}}}),{name:"unless",hash:{},fn:e.program(26,a,0),inverse:e.program(28,a,0),data:a,loc:{start:{line:33,column:56},end:{line:40,column:67}}}))?o:""},26:function(e,t,n,l,a){var o=e.lambda,r=e.escapeExpression,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                                                            <div class="tc-ctl-finfo-features-iframe-cnt">\r\n                                                                <iframe src="'+r(o(null!=t?i(t,"rawUrl"):t,t))+'"></iframe>\r\n                                                                <a class="tc-ctl-finfo-open" onclick="window.open(\''+r(o(null!=t?i(t,"expandUrl"):t,t))+"', '_blank')\" title=\""+r(i(n,"i18n").call(null!=t?t:e.nullContext||{},"expand",{name:"i18n",hash:{},data:a,loc:{start:{line:36,column:149},end:{line:36,column:166}}}))+'"></a>\r\n                                                            </div>\r\n'},28:function(e,t,n,l,a){var o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                                                            <iframe src="'+e.escapeExpression(e.lambda(null!=t?o(t,"rawUrl"):t,t))+'"></iframe>\r\n'},30:function(e,t,n,l,a){var o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"                                                    <pre>"+e.escapeExpression(e.lambda(null!=t?o(t,"rawContent"):t,t))+"</pre>\r\n"},32:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=r(n,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"error"):t,{name:"if",hash:{},fn:e.program(33,a,0),inverse:e.program(35,a,0),data:a,loc:{start:{line:46,column:44},end:{line:51,column:51}}}))?o:""},33:function(e,t,n,l,a){var o=e.escapeExpression,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                                                <span class="tc-ctl-finfo-errors">'+o(r(n,"i18n").call(null!=t?t:e.nullContext||{},"fi.error",{name:"i18n",hash:{},data:a,loc:{start:{line:47,column:82},end:{line:47,column:101}}}))+'<span class="tc-ctl-finfo-error-text">'+o(e.lambda(null!=t?r(t,"error"):t,t))+"</span></span>\r\n"},35:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"                                                <h5>"+e.escapeExpression(e.lambda(null!=t?r(t,"id"):t,t))+"</h5>\r\n"+(null!=(o=e.invokePartial(r(l,"tc-ctl-finfo-attr"),t,{name:"tc-ctl-finfo-attr",data:a,indent:"                                                ",helpers:n,partials:l,decorators:e.decorators}))?o:"")},37:function(e,t,n,l,a){var o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                                        <li class="tc-ctl-finfo-empty">'+e.escapeExpression(o(n,"i18n").call(null!=t?t:e.nullContext||{},"noDataInThisLayer",{name:"i18n",hash:{},data:a,loc:{start:{line:55,column:71},end:{line:55,column:99}}}))+"</li>\r\n"},39:function(e,t,n,l,a){var o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                            <li class="tc-ctl-finfo-empty">'+e.escapeExpression(o(n,"i18n").call(null!=t?t:e.nullContext||{},"noDataAtThisService",{name:"i18n",hash:{},data:a,loc:{start:{line:61,column:59},end:{line:61,column:89}}}))+"</li>\r\n"},41:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=r(n,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"displayElevation"):t,{name:"if",hash:{},fn:e.program(42,a,0),inverse:e.noop,data:a,loc:{start:{line:68,column:8},end:{line:72,column:15}}}))?o:""},42:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=r(n,"unless").call(null!=t?t:e.nullContext||{},null!=t?r(t,"loading"):t,{name:"unless",hash:{},fn:e.program(43,a,0),inverse:e.noop,data:a,loc:{start:{line:69,column:12},end:{line:71,column:23}}}))?o:""},43:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"                "+(null!=(o=r(n,"unless").call(null!=t?t:e.nullContext||{},null!=t?r(t,"displayElevation"):t,{name:"unless",hash:{},fn:e.program(44,a,0),inverse:e.noop,data:a,loc:{start:{line:70,column:16},end:{line:70,column:108}}}))?o:"")+"\r\n"},44:function(e,t,n,l,a){var o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<li class="tc-ctl-finfo-empty">'+e.escapeExpression(o(n,"i18n").call(null!=t?t:e.nullContext||{},"noData",{name:"i18n",hash:{},data:a,loc:{start:{line:70,column:75},end:{line:70,column:92}}}))+"</li>"},46:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"if").call(r,i(n,"gt").call(r,null!=t?i(t,"featureCount"):t,1,{name:"gt",hash:{},data:a,loc:{start:{line:77,column:10},end:{line:77,column:29}}}),{name:"if",hash:{},fn:e.program(47,a,0),inverse:e.noop,data:a,loc:{start:{line:77,column:4},end:{line:81,column:11}}}))?o:""},47:function(e,t,n,l,a){var o=null!=t?t:e.nullContext||{},r=e.escapeExpression,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<button class="tc-ctl-btn tc-ctl-finfo-btn-prev">'+r(i(n,"i18n").call(o,"previous",{name:"i18n",hash:{},data:a,loc:{start:{line:78,column:49},end:{line:78,column:68}}}))+'</button>\r\n<div class="tc-ctl-finfo-counter"><span class="tc-ctl-finfo-counter-current"></span>/'+r(e.lambda(null!=t?i(t,"featureCount"):t,t))+'</div>\r\n<button class="tc-ctl-btn tc-ctl-finfo-btn-next">'+r(i(n,"i18n").call(o,"next",{name:"i18n",hash:{},data:a,loc:{start:{line:80,column:49},end:{line:80,column:64}}}))+"</button>\r\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.escapeExpression,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="tc-ctl-finfo-coords">\r\n    <span class="tc-ctl-finfo-coords-pair tc-ctl-finfo-coords-crs" title="'+i(s(n,"i18n").call(r,"crs",{name:"i18n",hash:{},data:a,loc:{start:{line:2,column:74},end:{line:2,column:88}}}))+'">CRS: <span class="tc-ctl-finfo-coords-val">'+i(e.lambda(null!=t?s(t,"crs"):t,t))+"</span></span>\r\n"+(null!=(o=s(n,"if").call(r,null!=t?s(t,"isGeo"):t,{name:"if",hash:{},fn:e.program(1,a,0),inverse:e.program(3,a,0),data:a,loc:{start:{line:3,column:4},end:{line:9,column:11}}}))?o:"")+"    "+(null!=(o=s(n,"if").call(r,null!=t?s(t,"displayElevation"):t,{name:"if",hash:{},fn:e.program(5,a,0),inverse:e.noop,data:a,loc:{start:{line:10,column:4},end:{line:10,column:356}}}))?o:"")+'\r\n</div>\r\n<div class="tc-ctl-finfo-result">\r\n    <ul class="tc-ctl-finfo-services">\r\n'+(null!=(o=s(n,"each").call(r,null!=t?s(t,"services"):t,{name:"each",hash:{},fn:e.program(7,a,0),inverse:e.program(41,a,0),data:a,loc:{start:{line:14,column:8},end:{line:73,column:17}}}))?o:"")+"    </ul>\r\n</div>\r\n"+(null!=(o=s(n,"if").call(r,null!=t?s(t,"featureCount"):t,{name:"if",hash:{},fn:e.program(46,a,0),inverse:e.noop,data:a,loc:{start:{line:76,column:0},end:{line:82,column:7}}}))?o:"")},usePartial:!0,useData:!0};e.template[e.CLASS+"-attr"]={1:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=r(n,"each").call(null!=t?t:e.nullContext||{},null!=t?r(t,"attributes"):t,{name:"each",hash:{},fn:e.program(2,a,0),inverse:e.noop,data:a,loc:{start:{line:2,column:4},end:{line:6,column:13}}}))?o:""},2:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"if").call(r,i(n,"getHeader").call(r,null!=t?i(t,"name"):t,{name:"getHeader",hash:{},data:a,loc:{start:{line:3,column:14},end:{line:3,column:30}}}),{name:"if",hash:{},fn:e.program(3,a,0),inverse:e.noop,data:a,loc:{start:{line:3,column:8},end:{line:5,column:15}}}))?o:""},3:function(e,t,n,l,a){var o=null!=t?t:e.nullContext||{},r=e.escapeExpression,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<"+r(i(n,"getHeader").call(o,null!=t?i(t,"name"):t,{name:"getHeader",hash:{},data:a,loc:{start:{line:4,column:1},end:{line:4,column:19}}}))+">"+r(e.lambda(null!=t?i(t,"value"):t,t))+"</"+r(i(n,"getHeader").call(o,null!=t?i(t,"name"):t,{name:"getHeader",hash:{},data:a,loc:{start:{line:4,column:31},end:{line:4,column:49}}}))+">\r\n"},5:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"unless").call(r,i(n,"getHeader").call(r,null!=t?i(t,"name"):t,{name:"getHeader",hash:{},data:a,loc:{start:{line:11,column:14},end:{line:11,column:30}}}),{name:"unless",hash:{},fn:e.program(6,a,0),inverse:e.noop,data:a,loc:{start:{line:11,column:4},end:{line:60,column:15}}}))?o:""},6:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"if").call(r,i(n,"isVideoAttribute").call(r,null!=t?i(t,"name"):t,null!=t?i(t,"value"):t,{name:"isVideoAttribute",hash:{},data:a,loc:{start:{line:12,column:14},end:{line:12,column:43}}}),{name:"if",hash:{},fn:e.program(7,a,0),inverse:e.program(9,a,0),data:a,loc:{start:{line:12,column:8},end:{line:59,column:15}}}))?o:""},7:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <tr>\r\n            <th class="tc-ctl-finfo-attr" colspan="2">'+e.escapeExpression(r(n,"removeSpecialAttributeTag").call(null!=t?t:e.nullContext||{},null!=t?r(t,"name"):t,{name:"removeSpecialAttributeTag",hash:{},data:a,loc:{start:{line:14,column:54},end:{line:14,column:88}}}))+'</th>\r\n        </tr>\r\n        <tr>\r\n            <td class="tc-ctl-finfo-val tc-video-attr" colspan="2">\r\n'+(null!=(o=e.invokePartial(r(l,"tc-ctl-finfo-attr-video"),t,{name:"tc-ctl-finfo-attr-video",hash:{value:null!=t?r(t,"value"):t,name:null!=t?r(t,"name"):t},data:a,indent:"                ",helpers:n,partials:l,decorators:e.decorators}))?o:"")+"            </td>\r\n        </tr>                                                            \r\n"},9:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"if").call(r,i(n,"isImageAttribute").call(r,null!=t?i(t,"name"):t,null!=t?i(t,"value"):t,{name:"isImageAttribute",hash:{},data:a,loc:{start:{line:22,column:18},end:{line:22,column:47}}}),{name:"if",hash:{},fn:e.program(10,a,0),inverse:e.program(12,a,0),data:a,loc:{start:{line:22,column:12},end:{line:58,column:19}}}))?o:""},10:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <tr>\r\n            <th class="tc-ctl-finfo-attr" colspan="2">'+e.escapeExpression(r(n,"removeSpecialAttributeTag").call(null!=t?t:e.nullContext||{},null!=t?r(t,"name"):t,{name:"removeSpecialAttributeTag",hash:{},data:a,loc:{start:{line:24,column:54},end:{line:24,column:88}}}))+'</th>\r\n        </tr>\r\n        <tr>\r\n            <td class="tc-ctl-finfo-val tc-img-attr" colspan="2">\r\n'+(null!=(o=e.invokePartial(r(l,"tc-ctl-finfo-attr-image"),t,{name:"tc-ctl-finfo-attr-image",hash:{value:null!=t?r(t,"value"):t,name:null!=t?r(t,"name"):t},data:a,indent:"                ",helpers:n,partials:l,decorators:e.decorators}))?o:"")+"            </td>\r\n        </tr>                                                            \r\n"},12:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"if").call(r,i(n,"isAudioAttribute").call(r,null!=t?i(t,"name"):t,null!=t?i(t,"value"):t,{name:"isAudioAttribute",hash:{},data:a,loc:{start:{line:32,column:22},end:{line:32,column:51}}}),{name:"if",hash:{},fn:e.program(13,a,0),inverse:e.program(15,a,0),data:a,loc:{start:{line:32,column:16},end:{line:57,column:23}}}))?o:""},13:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <tr>\r\n            <th class="tc-ctl-finfo-attr" colspan="2">'+e.escapeExpression(r(n,"removeSpecialAttributeTag").call(null!=t?t:e.nullContext||{},null!=t?r(t,"name"):t,{name:"removeSpecialAttributeTag",hash:{},data:a,loc:{start:{line:34,column:54},end:{line:34,column:88}}}))+'</th>\r\n        </tr>\r\n        <tr>\r\n            <td class="tc-ctl-finfo-val tc-audio-attr" colspan="2">\r\n'+(null!=(o=e.invokePartial(r(l,"tc-ctl-finfo-attr-audio"),t,{name:"tc-ctl-finfo-attr-audio",hash:{value:null!=t?r(t,"value"):t,name:null!=t?r(t,"name"):t},data:a,indent:"                    ",helpers:n,partials:l,decorators:e.decorators}))?o:"")+"            </td>\r\n        </tr>                                                            \r\n"},15:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"if").call(r,i(n,"isEmbedAttribute").call(r,null!=t?i(t,"name"):t,null!=t?i(t,"value"):t,{name:"isEmbedAttribute",hash:{},data:a,loc:{start:{line:42,column:26},end:{line:42,column:55}}}),{name:"if",hash:{},fn:e.program(16,a,0),inverse:e.program(18,a,0),data:a,loc:{start:{line:42,column:20},end:{line:56,column:27}}}))?o:""},16:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <tr>\r\n            <th class="tc-ctl-finfo-attr" colspan="2">'+e.escapeExpression(r(n,"removeSpecialAttributeTag").call(null!=t?t:e.nullContext||{},null!=t?r(t,"name"):t,{name:"removeSpecialAttributeTag",hash:{},data:a,loc:{start:{line:44,column:54},end:{line:44,column:88}}}))+'</th>\r\n        </tr>\r\n        <tr>\r\n            <td class="tc-ctl-finfo-val tc-embed-attr" colspan="2">\r\n'+(null!=(o=e.invokePartial(r(l,"tc-ctl-finfo-attr-embed"),t,{name:"tc-ctl-finfo-attr-embed",hash:{value:null!=t?r(t,"value"):t,name:null!=t?r(t,"name"):t},data:a,indent:"                        ",helpers:n,partials:l,decorators:e.decorators}))?o:"")+"            </td>\r\n        </tr>                                                            \r\n"},18:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <tr>\r\n            <th class="tc-ctl-finfo-attr">'+e.escapeExpression(e.lambda(null!=t?i(t,"name"):t,t))+'</th>\r\n            <td class="tc-ctl-finfo-val">'+(null!=(o=i(n,"unless").call(r,i(n,"eq").call(r,null!=t?i(t,"value"):t,null,{name:"eq",hash:{},data:a,loc:{start:{line:54,column:51},end:{line:54,column:66}}}),{name:"unless",hash:{},fn:e.program(19,a,0),inverse:e.noop,data:a,loc:{start:{line:54,column:41},end:{line:54,column:111}}}))?o:"")+"</td>                                                               \r\n        </tr>\r\n"},19:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=e.invokePartial(r(l,"tc-ctl-finfo-object"),null!=t?r(t,"value"):t,{name:"tc-ctl-finfo-object",data:a,helpers:n,partials:l,decorators:e.decorators}))?o:""},compiler:[8,">= 4.3.0"],main:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(o=i(n,"if").call(r,null!=t?i(t,"singleFeature"):t,{name:"if",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:1,column:0},end:{line:7,column:7}}}))?o:"")+'<table class="tc-attr">\r\n    <tbody>\r\n'+(null!=(o=i(n,"each").call(r,null!=t?i(t,"attributes"):t,{name:"each",hash:{},fn:e.program(5,a,0),inverse:e.noop,data:a,loc:{start:{line:10,column:0},end:{line:61,column:9}}}))?o:"")+"    </tbody>\r\n</table>"},usePartial:!0,useData:!0};e.template[e.CLASS+"-object"]={1:function(e,t,n,l,a){var o;return'<table class="complexAttr">\r\n    <tbody>\r\n'+(null!=(o=(e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]})(n,"each").call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(2,a,0),inverse:e.noop,data:a,loc:{start:{line:4,column:4},end:{line:35,column:13}}}))?o:"")+"    </tbody>\r\n</table>\r\n"},2:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"unless").call(r,i(n,"isObject").call(r,t,{name:"isObject",hash:{},data:a,loc:{start:{line:5,column:18},end:{line:5,column:33}}}),{name:"unless",hash:{},fn:e.program(3,a,0),inverse:e.program(6,a,0),data:a,loc:{start:{line:5,column:8},end:{line:34,column:19}}}))?o:""},3:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <tr class="keyValue">\r\n            <th class="key">'+e.escapeExpression(e.lambda(a&&i(a,"key"),t))+'</th>\r\n            <td class="value tc-ctl-finfo-val">'+(null!=(o=i(n,"unless").call(r,i(n,"isEmpty").call(r,t,{name:"isEmpty",hash:{},data:a,loc:{start:{line:8,column:57},end:{line:8,column:71}}}),{name:"unless",hash:{},fn:e.program(4,a,0),inverse:e.noop,data:a,loc:{start:{line:8,column:47},end:{line:8,column:115}}}))?o:"")+"</td>\r\n        </tr>\r\n"},4:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=e.invokePartial(r(l,"tc-ctl-finfo-object"),t,{name:"tc-ctl-finfo-object",data:a,helpers:n,partials:l,decorators:e.decorators}))?o:""},6:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <tr>\r\n            <th style="display:none">'+e.escapeExpression(e.lambda(a&&i(a,"key"),t))+"</th>\r\n            <td>\r\n"+(null!=(o=i(n,"if").call(r,i(n,"isObject").call(r,t,{name:"isObject",hash:{},data:a,loc:{start:{line:14,column:22},end:{line:14,column:37}}}),{name:"if",hash:{},fn:e.program(7,a,0),inverse:e.program(9,a,0),data:a,loc:{start:{line:14,column:16},end:{line:29,column:23}}}))?o:"")+(null!=(o=e.invokePartial(i(l,"tc-ctl-finfo-object"),t,{name:"tc-ctl-finfo-object",data:a,indent:"                    ",helpers:n,partials:l,decorators:e.decorators}))?o:"")+"                </div>\r\n            </td>\r\n        </tr>\r\n"},7:function(e,t,n,l,a){var o=null!=t?t:e.nullContext||{},r=e.escapeExpression,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                \x3c!--object--\x3e\r\n                <input type="checkbox" id="complexAttr_'+r(i(n,"getId").call(o,t,{name:"getId",hash:{},data:a,loc:{start:{line:16,column:55},end:{line:16,column:69}}}))+'">\r\n                <div>\r\n                    <label for="complexAttr_'+r(i(n,"getId").call(o,t,{name:"getId",hash:{},data:a,loc:{start:{line:18,column:44},end:{line:18,column:58}}}))+'" class="plus" title=""></label>\r\n                    <label for="complexAttr_'+r(i(n,"getId").call(o,t,{name:"getId",hash:{},data:a,loc:{start:{line:19,column:44},end:{line:19,column:58}}}))+'" class="title" title="">'+r(e.lambda(a&&i(a,"key"),t))+"</label><br />\r\n"},9:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(o=i(n,"if").call(r,i(n,"isArray").call(r,t,{name:"isArray",hash:{},data:a,loc:{start:{line:21,column:26},end:{line:21,column:40}}}),{name:"if",hash:{},fn:e.program(10,a,0),inverse:e.program(12,a,0),data:a,loc:{start:{line:21,column:20},end:{line:27,column:27}}}))?o:"")+"                    \x3c!--native--\x3e\r\n"},10:function(e,t,n,l,a){var o=e.escapeExpression,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                \x3c!--array--\x3e\r\n                <div>\r\n                    <label for="complexAttr_'+o(r(n,"getId").call(null!=t?t:e.nullContext||{},t,{name:"getId",hash:{},data:a,loc:{start:{line:24,column:44},end:{line:24,column:58}}}))+'" class="title" title="">'+o(e.lambda(a&&r(a,"key"),t))+"</label><br />\r\n"},12:function(e,t,n,l,a){return"                <div>\r\n"},14:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"if").call(r,i(n,"isArray").call(r,t,{name:"isArray",hash:{},data:a,loc:{start:{line:39,column:10},end:{line:39,column:24}}}),{name:"if",hash:{},fn:e.program(15,a,0),inverse:e.program(18,a,0),data:a,loc:{start:{line:39,column:4},end:{line:62,column:11}}}))?o:""},15:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.escapeExpression,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="complexAttr">\r\n    <input type="checkbox" id="complexAttr_'+i(s(n,"getId").call(r,t,{name:"getId",hash:{},data:a,loc:{start:{line:41,column:43},end:{line:41,column:57}}}))+'">\r\n    <div>\r\n        <label for="complexAttr_'+i(s(n,"getId").call(r,t,{name:"getId",hash:{},data:a,loc:{start:{line:43,column:32},end:{line:43,column:46}}}))+'" class="plus" title=""></label>\r\n        <label for="complexAttr_'+i(s(n,"getId").call(r,t,{name:"getId",hash:{},data:a,loc:{start:{line:44,column:32},end:{line:44,column:46}}}))+'" class="title" title="">'+i(e.lambda(null!=t?s(t,"length"):t,t))+" "+i(s(n,"i18n").call(r,"featureInfo.complexData.array",{name:"i18n",hash:{},data:a,loc:{start:{line:44,column:82},end:{line:44,column:122}}}))+'</label><br />\r\n        <table class="complexAttr">\r\n            <tbody>\r\n'+(null!=(o=s(n,"each").call(r,t,{name:"each",hash:{},fn:e.program(16,a,0),inverse:e.noop,data:a,loc:{start:{line:47,column:16},end:{line:51,column:25}}}))?o:"")+"            </tbody>\r\n        </table>\r\n    </div>\r\n</div>\r\n"},16:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"                <tr>\r\n                    <td>"+(null!=(o=e.invokePartial(r(l,"tc-ctl-finfo-object"),t,{name:"tc-ctl-finfo-object",data:a,helpers:n,partials:l,decorators:e.decorators}))?o:"")+"</td>\r\n                </tr>\r\n"},18:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"if").call(r,i(n,"isUrl").call(r,t,{name:"isUrl",hash:{},data:a,loc:{start:{line:57,column:14},end:{line:57,column:26}}}),{name:"if",hash:{},fn:e.program(19,a,0),inverse:e.program(21,a,0),data:a,loc:{start:{line:57,column:8},end:{line:61,column:15}}}))?o:""},19:function(e,t,n,l,a){var o=e.escapeExpression,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<a href="'+o(e.lambda(t,t))+'" target="_blank" title="'+o(i(n,"i18n").call(r,"linkInNewWindow",{name:"i18n",hash:{},data:a,loc:{start:{line:58,column:42},end:{line:58,column:68}}}))+'">'+o(i(n,"i18n").call(r,"open",{name:"i18n",hash:{},data:a,loc:{start:{line:58,column:70},end:{line:58,column:85}}}))+"</a>\r\n"},21:function(e,t,n,l,a){var o;return(null!=(o=(e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]})(n,"formatDateOrNumber").call(null!=t?t:e.nullContext||{},t,{name:"formatDateOrNumber",hash:{},data:a,loc:{start:{line:60,column:0},end:{line:60,column:30}}}))?o:"")+"\r\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"if").call(r,i(n,"isObject").call(r,t,{name:"isObject",hash:{},data:a,loc:{start:{line:1,column:6},end:{line:1,column:21}}}),{name:"if",hash:{},fn:e.program(1,a,0),inverse:e.program(14,a,0),data:a,loc:{start:{line:1,column:0},end:{line:63,column:7}}}))?o:""},usePartial:!0,useData:!0};e.template[e.CLASS+"-buttons"]={compiler:[8,">= 4.3.0"],main:function(e,t,n,l,a){var o=e.lambda,r=e.escapeExpression,i=null!=t?t:e.nullContext||{},s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="tc-ctl-finfo-btn">\r\n    <input type="checkbox" class="tc-ctl-finfo-btn-show-all" id="tc-ctl-finfo-btn-show-all-'+r(o(null!=t?s(t,"id"):t,t))+'" title="'+r(s(n,"i18n").call(i,"showOnMapAllResults",{name:"i18n",hash:{},data:a,loc:{start:{line:2,column:106},end:{line:2,column:136}}}))+'" />\r\n    <label for="tc-ctl-finfo-btn-show-all-'+r(o(null!=t?s(t,"id"):t,t))+'" class="tc-icon-btn tc-ctl-finfo-btn-show-all" title="'+r(s(n,"i18n").call(i,"showOnMapAllResults",{name:"i18n",hash:{},data:a,loc:{start:{line:3,column:103},end:{line:3,column:133}}}))+'">'+r(s(n,"i18n").call(i,"showOnMapAllResults",{name:"i18n",hash:{},data:a,loc:{start:{line:3,column:135},end:{line:3,column:165}}}))+'</label>\r\n    <button class="tc-icon-btn tc-ctl-finfo-btn-zoom-all tc-hidden" title="'+r(s(n,"i18n").call(i,"zoomToAllResults",{name:"i18n",hash:{},data:a,loc:{start:{line:4,column:75},end:{line:4,column:102}}}))+'">'+r(s(n,"i18n").call(i,"zoomToAllResults",{name:"i18n",hash:{},data:a,loc:{start:{line:4,column:104},end:{line:4,column:131}}}))+'</button>\r\n    <button class="tc-icon-btn tc-ctl-finfo-btn-del-all tc-hidden" title="'+r(s(n,"i18n").call(i,"removeAllResults",{name:"i18n",hash:{},data:a,loc:{start:{line:5,column:74},end:{line:5,column:101}}}))+'">'+r(s(n,"i18n").call(i,"removeAllResults",{name:"i18n",hash:{},data:a,loc:{start:{line:5,column:103},end:{line:5,column:130}}}))+'</button>\r\n    <button class="tc-icon-btn tc-ctl-finfo-btn-dl" title="'+r(s(n,"i18n").call(i,"downloadAllResults",{name:"i18n",hash:{},data:a,loc:{start:{line:6,column:59},end:{line:6,column:88}}}))+'">'+r(s(n,"i18n").call(i,"downloadAllResults",{name:"i18n",hash:{},data:a,loc:{start:{line:6,column:90},end:{line:6,column:119}}}))+"</button>\r\n</div>"},useData:!0};e.template[e.CLASS+"-dialog"]={1:function(e,t,n,l,a){var o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<img src="'+e.escapeExpression(e.lambda(null!=t?o(t,"src"):t,t))+'" />'},compiler:[8,">= 4.3.0"],main:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.escapeExpression,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="tc-ctl-finfo-dialog tc-ctl-finfo-img-dialog tc-modal tc-hidden">\r\n    <div class="tc-modal-background tc-modal-close"></div>\r\n    <div class="tc-modal-img">'+(null!=(o=s(n,"if").call(r,null!=t?s(t,"src"):t,{name:"if",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:3,column:30},end:{line:3,column:69}}}))?o:"")+'</div>\r\n</div>\r\n<div class="tc-ctl-finfo-dialog tc-ctl-finfo-share-dialog tc-modal tc-hidden">\r\n    <div class="tc-modal-background tc-modal-close"></div>\r\n    <div class="tc-modal-window">\r\n        <div class="tc-modal-header">\r\n            <h3>'+i(s(n,"i18n").call(r,"shareQuery",{name:"i18n",hash:{},data:a,loc:{start:{line:9,column:16},end:{line:9,column:37}}}))+'</h3>\r\n            <div class="tc-modal-close"></div>\r\n        </div>\r\n        <div class="tc-modal-body">\r\n            <div class="tc-ctl-finfo-share-dialog-ctl"></div>\r\n        </div>\r\n        <div class="tc-modal-footer">\r\n            <button type="button" class="tc-button tc-modal-close">'+i(s(n,"i18n").call(r,"close",{name:"i18n",hash:{},data:a,loc:{start:{line:16,column:67},end:{line:16,column:83}}}))+"</button>\r\n        </div>\r\n    </div>\r\n</div>"},useData:!0};e.template[e.CLASS+"-attr-val"]={1:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=e.invokePartial(r(l,"tc-ctl-finfo-attr-video"),t,{name:"tc-ctl-finfo-attr-video",hash:{value:null!=t?r(t,"value"):t,name:null!=t?r(t,"name"):t},data:a,indent:"    ",helpers:n,partials:l,decorators:e.decorators}))?o:""},3:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"if").call(r,i(n,"isImageAttribute").call(r,null!=t?i(t,"name"):t,null!=t?i(t,"value"):t,{name:"isImageAttribute",hash:{},data:a,loc:{start:{line:4,column:10},end:{line:4,column:39}}}),{name:"if",hash:{},fn:e.program(4,a,0),inverse:e.program(6,a,0),data:a,loc:{start:{line:4,column:4},end:{line:16,column:11}}}))?o:""},4:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=e.invokePartial(r(l,"tc-ctl-finfo-attr-image"),t,{name:"tc-ctl-finfo-attr-image",hash:{value:null!=t?r(t,"value"):t,name:null!=t?r(t,"name"):t},data:a,indent:"        ",helpers:n,partials:l,decorators:e.decorators}))?o:""},6:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"if").call(r,i(n,"isAudioAttribute").call(r,null!=t?i(t,"name"):t,null!=t?i(t,"value"):t,{name:"isAudioAttribute",hash:{},data:a,loc:{start:{line:7,column:14},end:{line:7,column:43}}}),{name:"if",hash:{},fn:e.program(7,a,0),inverse:e.program(9,a,0),data:a,loc:{start:{line:7,column:8},end:{line:15,column:15}}}))?o:""},7:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=e.invokePartial(r(l,"tc-ctl-finfo-attr-audio"),t,{name:"tc-ctl-finfo-attr-audio",hash:{value:null!=t?r(t,"value"):t,name:null!=t?r(t,"name"):t},data:a,indent:"            ",helpers:n,partials:l,decorators:e.decorators}))?o:""},9:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"if").call(r,i(n,"isEmbedAttribute").call(r,null!=t?i(t,"name"):t,null!=t?i(t,"value"):t,{name:"isEmbedAttribute",hash:{},data:a,loc:{start:{line:10,column:18},end:{line:10,column:47}}}),{name:"if",hash:{},fn:e.program(10,a,0),inverse:e.program(12,a,0),data:a,loc:{start:{line:10,column:12},end:{line:14,column:19}}}))?o:""},10:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=e.invokePartial(r(l,"tc-ctl-finfo-attr-embed"),t,{name:"tc-ctl-finfo-attr-embed",hash:{value:null!=t?r(t,"value"):t,name:null!=t?r(t,"name"):t},data:a,indent:"                ",helpers:n,partials:l,decorators:e.decorators}))?o:""},12:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"                "+(null!=(o=i(n,"unless").call(r,i(n,"eq").call(r,null!=t?i(t,"value"):t,null,{name:"eq",hash:{},data:a,loc:{start:{line:13,column:26},end:{line:13,column:41}}}),{name:"unless",hash:{},fn:e.program(13,a,0),inverse:e.noop,data:a,loc:{start:{line:13,column:16},end:{line:13,column:86}}}))?o:"")+"\r\n"},13:function(e,t,n,l,a){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=e.invokePartial(r(l,"tc-ctl-finfo-object"),null!=t?r(t,"value"):t,{name:"tc-ctl-finfo-object",data:a,helpers:n,partials:l,decorators:e.decorators}))?o:""},compiler:[8,">= 4.3.0"],main:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"if").call(r,i(n,"isVideoAttribute").call(r,null!=t?i(t,"name"):t,null!=t?i(t,"value"):t,{name:"isVideoAttribute",hash:{},data:a,loc:{start:{line:1,column:6},end:{line:1,column:35}}}),{name:"if",hash:{},fn:e.program(1,a,0),inverse:e.program(3,a,0),data:a,loc:{start:{line:1,column:0},end:{line:17,column:7}}}))?o:""},usePartial:!0,useData:!0};e.template[e.CLASS+"-attr-video"]={1:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.escapeExpression,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <iframe src="https://www.youtube.com/embed/'+i(s(n,"getYoutubeId").call(r,s(n,"removeSpecialAttributeTag").call(r,null!=t?s(t,"value"):t,{name:"removeSpecialAttributeTag",hash:{},data:a,loc:{start:{line:2,column:62},end:{line:2,column:95}}}),{name:"getYoutubeId",hash:{},data:a,loc:{start:{line:2,column:47},end:{line:2,column:97}}}))+'" class="tc-video-attr" style="width:'+i(s(n,"getTagWidth").call(r,null!=t?s(t,"name"):t,null!=t?s(t,"value"):t,{name:"getTagWidth",hash:{},data:a,loc:{start:{line:2,column:134},end:{line:2,column:160}}}))+";"+(null!=(o=s(n,"unless").call(r,s(n,"eq").call(r,s(n,"getTagWidth").call(r,null!=t?s(t,"name"):t,null!=t?s(t,"value"):t,{name:"getTagWidth",hash:{},data:a,loc:{start:{line:2,column:175},end:{line:2,column:199}}}),"auto",{name:"eq",hash:{},data:a,loc:{start:{line:2,column:171},end:{line:2,column:207}}}),{name:"unless",hash:{},fn:e.program(2,a,0),inverse:e.noop,data:a,loc:{start:{line:2,column:161},end:{line:2,column:235}}}))?o:"")+"height:"+i(s(n,"getTagHeight").call(r,null!=t?s(t,"name"):t,null!=t?s(t,"value"):t,{name:"getTagHeight",hash:{},data:a,loc:{start:{line:2,column:242},end:{line:2,column:269}}}))+";"+(null!=(o=s(n,"unless").call(r,s(n,"eq").call(r,s(n,"getTagHeight").call(r,null!=t?s(t,"name"):t,null!=t?s(t,"value"):t,{name:"getTagHeight",hash:{},data:a,loc:{start:{line:2,column:284},end:{line:2,column:309}}}),"auto",{name:"eq",hash:{},data:a,loc:{start:{line:2,column:280},end:{line:2,column:317}}}),{name:"unless",hash:{},fn:e.program(4,a,0),inverse:e.noop,data:a,loc:{start:{line:2,column:270},end:{line:2,column:346}}}))?o:"")+';" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>\r\n'},2:function(e,t,n,l,a){return"max-width:none;"},4:function(e,t,n,l,a){return"max-height:none;"},6:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.escapeExpression,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <video src="'+i(s(n,"removeSpecialAttributeTag").call(r,null!=t?s(t,"value"):t,{name:"removeSpecialAttributeTag",hash:{},data:a,loc:{start:{line:4,column:16},end:{line:4,column:51}}}))+'" class="tc-video-attr" style="width:'+i(s(n,"getTagWidth").call(r,null!=t?s(t,"name"):t,null!=t?s(t,"value"):t,{name:"getTagWidth",hash:{},data:a,loc:{start:{line:4,column:88},end:{line:4,column:114}}}))+";height:"+i(s(n,"getTagHeight").call(r,null!=t?s(t,"name"):t,null!=t?s(t,"value"):t,{name:"getTagHeight",hash:{},data:a,loc:{start:{line:4,column:122},end:{line:4,column:149}}}))+";"+(null!=(o=s(n,"unless").call(r,s(n,"every").call(r,s(n,"eq").call(r,s(n,"getTagHeight").call(r,null!=t?s(t,"name"):t,null!=t?s(t,"value"):t,{name:"getTagHeight",hash:{},data:a,loc:{start:{line:4,column:171},end:{line:4,column:196}}}),"auto",{name:"eq",hash:{},data:a,loc:{start:{line:4,column:167},end:{line:4,column:204}}}),s(n,"eq").call(r,s(n,"getTagWidth").call(r,null!=t?s(t,"name"):t,null!=t?s(t,"value"):t,{name:"getTagWidth",hash:{},data:a,loc:{start:{line:4,column:209},end:{line:4,column:233}}}),"auto",{name:"eq",hash:{},data:a,loc:{start:{line:4,column:205},end:{line:4,column:241}}}),{name:"every",hash:{},data:a,loc:{start:{line:4,column:160},end:{line:4,column:242}}}),{name:"unless",hash:{},fn:e.program(7,a,0),inverse:e.noop,data:a,loc:{start:{line:4,column:150},end:{line:4,column:286}}}))?o:"")+'" controls crossorigin="anonymous" playsinline="true" title="">'+i(s(n,"i18n").call(r,"videoFormatNotCompatible",{name:"i18n",hash:{},data:a,loc:{start:{line:4,column:349},end:{line:4,column:384}}}))+"</video>\r\n"},7:function(e,t,n,l,a){return"max-width:none;max-height:none;"},compiler:[8,">= 4.3.0"],main:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"if").call(r,i(n,"getYoutubeId").call(r,i(n,"removeSpecialAttributeTag").call(r,null!=t?i(t,"value"):t,{name:"removeSpecialAttributeTag",hash:{},data:a,loc:{start:{line:1,column:20},end:{line:1,column:53}}}),{name:"getYoutubeId",hash:{},data:a,loc:{start:{line:1,column:6},end:{line:1,column:54}}}),{name:"if",hash:{},fn:e.program(1,a,0),inverse:e.program(6,a,0),data:a,loc:{start:{line:1,column:0},end:{line:5,column:7}}}))?o:""},useData:!0};e.template[e.CLASS+"-attr-image"]={1:function(e,t,n,l,a){return"max-width:none;max-height:none;"},compiler:[8,">= 4.3.0"],main:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.escapeExpression,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<img src="'+i(s(n,"removeSpecialAttributeTag").call(r,null!=t?s(t,"value"):t,{name:"removeSpecialAttributeTag",hash:{},data:a,loc:{start:{line:1,column:10},end:{line:1,column:45}}}))+'" class="tc-img-attr" style="width:'+i(s(n,"getTagWidth").call(r,null!=t?s(t,"name"):t,null!=t?s(t,"value"):t,{name:"getTagWidth",hash:{},data:a,loc:{start:{line:1,column:80},end:{line:1,column:106}}}))+";height:"+i(s(n,"getTagHeight").call(r,null!=t?s(t,"name"):t,null!=t?s(t,"value"):t,{name:"getTagHeight",hash:{},data:a,loc:{start:{line:1,column:114},end:{line:1,column:141}}}))+";"+(null!=(o=s(n,"unless").call(r,s(n,"every").call(r,s(n,"eq").call(r,s(n,"getTagHeight").call(r,null!=t?s(t,"name"):t,null!=t?s(t,"value"):t,{name:"getTagHeight",hash:{},data:a,loc:{start:{line:1,column:163},end:{line:1,column:188}}}),"auto",{name:"eq",hash:{},data:a,loc:{start:{line:1,column:159},end:{line:1,column:196}}}),s(n,"eq").call(r,s(n,"getTagWidth").call(r,null!=t?s(t,"name"):t,null!=t?s(t,"value"):t,{name:"getTagWidth",hash:{},data:a,loc:{start:{line:1,column:201},end:{line:1,column:225}}}),"auto",{name:"eq",hash:{},data:a,loc:{start:{line:1,column:197},end:{line:1,column:233}}}),{name:"every",hash:{},data:a,loc:{start:{line:1,column:152},end:{line:1,column:234}}}),{name:"unless",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:1,column:142},end:{line:1,column:278}}}))?o:"")+'" title="'+i(s(n,"i18n").call(r,"viewEnlargedImage",{name:"i18n",hash:{},data:a,loc:{start:{line:1,column:287},end:{line:1,column:315}}}))+'" />'},useData:!0};e.template[e.CLASS+"-attr-audio"]={compiler:[8,">= 4.3.0"],main:function(e,t,n,l,a){var o=null!=t?t:e.nullContext||{},r=e.escapeExpression,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<audio src="'+r(i(n,"removeSpecialAttributeTag").call(o,null!=t?i(t,"value"):t,{name:"removeSpecialAttributeTag",hash:{},data:a,loc:{start:{line:1,column:12},end:{line:1,column:47}}}))+'" class="tc-audio-attr" controls crossorigin="anonymous" title="">'+r(i(n,"i18n").call(o,"audioFormatNotCompatible",{name:"i18n",hash:{},data:a,loc:{start:{line:1,column:113},end:{line:1,column:148}}}))+"</audio>"},useData:!0};e.template[e.CLASS+"-attr-embed"]={1:function(e,t,n,l,a){return"max-width:none;"},3:function(e,t,n,l,a){return"max-height:none"},compiler:[8,">= 4.3.0"],main:function(e,t,n,l,a){var o,r=null!=t?t:e.nullContext||{},i=e.escapeExpression,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div><a href="'+i(s(n,"removeSpecialAttributeTag").call(r,null!=t?s(t,"value"):t,{name:"removeSpecialAttributeTag",hash:{},data:a,loc:{start:{line:1,column:14},end:{line:1,column:49}}}))+'" class="tc-embed-attr" target="_blank" title="'+i(s(n,"i18n").call(r,"linkInNewWindow",{name:"i18n",hash:{},data:a,loc:{start:{line:1,column:96},end:{line:1,column:122}}}))+'">'+i(s(n,"i18n").call(r,"openInNewTab",{name:"i18n",hash:{},data:a,loc:{start:{line:1,column:124},end:{line:1,column:147}}}))+'</a></div>\r\n<iframe src="'+i(s(n,"removeSpecialAttributeTag").call(r,null!=t?s(t,"value"):t,{name:"removeSpecialAttributeTag",hash:{},data:a,loc:{start:{line:2,column:13},end:{line:2,column:48}}}))+'" class="tc-embed-attr" style="width:'+i(s(n,"getTagWidth").call(r,null!=t?s(t,"name"):t,null!=t?s(t,"value"):t,{name:"getTagWidth",hash:{},data:a,loc:{start:{line:2,column:85},end:{line:2,column:111}}}))+";"+(null!=(o=s(n,"unless").call(r,s(n,"eq").call(r,s(n,"getTagWidth").call(r,null!=t?s(t,"name"):t,null!=t?s(t,"value"):t,{name:"getTagWidth",hash:{},data:a,loc:{start:{line:2,column:126},end:{line:2,column:150}}}),"auto",{name:"eq",hash:{},data:a,loc:{start:{line:2,column:122},end:{line:2,column:158}}}),{name:"unless",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:2,column:112},end:{line:2,column:186}}}))?o:"")+"height:"+i(s(n,"getTagHeight").call(r,null!=t?s(t,"name"):t,null!=t?s(t,"value"):t,{name:"getTagHeight",hash:{},data:a,loc:{start:{line:2,column:193},end:{line:2,column:220}}}))+";"+(null!=(o=s(n,"unless").call(r,s(n,"eq").call(r,s(n,"getTagHeight").call(r,null!=t?s(t,"name"):t,null!=t?s(t,"value"):t,{name:"getTagHeight",hash:{},data:a,loc:{start:{line:2,column:235},end:{line:2,column:260}}}),"auto",{name:"eq",hash:{},data:a,loc:{start:{line:2,column:231},end:{line:2,column:268}}}),{name:"unless",hash:{},fn:e.program(3,a,0),inverse:e.noop,data:a,loc:{start:{line:2,column:221},end:{line:2,column:296}}}))?o:"")+';" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>'},useData:!0};e.register=async function(e){const t=this,n=TC.control.Click.prototype.register.call(t,e);t._createLayers();e.loaded(function(){const n=e.getControlsByClass("TC.control.Share")[0];n&&t.loadSharedFeature(n.loadParamFeature());t.setDisplayMode(t.options.displayMode||e.defaultInfoContainer||TC.Consts.infoContainer.POPUP)});e.on(TC.Consts.event.POPUPHIDE+" "+TC.Consts.event.RESULTSPANELCLOSE,function(e){if(e.control===t.getDisplayControl()&&t.resultsLayer){if(t.highlightedFeature&&!t.options.persistentHighlights){t.downplayFeature(t.highlightedFeature);t.highlightedFeature=null}!t.querying&&e.feature&&t.filterLayer.removeFeature(e.feature)}}).on(TC.Consts.event.POPUP+" "+TC.Consts.event.DRAWTABLE+" "+TC.Consts.event.DRAWCHART,function(e){const n=e.control;n.currentFeature!==t.filterFeature&&(t.highlightedFeature=n.currentFeature);e.control.caller==t&&t._decorateDisplay(n)}).on(TC.Consts.event.DRAWCHART,function(e){setTimeout(function(){t.highlightedFeature=e.control.currentFeature},50)}).on(TC.Consts.event.LAYERREMOVE,function(){if(Object.keys(t._infoHistory).length){const e={};t.map.workLayers.filter(function(e){return e.type===TC.Consts.layerType.WMS}).forEach(function(t){const n=e[t.url]||[];e[t.url]=n.concat(t.getDisgregatedLayerNames())});let n=!1;for(let l in t._infoHistory){const a=t._infoHistory[l];if(e.hasOwnProperty(l)){const o=e[l];for(let e in a){const l=a[e];if(o.indexOf(e)<0){l.slice().forEach(e=>t.downplayFeature(e));l.length=0;n=!0}}}else{for(let e in a){a[e].slice().forEach(e=>t.downplayFeature(e));n=!0}delete t._infoHistory[l]}}n&&t.closeResults()}}).on(TC.Consts.event.FEATUREREMOVE,function(e){if(e.layer===t.resultsLayer)for(let a in t._infoHistory){const o=t._infoHistory[a];for(let t in o){const a=o[t];for(var n=0,l=a.length;n<l;n++){if(a[n]===e.feature){a.splice(n,1);return}}}}}).on(TC.Consts.event.FEATURESCLEAR,function(e){e.layer===t.resultsLayer&&(t._infoHistory={})}).on(TC.Consts.event.VIEWCHANGE,function(e){t.closeResults()});await n;t.options.share&&await t.getShareDialog();return t};e.render=function(){const e=this;e.div.classList.add(TC.Consts.classes.HIDDEN);return e._set1stRenderPromise(e.getRenderedHtml(e.CLASS+"-dialog",{checkboxId:e.getUID(),elevation:e.options.displayElevation},function(t){e._dialogDiv.innerHTML=t}))};e.responseCallback=function(e){const t=this;t.querying=!1;if(t.filterFeature){t.info={services:e.services};if(t.options.persistentHighlights)for(let e in t._infoHistory){const n=t.info.services.filter(t=>t.url===e)[0];if(n){const l=t._infoHistory[e];for(let e in l){const t=n.layers.filter(t=>t.name===e)[0];if(t){l[e].forEach(function(e){const n=e.wrap.getId(),l=t.features.findIndex(e=>e.wrap.getId()===n);-1!==l&&t.features.splice(l,1)})}}}}}if(e.featureCount){t._addSourceAttributes();t.lastFeatureCount=e.featureCount;t.map.trigger(TC.Consts.event.FEATUREINFO,TC.Util.extend({control:t},e))}else{t.lastFeatureCount=0;t.map.trigger(TC.Consts.event.NOFEATUREINFO,{control:t})}};e.responseError=function(e){const t=this;404===e.status&&t.map.toast(t.getLocaleString("featureInfo.tooManyLayers"),{type:TC.Consts.msgType.ERROR});t.responseCallback({})};e.markerStyle={cssClass:TC.Consts.classes.POINT,anchor:[.5,.5],width:15,height:15,noPrint:!0};e.setDisplayMode=function(e){const t=this;t.displayMode=e;const n=t.map;switch(e){case TC.Consts.infoContainer.RESULTS_PANEL:if(!t.resultsPanel){let e;const l={content:"table",titles:{main:t.getLocaleString("threed.rs.panel.gfi"),max:t.getLocaleString("threed.rs.panel.gfi")},share:t.options.share},a=n.getControlsByClass("TC.control.ControlContainer")[0];if(a){l.position=a.POSITION.RIGHT;e=a.addControl("resultsPanel",l)}else{l.div=document.createElement("div");n.div.appendChild(l.div);e=n.addControl("resultsPanel",l)}e.then(function(e){t.resultsPanel=e;e.caller=t})}break;default:t.displayMode=TC.Consts.infoContainer.POPUP;t.popup||n.addControl("popup",{closeButton:!0,draggable:t.options.draggable,share:t.options.share}).then(function(e){t.popup=e;e.caller=t;n.on(TC.Consts.event.POPUP,function(e){t.onShowPopup(e)})})}};e.getDisplayControl=function(){switch(this.displayMode){case TC.Consts.infoContainer.RESULTS_PANEL:return this.resultsPanel;default:return this.popup}};e.getDisplayTarget=function(e){if((e=e||{}).control)switch(!0){case TC.control.Popup&&e.control instanceof TC.control.Popup:return e.control.getContainerElement();case TC.control.ResultsPanel&&e.control instanceof TC.control.ResultsPanel:return e.control.getInfoContainer();default:return null}switch(this.displayMode){case TC.Consts.infoContainer.RESULTS_PANEL:return this.resultsPanel.getInfoContainer();default:return this.popup.getContainerElement()}};e.getMenuTarget=function(){switch(this.displayMode){case TC.Consts.infoContainer.RESULTS_PANEL:return this.resultsPanel.getMenuElement();default:return this.popup.getMenuElement()}};e.displayResults=function(){var e=this;const t=e.div.cloneNode(!0);t.classList.remove(TC.Consts.classes.HIDDEN);e.filterFeature.data=t.outerHTML;switch(e.displayMode){case TC.Consts.infoContainer.RESULTS_PANEL:if(e.resultsPanel){0===e.map.getControlsByClass(TC.control.ControlContainer).length&&e.map.getControlsByClass(TC.control.ResultsPanel).forEach(function(e){e.isVisible()&&e.close()});e.map.getControlsByClass("TC.control.ResultsPanel").forEach(function(t){t!==e.resultsPanel&&t.currentFeature&&!t.chart&&t.close()});e.resultsPanel.currentFeature=e.filterFeature;e.resultsPanel.open(e.filterFeature.data,e.resultsPanel.getInfoContainer());e.getMenuTarget().innerHTML="";e.displayResultsCallback()}break;default:e.popup&&e.filterFeature.showPopup(e.popup)}};const t=function(e){return Array.from(e.parentElement.children).indexOf(e)},n=function(e,t){var n=e;do{n=n.parentElement}while(n&&n.tagName!==t);return n},l=function(e,l){const a=l,o=n(l,"LI"),r=n(o,"LI");return e.getFeature(t(r),t(o),t(a))};e.getFeatureElement=function(e){const t=this;let n;const a=t.getDisplayTarget().querySelectorAll(t._selectors.LIST_ITEM);for(let o=0,r=a.length;o<r;o++){const r=a[o];if(l(t,r)===e){n=r;break}}return n};e.getNextFeatureElement=function(e){const t=this,n=t.getDisplayTarget().querySelectorAll("ul."+t.CLASS+"-features > li"),l=n.length;for(var a=0;a<l;a++)if(n[a].matches("."+t.CURRENT_CLASS))return n[(a+e+l)%l];return null};e.getFeaturePath=function(e){const t=this;if(t.info&&t.info.services)for(var n=0,l=t.info.services.length;n<l;n++){const l=t.info.services[n];for(var a=0,o=l.layers.length;a<o;a++){const t=l.layers[a];for(var r=0,i=t.features.length;r<i;r++)if(t.features[r]===e)return{service:l.title||l.mapLayers.reduce(function(e,t){return e||t.title},""),layer:t.path}}}return null};e.closeResults=function(){switch(this.displayMode){case TC.Consts.infoContainer.RESULTS_PANEL:this.resultsPanel&&this.resultsPanel.isVisible()&&this.resultsPanel.close();break;default:this.popup&&this.popup.isVisible()&&this.popup.hide()}};e.displayResultsCallback=function(){var e=this;const t=e.getDisplayTarget().querySelector("."+e.CLASS),a=t.querySelector(`.${e.CLASS}-btn-next`);a&&a.addEventListener(TC.Consts.event.CLICK,function(t){e.highlightFeature(e.getNextFeatureElement(1),1);return!1},{passive:!0});const o=t.querySelector(`.${e.CLASS}-btn-prev`);o&&o.addEventListener(TC.Consts.event.CLICK,function(t){e.highlightFeature(e.getNextFeatureElement(-1),-1);return!1},{passive:!0});const r=function(l){const a=n(l.target,"LI");if(a.classList.contains(TC.Consts.classes.CHECKED)){const n=t.querySelector(`.${e.CLASS}-layers li:not(.tc-checked)`);n&&"none"!==getComputedStyle(n).display&&e.downplayFeatures()}else{e.highlightFeature(a.querySelector(e._selectors.LIST_ITEM));e.displayMode===TC.Consts.infoContainer.POPUP&&e.popup.fitToView(!0)}};t.querySelectorAll(`ul.${e.CLASS}-layers h4`).forEach(e=>e.addEventListener(TC.Consts.event.CLICK,r,{passive:!0}));e.displayMode===TC.Consts.infoContainer.POPUP&&t.querySelectorAll("img").forEach(t=>t.addEventListener("load",()=>e.popup.fitToView()));if(e.info){const n=e.getFeatures(),l=e.getMenuTarget();if(n.length>1)e.getRenderedHtml(`${e.CLASS}-buttons`,{id:e.id}).then(function(t){if(!l.querySelector(`.${e.CLASS}-btn-dl`)){l.insertAdjacentHTML("beforeend",t);l.querySelector(`.${e.CLASS}-btn-dl`).addEventListener(TC.Consts.event.CLICK,async function(t){const l=await e.getDownloadDialog();let a={title:e.getLocaleString("featureInfo")+" - "+e.getLocaleString("download"),fileName:e._getFileName()};(e.map.elevation||e.options.displayElevation)&&(a=Object.assign({},a,{elevation:Object.assign({},e.map.elevation&&e.map.elevation.options,e.options.displayElevation)}));l.open(n,a)},{passive:!0});l.querySelector(e._selectors.SHOW_ALL_CHECKBOX).addEventListener("change",function(t){t.target.checked?e.showAllFeatures():e.hideAllFeatures()},{passive:!0});l.querySelector(e._selectors.ZOOM_ALL_BUTTON).addEventListener(TC.Consts.event.CLICK,function(t){e.map.zoomToFeatures(n)},{passive:!0});l.querySelector(e._selectors.DEL_ALL_BUTTON).addEventListener(TC.Consts.event.CLICK,function(t){e.downplayFeatures();e.filterLayer.removeFeature(e.filterFeature)},{passive:!0})}});else{const t=l.querySelector(`.${e.CLASS}-btn`);t&&t.remove()}if(e.info.defaultFeature&&e.getFeatureElement(e.info.defaultFeature)){e.getFeatureElement(e.info.defaultFeature).classList.add(TC.Consts.classes.DEFAULT);e.highlightFeature(e.info.defaultFeature)}else t.querySelector(e._selectors.LIST_ITEM)&&e.highlightFeature(t.querySelector(e._selectors.LIST_ITEM))}t.querySelectorAll("table:not(.complexAttr)").forEach(function(t){t.parentElement.classList.contains(TC.Consts.classes.CHECKED)||t.setAttribute("title",e.getLocaleString("clickToShowOnMap"));t.addEventListener("click",function(t){const n=this.parentElement;if(!n.classList.contains(TC.Consts.classes.DISABLED)){if(n.classList.contains(TC.Consts.classes.CHECKED)){const t=l(e,n);if(t&&window.getSelection()&&0===window.getSelection().toString().trim().length){e.map.on(TC.Consts.event.ZOOM,function t(){e._zooming=!1;e.map.off(TC.Consts.event.ZOOM,t)});e._zooming=!0;e.map.zoomToFeatures([t],{animate:!0})}}else e.highlightFeature(n);t.stopPropagation()}},{passive:!0})});t.querySelectorAll("table a, table label, table input").forEach(function(e){e.addEventListener(TC.Consts.event.CLICK,function(e){e.stopPropagation()},{passive:!0})});if(TC.browserFeatures.touch()&&e.displayMode===TC.Consts.infoContainer.RESULTS_PANEL){const n=t.querySelector("."+e.CLASS+"-btn-prev");if(!n||"none"!==n.style.display){e.resultsPanel&&TC.Util.swipe(e.resultsPanel.div,"disable");((i=e).info&&i.info.services?i.info.services.reduce(function(e,t){return e+t.layers.reduce(function(e,t){return e+1},0)},0):0)>1&&TC.Util.swipe(t,{left:function(){e.highlightFeature(e.getNextFeatureElement(1),1)},right:function(){e.highlightFeature(e.getNextFeatureElement(-1),-1)}})}}var i};e.onShowPopup=function(e){const t=this;e.control===t.popup&&t.displayResultsCallback()};e.loadSharedFeature=function(e){};e.insertLinks=function(){const e=this.getLocaleString("open"),t=this.getLocaleString("linkInNewWindow");this.div.querySelectorAll("td."+this.CLASS+"-val").forEach(function(n){const l=n.textContent;TC.Util.isURL(l)&&(n.innerHTML='<a href="'+l+'" target="_blank" title="'+t+'">'+e+"</a>")})};e.highlightFeature=function(e,l){const a=this;var o;if(!a._zooming){var r;if(e instanceof TC.Feature){o=e;r=a.getFeatureElement(o)}else{r=e;for(;r&&"LI"!==r.tagName;)r=r.parentElement}const i=n(r,"LI"),s=n(i,"LI"),c=t(s),u=t(i),p=t(r);o=o||a.getFeature(c,u,p);a.downplayFeatures({exception:o});const f=a.info.services[c];a._infoHistory.hasOwnProperty(f.url)||(a._infoHistory[f.url]={});const m=a._infoHistory[f.url],d=f.layers[u],h=m[d.name]||[];m[d.name]=h.concat(o);const g=a.getDisplayTarget();g.querySelectorAll("li").forEach(e=>e.classList.remove(a.CURRENT_CLASS));r.classList.add(TC.Consts.classes.CHECKED,a.CURRENT_CLASS);i.classList.add(TC.Consts.classes.CHECKED,a.CURRENT_CLASS);s.classList.add(TC.Consts.classes.CHECKED,a.CURRENT_CLASS);if(l>0){r.classList.add(TC.Consts.classes.FROMLEFT);i.classList.add(TC.Consts.classes.FROMLEFT);s.classList.add(TC.Consts.classes.FROMLEFT)}else if(l<0){r.classList.add(TC.Consts.classes.FROMRIGHT);i.classList.add(TC.Consts.classes.FROMRIGHT);s.classList.add(TC.Consts.classes.FROMRIGHT)}r.querySelector("table")&&r.querySelector("table").setAttribute("title",a.getLocaleString("clickToCenter"));o instanceof TC.Feature||(o=null);if(o&&o===a.highlightedFeature)return;a.highlightedFeature=o;const y=g.querySelector("."+a.CLASS+"-counter-current");y&&(y.innerHTML=a.getFeatureIndex(c,u,p)+1);a.options.persistentHighlights||a.resultsLayer.features.slice().forEach(e=>{e!==o&&a.downplayFeature(e)});if(o){const e=e=>a.map.trigger(TC.Consts.event.FEATUREHIGHLIGHT,{feature:e,control:a});if(o.geometry){o.showsPopup=a.options.persistentHighlights;let t;a.options.persistentHighlights&&(t=a.resultsLayer.getFeatureById(o.wrap.getId()))&&e(t);t||a.resultsLayer.addFeature(o).then(function(t){e(o)})}else{r.classList.add(TC.Consts.classes.DISABLED);e(o)}}}};e.downplayFeature=function(e){const t=this,n=t.getFeatureElement(e);n&&n.classList.remove(TC.Consts.classes.CHECKED);let l;t.options.persistentHighlights&&(l=t.resultsLayer.getFeatureById(e.wrap.getId()));t.resultsLayer.removeFeature(l||e);for(url in t._infoHistory){const n=t._infoHistory[url];for(name in n){const t=n[name],l=t.indexOf(e);if(l>=0){t.splice(l,1);t.length||delete n[name]}}}t.highlightedFeature===e&&(t.highlightedFeature=null);t.map.trigger(TC.Consts.event.FEATUREDOWNPLAY,{feature:e,control:t})};e.downplayFeatures=function(e){const t=this;e=e||{};const l=t.highlightedFeature;if(l&&l!==e.exception){t.downplayFeature(l);t.highlightedFeature=null}t.getFeatures().filter(e=>e!==l).forEach(e=>t.resultsLayer.removeFeature(e));const a=e.exception?t.getFeatureElement(e.exception):void 0;var o,r;if(a){o=n(a,"LI");r=n(o,"LI")}const i=t.getDisplayTarget();Array.from(i.querySelectorAll("ul."+t.CLASS+"-services li")).filter(function(e){return e!==a&&e!==o&&e!==r}).forEach(function(e){e.classList.remove(TC.Consts.classes.CHECKED,TC.Consts.classes.DISABLED,TC.Consts.classes.FROMLEFT,TC.Consts.classes.FROMRIGHT)});i.querySelectorAll("."+t.CLASS+"-features table:not(.complexAttr)").forEach(function(e){e.setAttribute("title",t.getLocaleString("clickToShowOnMap"))});(function(){const e=this,t=e.getMenuTarget(),n=t.querySelector(e._selectors.SHOW_ALL_CHECKBOX);if(n){n.checked=!1;const l=e.getLocaleString("showOnMapAllResults");n.innerHTML=l;t.querySelector(e._selectors.SHOW_ALL_LABEL).setAttribute("title",l);t.querySelector(e._selectors.ZOOM_ALL_BUTTON).classList.add(TC.Consts.classes.HIDDEN);t.querySelector(e._selectors.DEL_ALL_BUTTON).classList.add(TC.Consts.classes.HIDDEN)}}).call(t)};e.showAllFeatures=function(){const e=this;e.highlightedFeature&&e.downplayFeature(e.highlightedFeature);e.getFeatures().forEach(t=>{t.showsPopup=e.options.persistentHighlights;e.resultsLayer.features.indexOf(t)<0&&e.resultsLayer.addFeature(t)});(function(){const e=this,t=e.getMenuTarget(),n=t.querySelector(e._selectors.SHOW_ALL_CHECKBOX);if(n){n.checked=!0;const l=e.getLocaleString("doNotShowOnMapAllResults");t.querySelector(e._selectors.SHOW_ALL_LABEL).setAttribute("title",l);n.innerHTML=l}t.querySelector(e._selectors.ZOOM_ALL_BUTTON).classList.remove(TC.Consts.classes.HIDDEN);t.querySelector(e._selectors.DEL_ALL_BUTTON).classList.remove(TC.Consts.classes.HIDDEN)}).call(e)};e.hideAllFeatures=function(){const e=this.getDisplayTarget().querySelector(`ul.${this.CLASS}-layers > li.${TC.Consts.classes.CHECKED}`);this.downplayFeatures();e&&e.classList.add(TC.Consts.classes.CHECKED)};e.getFeature=function(e,t,n){var l;const a=this.info;a&&a.services&&(l=a.services[e])&&(l=l.layers[t])&&(l=l.features[n]);return l};e.getFeatures=function(){let e=[];const t=this.info;t&&t.services&&(e=t.services.reduce((e,t)=>e.concat(t.layers.reduce((e,t)=>e.concat(t.features),[])),e));return e};e.getFeatureIndex=function(e,t,n){var l=-1;const a=this.info;if(a)for(var o=0;o<=e;o++)for(var r=a.services[o],i=o===e?t:r.layers.length-1,s=0;s<=i;s++)for(var c=r.layers[s],u=s===t?n:c.features.length-1,p=0;p<=u;p++)l+=1;return l};e.beforeRequest=function(e){var t=this;t.querying=!0;t.map.trigger(TC.Consts.event.BEFOREFEATUREINFO,{xy:e.xy,control:t});t.closeResults();if(t.map&&t.resultsLayer){t.lastFeatureCount=null;t.options.persistentHighlights||t.resultsLayer.features.slice().forEach(e=>t.downplayFeature(e));t.info=null}};e.activate=function(){this.wrap&&this.wrap.activate();TC.Control.prototype.activate.call(this)};e.deactivate=function(e){var t=this;t.popup&&t.popup.isVisible()&&t.popup.hide();if(!t.options.persistentHighlights){t.resultsLayer.features.slice().forEach(e=>t.downplayFeature(e));t.info=null;t._infoHistory={}}t.filterLayer&&t.filterLayer.clearFeatures();t.filterFeature=null;t.wrap&&t.wrap.deactivate();TC.Control.prototype.deactivate.call(t,e)};e.exportState=function(){const e=this;if(e.exportsState&&e.resultsLayer){const t={};e.toShare&&(t.features=e.resultsLayer.features.filter(t=>t!==e.highlightedFeature));return{id:e.id,layer:e.resultsLayer.exportState(t),query:e.toShare}}return null};e.importState=function(e){const t=this;t._layersPromise.then(function(){t.resultsLayer.importState(e.layer);e.query&&t.importQuery(e.query)})};e._createLayers=function(){const e=this;var t,n;t=e.options.resultsLayer?e.options.resultsLayer:{id:e.getUID(),title:e.CLASS+": Results layer",type:TC.Consts.layerType.VECTOR,owner:e,stealth:!0};if(e.options.filterLayer)n=e.options.filterLayer;else{const t={};e.geometryType===TC.Consts.geom.POLYLINE&&(t.line=e.style);e.geometryType===TC.Consts.geom.POLYGON&&(t.polygon=e.style);n={id:e.getUID(),title:e.CLASS+": Filter layer",owner:e,stealth:!0,type:TC.Consts.layerType.VECTOR,styles:t}}const l=e.map;e._layersPromise=new Promise(function(a,o){l.loaded(function(){const o=l.layers.indexOf(t)>=0?Promise.resolve(t):l.addLayer(t),r=l.layers.indexOf(n)>=0?Promise.resolve(n):l.addLayer(n);Promise.all([o,r]).then(function(t){e.resultsLayer=t[0];e.filterLayer=t[1];a()})})});return e._layersPromise};e._decorateDisplay=function(e){const t=this,n=t.getMenuTarget({control:e});TC.loadJS(!TC.control.Print,[TC.apiLocation+"TC/control/Print"],function(){const l=n.querySelector("."+TC.control.Print.prototype.CLASS+"-btn");if(l)t.lastFeatureCount||e.currentFeature&&!0===e.currentFeature.showsPopup||l.remove();else{var a=t.getLocaleString("feature");if(e===t.getDisplayControl())if(TC.feature.Point&&t.filterFeature instanceof TC.feature.Point){const e=t.filterFeature.geometry;a=t.getLocaleString("featuresAt",{crs:t.map.crs,x:TC.Util.formatCoord(e[0],t.map.wrap.isGeo()?TC.Consts.DEGREE_PRECISION:TC.Consts.METER_PRECISION),y:TC.Util.formatCoord(e[1],t.map.wrap.isGeo()?TC.Consts.DEGREE_PRECISION:TC.Consts.METER_PRECISION)})}else a=t.getLocaleString("spatialQueryResults");else e.currentFeature&&(a=e.currentFeature.id);(t.lastFeatureCount||e.currentFeature&&!0===e.currentFeature.showsPopup)&&new TC.control.Print({target:n,printableElement:t.getDisplayTarget({control:e}),title:a})}});TC.control.FeatureInfoCommons.addSpecialAttributeEventListeners(e.getContainerElement())};e._addSourceAttributes=function(){const e=this,t="h3_"+e.getLocaleString("service"),n="h4_"+e.getLocaleString("layer");e.info&&e.info.services&&e.info.services.forEach(function(l){l.layers.forEach(function(l){l.features.forEach(function(l){if(l instanceof TC.Feature){const a=e.getFeaturePath(l);if(a){const o={};o[t]=a.service;a.layer&&(o[n]=a.layer.join(e.TITLE_SEPARATOR));const r=TC.Util.extend(o,l.getData());l.clearData();l.setData(r)}}})})})};e._getFileName=function(){return this.getLocaleString("featureInfo").toLowerCase().replace(/\s/gi,"_")+"_"+TC.Util.getFormattedDate((new Date).toString(),!0)};e.showShareDialog=function(e){this.toShare=this.exportQuery();return TC.control.infoShare.showShareDialog.call(this,e)};e.getShareDialog=async function(e){const t=await TC.control.infoShare.getShareDialog.call(this,e);t&&(t.includeControls=!0);return t};e.exportQuery=function(){const e=this,t={};if(e.filterFeature){const n=e.filterLayer.exportState();n.features.forEach(e=>delete e.data);t.filter=n;t.hlf=e.highlightedFeature.getId()}return t};e.importQuery=function(e){const t=this;if(e.filter){t.activate();t.filterLayer.importState(e.filter).then(function(){t.filterFeature=t.filterLayer.features[0];t.sendRequest(t.filterFeature);const n=function(l){if(l.control===t){const l=t.getFeatures().find(t=>t.getId()===e.hlf);l&&t.highlightFeature(l);t.map.off(TC.Consts.event.FEATUREHIGHLIGHT,n)}};t.map.on(TC.Consts.event.FEATUREHIGHLIGHT,n)})}};const a={};TC.control.FeatureInfoCommons.renderFeatureAttributeTable=function(t){a.template||(a.template=TC.Util.extend({},e.template));return e.getRenderedHtml.call(a,e.CLASS+"-attr",t)};TC.control.FeatureInfoCommons.renderFeatureAttribute=function(t){a.template||(a.template=TC.Util.extend({},e.template));return e.getRenderedHtml.call(a,e.CLASS+"-attr-val",t)};TC.control.FeatureInfoCommons.showImageDialog=function(t){a.template||(a.template=TC.Util.extend({},e.template));return new Promise(function(n,l){e.getRenderedHtml.call(a,e.CLASS+"-dialog",{src:t.getAttribute("src")}).then(function(t){const l=document.createElement("div");document.body.appendChild(l);l.innerHTML=t;TC.Util.showModal(l.querySelector(`.${e.CLASS}-img-dialog`),{closeCallback:()=>l.remove()});l.querySelector(".tc-modal-img img").addEventListener(TC.Consts.event.CLICK,function(e){TC.Util.closeModal()},{passive:!0});n(l)})})};TC.control.FeatureInfoCommons.addSpecialAttributeEventListeners=function(e){e.querySelectorAll("img.tc-img-attr").forEach(function(e){e.addEventListener(TC.Consts.event.CLICK,function(e){setTimeout(()=>TC.control.FeatureInfoCommons.showImageDialog(e.target),50);e.stopPropagation()},{passive:!0})})}}();
//# sourceMappingURL=../maps/control/FeatureInfoCommons.min.js.map