!function(){if(window.performance){if(window.performance&&!window.performance.now){window.performance.offset=Date.now();window.performance.now=function(){return Date.now()-window.performance.offset}}}else window.performance={offset:Date.now(),now:function(){return Date.now()-this.offset}}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");var SearchType=function(e,t,r){var a=this;a.parent=r;a._featureTypes=[];TC.Util.extend(a,t);a.typeName=e;a._throwConfigError=function(){throw new Error("Error en la configuraci\xf3n de la b\xfasqueda: "+this.typeName)};a.getFeatureTypes=function(e){if(e)return this.featureType instanceof Array?this.featureType:[this.featureType];if(0===this._featureTypes.length){var t=this.featureType instanceof Array?this.featureType:[this.featureType],r=this.renderFeatureType?this.renderFeatureType instanceof Array?this.renderFeatureType:[this.renderFeatureType]:[];this._featureTypes=t.concat(r)}return this._featureTypes};a.isFeatureOfThisType=function(e){return this.getFeatureTypes().indexOf(e)>-1};a.getStyleByFeatureType=function(e){return this.getFeatureTypes().indexOf(e)>-1?this.styles[this.getFeatureTypes().indexOf(e)]:null};var s=function(e,t,r){var a=function(e,t,r){if(t){if(e.hasOwnProperty(t)&&e[t].hasOwnProperty(r))return e[t][r]}else for(var t in e)if(e[t].hasOwnProperty(r))return e[t][r]};if(r){return a(this.getStyleByFeatureType(r),t,e)}for(var s=0;s<this.styles.length;s++){var o=a(this.styles[s],t,e);if(o)return o}};a.getSuggestionListHead=function(){var e,t,r,a=this;if("function"==typeof a.suggestionListHead){e=a.suggestionListHead();t=e.label;r=[{color:e.color,title:e.label}]}else{e=a.suggestionListHead;t=a.parent.getLocaleString(e.label);if("string"==typeof e.color)r=[{color:s.call(a,e.color),title:t}];else if(e.color instanceof Array){var o=a.getFeatureTypes();e.color.length===o.length?r=e.color.map(function(e,r){return{color:s.call(a,e[o[r]].color.css,e[o[r]].color.geomType,o[r]),title:a.parent.getLocaleString(e[o[r]].title)||t}}):a._throwConfigError()}else"object"==typeof e.color&&(r=[{color:s.call(a,e.color.css,e.color.geomType),title:t}])}if(t&&r){var i='<li header><span class="header">'+t+"</span>";return i+=r.map(function(e){if(e.color)return'<span class="header-color" title="'+e.title+'" style="color: '+e.color+';"></span>'}).join("")+"</li>"}a._throwConfigError()};a.getSuggestionListElements=function(e){var t=this,r=[],a=function(e,t){switch(!0){case"number"==typeof e:if(e===t)return!0;break;case"string"==typeof e:if(isNaN(e)&&isNaN(t)){if(e.trim()===t.trim())return!0}else if(e===t)return!0}return!1},s=function(e){for(var t=[],r=0;r<e.length;r++)-1===t.indexOf(e[r])&&t.push(e[r]);return t};t.parseFeatures(e).forEach(function(e){var o=[],i=[],n="",l=t.outputProperties,c=t.dataIdProperty,u=t.outputFormatLabel,p=e.id.split(".").slice(0,1).shift();if(!(t.outputProperties instanceof Array)){l=t.outputProperties[p];c=t.dataIdProperty[p];u=u[p]}for(var T=0;T<l.length;T++)o.push(e.data[l[T]]);for(T=0;T<c.length;T++)i.push(e.data[c[T]]);for(var f={},h=0;h<t.outputProperties.length;h++)f[t.outputProperties[h]]=o[h];o instanceof Array&&u&&s(o).length>1?n=u.tcFormat(o):o instanceof Array&&1==s(o).length&&(n=o[0]);var g=n.toCamelCase();(function(e){for(var t=0;t<r.length;t++){var s=0,o=[];for(var i in e){o.push(a(e[i],r[t].properties[i]));s++}if(o.filter(function(e){return e}).length===s)return!0}return!1})(f)||r.push({text:g,label:g,id:i.join("#"),dataRole:t.typeName,dataLayer:p,properties:f})});return r};a.parseFeatures=function(e){return(a.outputFormat===TC.Consts.format.JSON?new TC.wrap.parser.JSON:new TC.wrap.parser.WFS({featureNS:a.featurePrefix,featureType:a.featureType})).read(e)};a.getPattern=function(){return"function"==typeof this.pattern?this.pattern():this.pattern};a.filter=function(e){const t=function(t,r){var a=[];if(r!=e.parent.rootCfg.active.root)if(-1!==r.indexOf("#")||e.parent.rootCfg.active.limit)for(var s=r.split("#"),o=0;o<e.parent.rootCfg.active.dataIdProperty.length;o++){0==o&&e.parent.rootCfg.active.dataIdProperty.length>1&&a.push("<ogc:And>");a.push(e.filter.getFilterNode(e.parent.rootCfg.active.dataIdProperty[o],s.length>o?s[o]:s[0]));o==e.parent.rootCfg.active.dataIdProperty.length-1&&e.parent.rootCfg.active.dataIdProperty.length>1&&a.push("</ogc:And>")}else{var i=e.parent.rootCfg.active.queryProperties.firstQueryWord.map(function(t,a){return e.filter.getFilterNode(t,e.parent._LIKE_PATTERN+r+e.parent._LIKE_PATTERN)});if(i.length>1){a.push("<ogc:And>");(a=a.concat(i)).push("</ogc:And>")}else a=a.concat(i)}else{for(var n=0;n<e.parent.rootCfg.active.root.length;n++){s=e.parent.rootCfg.active.root[n];0==n&&e.parent.rootCfg.active.root.length>1&&a.push("<ogc:Or>");for(o=0;o<e.parent.rootCfg.active.dataIdProperty.length;o++){0==o&&e.parent.rootCfg.active.dataIdProperty.length>1&&a.push("<ogc:And>");a.push(e.filter.getFilterNode(e.parent.rootCfg.active.dataIdProperty[o],s.length>o?s[o]:s[0]));o==e.parent.rootCfg.active.dataIdProperty.length-1&&e.parent.rootCfg.active.dataIdProperty.length>1&&a.push("</ogc:And>")}}e.parent.rootCfg.active.root.length>1&&a.push("</ogc:Or>")}return t.concat(a)};return{getPropertyValue:function(t,r){return e.getSearchTypeByRole(t)[r]},getIsLikeNode:function(t,r){var a=/([\-\"\.\xba\(\)\/])/g;a.test(r)&&(r=r.replace(a,"\\$1"));return r.toString().indexOf(e.parent._LIKE_PATTERN)>-1?'<Or><PropertyIsLike escape="\\" singleChar="_" wildCard="*" matchCase="false"><PropertyName>'+t+"</PropertyName><Literal>"+r.toLowerCase().replace(/\</gi,"&lt;").replace(/\>/gi,"&gt;")+'</Literal></PropertyIsLike><PropertyIsLike escape="\\" singleChar="_" wildCard="*" matchCase="false"><PropertyName>'+t+"</PropertyName><Literal>"+r.toUpperCase().replace(/\</gi,"&lt;").replace(/\>/gi,"&gt;")+"</Literal></PropertyIsLike></Or>":"<PropertyIsEqualTo><PropertyName>"+t+"</PropertyName><Literal>"+r.replace(/\</gi,"&lt;").replace(/\>/gi,"&gt;")+"</Literal></PropertyIsEqualTo>"},getFunctionStrMatches:function(t,r){var a=/([\-\"\xba\(\)\/])/g;a.test(r)&&(r=r.replace(a,"\\$1"));if(r.toString().indexOf(e.parent._LIKE_PATTERN)>-1){var s=r;return'<ogc:PropertyIsEqualTo> <ogc:Function name="strMatches"> <ogc:PropertyName>'+t+"</ogc:PropertyName> <ogc:Literal>(?i)"+(s=(s=(s=(s=(s=s.replace(/a/gi,"[a\xe1\xe0]")).replace(/e/gi,"[e\xe9\xe8]")).replace(/i/gi,"[i\xed\xec]")).replace(/o/gi,"[o\xf3\xf2]")).replace(/u/gi,"[u\xfa\xfc\xf9]")).replace(/\</gi,"&lt;").replace(/\>/gi,"&gt;")+"</ogc:Literal> </ogc:Function> <ogc:Literal>true</ogc:Literal> </ogc:PropertyIsEqualTo>"}return"<PropertyIsEqualTo><PropertyName>"+t+"</PropertyName><Literal>"+r.replace(/\</gi,"&lt;").replace(/\>/gi,"&gt;")+"</Literal></PropertyIsEqualTo>"},getFilterNode:function(t,r){var a,s=e.filter.getIsLikeNode;if(e.filterByMatch){s=e.filter.getFunctionStrMatches;var o=new RegExp("\\"+e.parent._LIKE_PATTERN,"gi");r=r.replace(o,e.parent._MATCH_PATTERN)}if(t instanceof Array||"string"==typeof t){if(t instanceof Array&&t.length>1){a="<ogc:Or>";for(l=0;l<t.length;l++)a+=s(t[l].trim(),r);return a+"</ogc:Or>"}return s(t instanceof Array&&1===t.length?t[0].trim():t.trim(),r)}var i=[];for(var n in t)if(t[n]instanceof Array&&t[n].length>1){a="<Or>";for(var l=0;l<t[n].length;l++)a+=s(t[n][l].trim(),r);a+="</Or>";i.push('(<Filter xmlns="http://www.opengis.net/ogc">'+a+"</Filter>)")}else{var c=t[n];t[n]instanceof Array&&1==t[n].length&&(c=t[n][0]);i.push('(<Filter xmlns="http://www.opengis.net/ogc"><Or>'+s(c.trim(),r)+"</Or></Filter>)")}return i.join("")},getFilter:function(r){var a={multiL:!1,f:""};switch(!0){case e.typeName===TC.Consts.searchType.NUMBER:o=[];if(e.parent.rootCfg.active||!/(\<|\>|\<\>)/gi.exec(r.t)&&!/(\<|\>|\<\>)/gi.exec(r.s)){e.parent.rootCfg.active?o=t(o,r.t):o.push(e.filter.getFilterNode(e.queryProperties.firstQueryWord,e.parent._LIKE_PATTERN+r.t+e.parent._LIKE_PATTERN));o.push(e.filter.getFilterNode(e.queryProperties.secondQueryWord,e.parent._LIKE_PATTERN+r.s+e.parent._LIKE_PATTERN))}else{(s=/(\<|\>|\<\>)/gi.exec(r.t))?o.push(e.filter.getFilterNode(e.queryProperties.firstQueryWord,e.parent._LIKE_PATTERN+r.t.substring(0,r.t.indexOf(s[0])).trim()+e.parent._LIKE_PATTERN)):e.parent.rootCfg.active?o=t(o,r.t):o.push(e.filter.getFilterNode(e.queryProperties.firstQueryWord,e.parent._LIKE_PATTERN+r.t+e.parent._LIKE_PATTERN));(s=/(\<|\>|\<\>)/gi.exec(r.s))?o.push(e.filter.getFilterNode(e.queryProperties.secondQueryWord,e.parent._LIKE_PATTERN+r.s.substring(0,r.s.indexOf(s[0])).trim()+e.parent._LIKE_PATTERN)):o.push(e.filter.getFilterNode(e.queryProperties.secondQueryWord,e.parent._LIKE_PATTERN+r.s+e.parent._LIKE_PATTERN))}o.push(e.filter.getFilterNode(e.queryProperties.thirdQueryWord,r.p+e.parent._LIKE_PATTERN));a.f='<ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:And>'+o.join("")+"</ogc:And></ogc:Filter>";break;case e.typeName===TC.Consts.searchType.STREET:o=[];if(e.parent.rootCfg.active||!/(\<|\>|\<\>)/gi.exec(r.t)&&!/(\<|\>|\<\>)/gi.exec(r.s)){e.parent.rootCfg.active?o=t(o,r.t):o.push(e.filter.getFilterNode(e.queryProperties.firstQueryWord,e.parent._LIKE_PATTERN+r.t+e.parent._LIKE_PATTERN));o.push(e.filter.getFilterNode(e.queryProperties.secondQueryWord,e.parent._LIKE_PATTERN+r.s+e.parent._LIKE_PATTERN))}else{var s;(s=/(\<|\>|\<\>)/gi.exec(r.t))?o.push(e.filter.getFilterNode(e.queryProperties.firstQueryWord,e.parent._LIKE_PATTERN+r.t.substring(0,r.t.indexOf(s[0])).trim()+e.parent._LIKE_PATTERN)):e.parent.rootCfg.active?o=t(o,r.t):o.push(e.filter.getFilterNode(e.queryProperties.firstQueryWord,e.parent._LIKE_PATTERN+r.t+e.parent._LIKE_PATTERN));(s=/(\<|\>|\<\>)/gi.exec(r.s))?o.push(e.filter.getFilterNode(e.queryProperties.secondQueryWord,e.parent._LIKE_PATTERN+r.s.substring(0,r.s.indexOf(s[0])).trim()+e.parent._LIKE_PATTERN)):o.push(e.filter.getFilterNode(e.queryProperties.secondQueryWord,e.parent._LIKE_PATTERN+r.s+e.parent._LIKE_PATTERN))}a.f='<ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:And>'+o.join("")+"</ogc:And></ogc:Filter>";break;case e.typeName===TC.Consts.searchType.LOCALITY:a.f=e.filter.getFilterNode(e.queryProperties.firstQueryWord,e.parent._LIKE_PATTERN+r.t+e.parent._LIKE_PATTERN);a.multiL=!0;break;case e.queryProperties.hasOwnProperty("secondQueryWord"):var o;(o=[]).push(e.filter.getFilterNode(e.queryProperties.firstQueryWord,e.parent._LIKE_PATTERN+r.t+e.parent._LIKE_PATTERN));o.push(e.filter.getFilterNode(e.queryProperties.secondQueryWord,e.parent._LIKE_PATTERN+r.s+e.parent._LIKE_PATTERN));a.f='<ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:And>'+o.join("")+"</ogc:And></ogc:Filter>";break;default:a.f='<ogc:Filter xmlns:ogc="http://www.opengis.net/ogc">'+e.filter.getFilterNode(e.queryProperties.firstQueryWord,e.parent._LIKE_PATTERN+r.t+e.parent._LIKE_PATTERN)+"</ogc:Filter>"}return a},getParams:function(t){var r=e.filter.getFilter(t),a={REQUEST:"GetFeature",SERVICE:"WFS",MAXFEATURES:500,VERSION:e.version,OUTPUTFORMAT:e.outputFormat},s=e.getFeatureTypes(!0);if(s instanceof Array){for(var o=[],i=0;i<s.length;i++)o.push(e.featurePrefix?e.featurePrefix+":"+s[i].trim():s[i].trim());a.TYPENAME=o.join(",")}else a.TYPENAME=e.featurePrefix?e.featurePrefix+":"+s.trim():s.trim();var n=function(e){if(""!==(e||"")){if(e instanceof Array)return e.join(",");var t=[];if(e instanceof Object)for(var r in e){var a=e[r][0];e[r].length>1&&(a=e[r].join(","));t.push(a)}return t}},l=n(e.outputProperties),c=n(e.dataIdProperty);const u=e=>{const t=e.split(",");return t.filter((e,r)=>t.indexOf(e)===r).join(",")};if(l instanceof Array&&c instanceof Array){a.PROPERTYNAME="";for(i=0;i<l.length;i++)a.PROPERTYNAME+="("+u(l[i]+","+c[i])+")"}else a.PROPERTYNAME=u(l+","+c);a.FILTER=r.f;return TC.Util.getParamString(a)},getGoToFilter:function(t){var r=[],a=t.split("#"),s=e.dataIdProperty,o=e.getFeatureTypes();if(s&&o)if(t.indexOf("#")>-1&&o instanceof Array&&o.length>1)for(var i=0;i<o.length;i++)for(var n=0;n<s[o[i]].length;n++)r.push({name:s[o[i]][n],value:a[n]});else if(-1==t.indexOf("#")&&o instanceof Array){var l=s;for(i=0;i<o.length;i++)if(!r.hasOwnProperty(o[i])){l instanceof Object&&s.hasOwnProperty(o[i])&&(l=s[o[i]]);for(n=0;n<l.length;n++)n<a.length&&r.push({name:l[n],value:a[n]})}}else{s instanceof Object&&s.hasOwnProperty(o)&&(s=s[o]);for(i=0;i<s.length;i++)r.push({name:s[i],value:a[i]})}return e.filter.transformFilter(r)},transformFilter:function(e){TC.filter||TC.syncLoadJS(TC.apiLocation+"TC/Filter");if(e&&e instanceof Array){var t=e.map(function(e){if(!e.hasOwnProperty("type"))return new TC.filter.equalTo(e.name,e.value);switch(!0){case e.type==TC.Consts.comparison.EQUAL_TO:return new TC.filter.equalTo(e.name,e.value)}});return t.length>1?TC.filter.and.apply(null,t):t[0]}}}}(a)};TC.control.Search=function(){var e=this;TC.Control.apply(e,arguments);e.exportsState=!0;TC.Consts.event.TOOLSCLOSE=TC.Consts.event.TOOLSCLOSE||"toolsclose.tc";e.url="//idena.navarra.es/ogc/wfs";e.version="1.1.0";e.featurePrefix="IDENA";e.options&&e.options.url&&(e.url=e.options.url);e._LIKE_PATTERN="*";e._MATCH_PATTERN=".*";e.UTMX="X";e.UTMY="Y";e.LON="Lon";e.LAT="Lat";e.UTMX_LABEL="X: ";e.UTMY_LABEL="Y: ";e.LON_LABEL="Lon: ";e.LAT_LABEL="Lat: ";e.MUN="Mun";e.POL="Pol";e.PAR="Par";e.MUN_LABEL="Mun: ";e.POL_LABEL="Pol: ";e.PAR_LABEL="Par: ";e.availableSearchTypes={};e.availableSearchTypes[TC.Consts.searchType.CADASTRAL]={suggestionRoot:null,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",searchWeight:3,featureType:["CATAST_Pol_ParcelaUrba","CATAST_Pol_ParcelaRusti","CATAST_Pol_ParcelaMixta"],municipality:{featureType:"CATAST_Pol_Municipio",labelProperty:"MUNICIPIO",idProperty:"CMUNICIPIO"},queryProperties:{firstQueryWord:"CMUNICIPIO",secondQueryWord:"POLIGONO",thirdQueryWord:"PARCELA"},suggestionListHead:{label:"search.list.cadastral",color:[{CATAST_Pol_ParcelaUrba:{title:"search.list.cadastral.urban",color:{geomType:"polygon",css:"strokeColor"}}},{CATAST_Pol_ParcelaRusti:{title:"search.list.cadastral.rustic",color:{geomType:"polygon",css:"strokeColor"}}},{CATAST_Pol_ParcelaMixta:{title:"search.list.cadastral.mixed",color:{geomType:"polygon",css:"strokeColor"}}}]},styles:[{polygon:{fillColor:"#000000",fillOpacity:.1,strokeColor:"#136278",strokeWidth:2,strokeOpacity:1}},{polygon:{fillColor:"#000000",fillOpacity:.1,strokeColor:"#0c8b3d",strokeWidth:2,strokeOpacity:1}},{polygon:{fillColor:"#000000",fillOpacity:.1,strokeColor:"#e5475f",strokeWidth:2,strokeOpacity:1}}],parser:e.getCadastralRef,goTo:e.goToCadastralRef,goToIdFormat:e.MUN+"{0}"+e.POL+"{1}"+e.PAR+"{2}",idPropertiesIdentifier:"#"};e.availableSearchTypes[TC.Consts.searchType.COORDINATES]={parser:e.getCoordinates,goTo:e.goToCoordinates,searchWeight:4,label:null,suggestionListHead:function(t){return{label:e.availableSearchTypes[TC.Consts.searchType.COORDINATES].label||e.getLocaleString("search.list.coordinates")}}};e.queryProperties={QUERYWORD:"QueryWord",FIRST:"first",SECOND:"second",THIRD:"third"};e.availableSearchTypes[TC.Consts.searchType.MUNICIPALITY]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,url:"//idena.navarra.es/ogc/wfs",featurePrefix:"IDENA",geometryName:"the_geom",featureType:"CATAST_Pol_Municipio",dataIdProperty:["CMUNICIPIO"],queryProperties:{firstQueryWord:["MUNINOAC","MUNICIPIO"]},suggestionListHead:{label:"search.list.municipality",color:"strokeColor"},outputProperties:["MUNICIPIO"],outputFormatLabel:"{0}",searchWeight:1,styles:[{polygon:{fillColor:"#000000",fillOpacity:.1,strokeColor:"#fe06a5",strokeWidth:2,strokeOpacity:1}}],parser:e.getStringPattern.bind(this,[TC.Consts.searchType.MUNICIPALITY]),stringPatternToCheck:e.stringPatternsValidators.s_or_t,goTo:e.goToStringPattern};e.availableSearchTypes[TC.Consts.searchType.COUNCIL]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:"CATAST_Pol_Concejo",renderFeatureType:"",dataIdProperty:["CMUNICIPIO","CCONCEJO"],queryProperties:{firstQueryWord:["CONCEJO"]},outputProperties:["MUNICIPIO","CONCEJO"],outputFormatLabel:"{1} ({0})",searchWeight:4,parser:e.getStringPattern.bind(this,[TC.Consts.searchType.COUNCIL]),stringPatternToCheck:e.stringPatternsValidators.s_or_t,goTo:e.goToStringPattern,idPropertiesIdentifier:"#",suggestionListHead:{label:"search.list.council",color:"strokeColor"},styles:[{polygon:{fillColor:"#000000",fillOpacity:.1,strokeColor:"#49006a",strokeWidth:2,strokeOpacity:1}}]};e.availableSearchTypes[TC.Consts.searchType.STREET]={root:null,limit:null,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",renderFeatureType:"CATAST_Txt_Calle",featureType:"CATAST_Lin_CalleEje",dataIdProperty:["CVIA"],searchWeight:5,queryProperties:{firstQueryWord:["ENTINOAC","ENTIDADC"],secondQueryWord:["VIA","VIANOAC"]},suggestionListHead:{label:"search.list.street",color:"strokeColor"},outputProperties:["ENTIDADC","VIA","CVIA","CENTIDADC","CMUNICIPIO"],outputFormatLabel:"{1}, {0}",styles:[{line:{strokeColor:"#CB0000",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid"}},{point:{label:"VIA",angle:"CADANGLE",fontColor:"#000000",fontSize:10,fontWeight:"bold",labelOutlineColor:"#FFFFFF",labelOutlineWidth:4}}],parser:e.getStringPattern.bind(this,[TC.Consts.searchType.STREET]),goTo:e.goToStringPattern};e.availableSearchTypes[TC.Consts.searchType.NUMBER]={root:null,limit:null,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:"CATAST_Txt_Portal",renderFeatureType:"",searchWeight:6,dataIdProperty:["CMUNICIPIO","CENTIDADC","CVIA","PORTAL"],queryProperties:{firstQueryWord:["ENTIDADC","ENTINOAC"],secondQueryWord:["VIA","VIANOAC"],thirdQueryWord:["PORTAL"]},suggestionListHead:{label:"search.list.number",color:"fontColor"},outputProperties:["ENTIDADC","VIA","PORTAL","CVIA","CENTIDADC","CMUNICIPIO"],outputFormatLabel:"{1} {2}, {0}",styles:[{point:{radius:0,label:"PORTAL",angle:"CADANGLE",fontColor:"#CB0000",fontSize:14,labelOutlineColor:"#FFFFFF",labelOutlineWidth:4}}],parser:e.getStringPattern.bind(this,[TC.Consts.searchType.NUMBER]),goTo:e.goToStringPattern};e.availableSearchTypes[TC.Consts.searchType.URBAN]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:"ESTADI_Pol_EntidadPob",renderFeatureType:"",dataIdProperty:["CMUNICIPIO","CENTIDAD"],idPropertiesIdentifier:"#",queryProperties:{firstQueryWord:["ENTINOAC","ENTIDAD"]},suggestionListHead:{label:"search.list.urban",color:"strokeColor"},outputProperties:["MUNICIPIO","ENTIDAD"],outputFormatLabel:"{1} ({0})",searchWeight:2,styles:[{polygon:{fillColor:"#000000",fillOpacity:.1,strokeColor:"#feba1e",strokeWidth:2,strokeOpacity:1}}],parser:e.getStringPattern.bind(this,[TC.Consts.searchType.URBAN]),stringPatternToCheck:e.stringPatternsValidators.s_or_t,goTo:e.goToStringPattern};e.availableSearchTypes[TC.Consts.searchType.PLACENAME]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:"TOPONI_Txt_Toponimos",renderFeatureType:"",dataIdProperty:["CMUNICIPIO","CTOPONIMO"],idPropertiesIdentifier:"#",queryProperties:{firstQueryWord:["TOPONIMO","TOPONINOAC"]},suggestionListHead:{label:"search.list.placeName",color:"fontColor"},outputProperties:["MUNICIPIO","TOPONIMO","CMUNICIPIO","CTOPONIMO"],outputFormatLabel:"{1} ({0})",searchWeight:7,styles:[{point:{radius:0,label:"TOPONIMO",angle:"CADANGLE",fontColor:"#ff5722",fontSize:14,labelOutlineColor:"#FFFFFF",labelOutlineWidth:4}}],parser:e.getStringPattern.bind(this,[TC.Consts.searchType.PLACENAME]),stringPatternToCheck:e.stringPatternsValidators.s_or_t,goTo:e.goToStringPattern};e.availableSearchTypes[TC.Consts.searchType.PLACENAMEMUNICIPALITY]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:"TOPONI_Txt_Toponimos",renderFeatureType:"",dataIdProperty:["CMUNICIPIO","CTOPONIMO"],idPropertiesIdentifier:"#",queryProperties:{firstQueryWord:["MUNICIPIO","MUNINOAC"],secondQueryWord:["TOPONIMO","TOPONINOAC"]},suggestionListHead:{label:"search.list.placeName",color:"fontColor"},outputProperties:["MUNICIPIO","TOPONIMO","CMUNICIPIO","CTOPONIMO"],outputFormatLabel:"{1} ({0})",searchWeight:8,styles:[{point:{radius:0,label:"TOPONIMO",angle:"CADANGLE",fontColor:"#ff5722",fontSize:14,labelOutlineColor:"#FFFFFF",labelOutlineWidth:4}}],parser:e.getStringPattern.bind(this,[TC.Consts.searchType.PLACENAMEMUNICIPALITY]),stringPatternToCheck:[e.stringPatternsValidators.ts,e.stringPatternsValidators.st],goTo:e.goToStringPattern};e.availableSearchTypes[TC.Consts.searchType.COMMONWEALTH]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:["POLUCI_Pol_MancoRSUg"],renderFeatureType:"",dataIdProperty:["CMANCOMUNI"],queryProperties:{firstQueryWord:["MANCOMUNID"]},outputProperties:["MANCOMUNID"],outputFormatLabel:"{0}",searchWeight:9,styles:[{polygon:{fillColor:"#000000",fillOpacity:.1,strokeColor:"#fc4e2a",strokeWidth:2,strokeOpacity:1}}]};e.availableSearchTypes[TC.Consts.searchType.ROAD]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:"INFRAE_Lin_CtraEje",dataIdProperty:["DCARRETERA"],queryProperties:{firstQueryWord:["DCARRETERA"]},suggestionListHead:{label:"search.list.road",color:"strokeColor"},outputProperties:["DCARRETERA"],outputFormatLabel:e.getLocaleString("search.list.road.shorter")+": {0}",searchWeight:10,styles:[{polygon:{strokeColor:"#00b2fc",strokeOpacity:1,strokeWidth:5},line:{strokeColor:"#00b2fc",strokeOpacity:1,strokeWidth:5,strokeLinecap:"round",strokeDashstyle:"solid"}}],parser:e.getRoad,goTo:e.goToRoad,pattern:function(){return new RegExp("^(?:(?:"+e.getLocaleString("search.list.road")+"|"+e.getLocaleString("search.list.road.shorter")+")\\:?)?\\s*((A?|AP?|N?|R?|E?|[A-Z]{2}?|[A-Z]{1}?)\\s*\\-?\\s*(\\d{1,4})\\s*\\-?\\s*(A?|B?|C?|R?))$","i")}};e.availableSearchTypes[TC.Consts.searchType.ROADPK]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:"INFRAE_Sym_CtraPK",dataIdProperty:["DCARRETERA","CPK"],queryProperties:{firstQueryWord:["DCARRETERA"],secondQueryWord:["PK"]},suggestionListHead:{label:"search.list.pk.larger",color:"fontColor"},outputProperties:["DCARRETERA","PK"],outputFormatLabel:e.getLocaleString("search.list.road.shorter")+": {0} "+e.getLocaleString("search.list.pk")+": {1}",searchWeight:11,styles:[{point:{label:["DCARRETERA","PK"],fontColor:"#00b2fc",fontSize:14,labelOutlineColor:"#ffffff",labelOutlineWidth:2}}],parser:e.getPK,goTo:e.goToPK,pattern:function(){return new RegExp("^(?:(?:"+e.getLocaleString("search.list.road")+"|"+e.getLocaleString("search.list.road.shorter")+")\\:?)?\\s*((A?|AP?|N?|R?|E?|[A-Z]{2}?|[A-Z]{1}?)\\s*\\-?\\s*(\\d{1,4})\\s*\\-?\\s*(A?|B?|C?|R?))\\s*\\,*\\s*(?:(?:"+e.getLocaleString("search.list.pk")+"\\:?)|(?:P\\:?)|(?:K\\:?)|(?:KM\\:?)|(?:\\s+|\\,+))\\s*(\\d{1,4})$","i")}};e.rootCfg={};e.rootCfg[TC.Consts.searchType.MUNICIPALITY]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:"CATAST_Pol_Municipio",dataIdProperty:["CMUNICIPIO"],queryProperties:{firstQueryWord:["MUNICIPIO"]},outputProperties:["MUNICIPIO"],outputFormatLabel:"{0}",getRootLabel:function(){return new Promise(function(t,r){if(e.rootCfg.active&&!e.rootCfg[TC.Consts.searchType.MUNICIPALITY].rootLabel){var a={SERVICE:"WFS"};a.VERSION=e.rootCfg[TC.Consts.searchType.MUNICIPALITY].version;a.REQUEST="GetFeature";a.TYPENAME=e.rootCfg[TC.Consts.searchType.MUNICIPALITY].featurePrefix+":"+e.rootCfg[TC.Consts.searchType.MUNICIPALITY].featureType;a.OUTPUTFORMAT=e.rootCfg[TC.Consts.searchType.MUNICIPALITY].outputFormat;a.PROPERTYNAME=["CMUNICIPIO"].concat(e.rootCfg[TC.Consts.searchType.MUNICIPALITY].outputProperties).join(",");a.CQL_FILTER=e.rootCfg[TC.Consts.searchType.MUNICIPALITY].root.map(function(e){return["CMUNICIPIO"].map(function(t,r){return t+"="+e[r]}).join(" AND ")});a.CQL_FILTER=a.CQL_FILTER.join(" OR ");TC.ajax({url:e.rootCfg[TC.Consts.searchType.MUNICIPALITY].url+"?"+TC.Util.getParamString(a),method:"GET",responseType:TC.Consts.mimeType.JSON}).then(function(r){const a=r.data;if(a.totalFeatures>0){e.rootCfg[TC.Consts.searchType.MUNICIPALITY].rootLabel=a.features.map(function(t){return{id:["CMUNICIPIO"].map(function(e){return t.properties[e]}).join("#"),label:t.properties[e.rootCfg[TC.Consts.searchType.MUNICIPALITY].outputProperties[0]].toLowerCase()}});t(e.rootCfg[TC.Consts.searchType.MUNICIPALITY].rootLabel)}else{e.rootCfg[TC.Consts.searchType.MUNICIPALITY].rootLabel=[];t(e.rootCfg[TC.Consts.searchType.MUNICIPALITY].rootLabel)}}).catch(function(){t([])})}else t(e.rootCfg[TC.Consts.searchType.MUNICIPALITY].rootLabel)})}};e.rootCfg[TC.Consts.searchType.LOCALITY]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:["ESTADI_Pol_EntidadPob"],renderFeatureType:"",dataIdProperty:["CMUNICIPIO","CENTIDADC"],queryProperties:{firstQueryWord:["ENTINOAC"]},outputProperties:["ENTINOAC"],getRootLabel:function(){return new Promise(function(t,r){if(e.rootCfg.active&&!e.rootCfg[TC.Consts.searchType.LOCALITY].rootLabel){var a={SERVICE:"WFS"};a.VERSION=e.rootCfg[TC.Consts.searchType.LOCALITY].version;a.REQUEST="GetFeature";a.TYPENAME=e.rootCfg[TC.Consts.searchType.LOCALITY].featurePrefix+":"+e.rootCfg[TC.Consts.searchType.LOCALITY].featureType;a.OUTPUTFORMAT=e.rootCfg[TC.Consts.searchType.LOCALITY].outputFormat;a.PROPERTYNAME=["CMUNICIPIO","CENTIDAD"].concat(e.rootCfg[TC.Consts.searchType.LOCALITY].outputProperties).join(",");a.CQL_FILTER=e.rootCfg[TC.Consts.searchType.LOCALITY].root.map(function(e){return["CMUNICIPIO","CENTIDAD"].map(function(t,r){return t+"="+e[r]}).join(" AND ")});a.CQL_FILTER=a.CQL_FILTER.join(" OR ");TC.ajax({url:e.rootCfg[TC.Consts.searchType.LOCALITY].url+"?"+TC.Util.getParamString(a),method:"GET",responseType:TC.Consts.mimeType.JSON}).then(function(r){const a=r.data;if(a.totalFeatures>0){e.rootCfg[TC.Consts.searchType.LOCALITY].rootLabel=a.features.map(function(t){return{id:["CMUNICIPIO","CENTIDAD"].map(function(e){return t.properties[e]}).join("#"),label:t.properties[e.rootCfg[TC.Consts.searchType.LOCALITY].outputProperties[0]].toLowerCase()}});t(e.rootCfg[TC.Consts.searchType.LOCALITY].rootLabel)}else{e.rootCfg[TC.Consts.searchType.LOCALITY].rootLabel=[];t(e.rootCfg[TC.Consts.searchType.LOCALITY].rootLabel)}}).catch(function(){t([])})}else t(e.rootCfg[TC.Consts.searchType.LOCALITY].rootLabel)})}};e.allowedSearchTypes=[];if(e.options.allowedSearchTypes)for(var t in e.options.allowedSearchTypes){if(e.availableSearchTypes[t]&&!TC.Util.isEmptyObject(e.options.allowedSearchTypes[t])){if(e.availableSearchTypes[t].renderFeatureType&&e.availableSearchTypes[t].renderFeatureType.length>0&&e.options.allowedSearchTypes[t].featureType&&!e.options.allowedSearchTypes[t].renderFeatureType){delete e.availableSearchTypes[t].renderFeatureType;e.availableSearchTypes[t].styles=e.availableSearchTypes[t].styles.slice(0,e.availableSearchTypes[t].styles.length-1)}TC.Util.extend(e.availableSearchTypes[t],e.options.allowedSearchTypes[t]);if(e.options.allowedSearchTypes[t].root&&t!=TC.Consts.searchType.MUNICIPALITY&&e.options.allowedSearchTypes[t].rootType==TC.Consts.searchType.MUNICIPALITY||t!=TC.Consts.searchType.LOCALITY&&e.options.allowedSearchTypes[t].rootType==TC.Consts.searchType.LOCALITY){e.rootCfg.active=e.rootCfg[e.options.allowedSearchTypes[t].rootType];e.rootCfg.active.root=e.options.allowedSearchTypes[t].root;e.rootCfg.active.limit=e.options.allowedSearchTypes[t].limit;e.availableSearchTypes[TC.Consts.searchType.STREET].queryProperties.firstQueryWord=e.availableSearchTypes[TC.Consts.searchType.NUMBER].queryProperties.firstQueryWord=e.rootCfg.active.dataIdProperty}}e.options.allowedSearchTypes[t]?e.addAllowedSearchType(t,e.availableSearchTypes[t]?e.availableSearchTypes[t]:e.options.allowedSearchTypes[t],e):delete e.options.allowedSearchTypes[t]}e.rootCfg.active&&e.rootCfg.active.getRootLabel();e.queryableFeatures=e.options.queryableFeatures||!1;e.UTMX_LEN=6;e.UTMY_LEN=7;e.wrap=new TC.wrap.control.Search(e);e.interval=500;e.NORMAL_PATTERNS={ROMAN_NUMBER:/M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3}){1,}?\S?\./i,ABSOLUTE_NOT_DOT:/[`~!@#$%^&*_|+\=?;:'"\{\}\[\]\\]/gi,ABSOLUTE:/[`~!@#$%^&*_|+\=?;:'.\{\}\[\]\\]/gi}};TC.inherit(TC.control.Search,TC.Control);!function(){var e=TC.control.Search.prototype;e.CLASS="tc-ctl-search";TC.Consts.event.SEARCHQUERYEMPTY=TC.Consts.event.SEARCHQUERYEMPTY||"searchqueryempty.tc";e.template={compiler:[8,">= 4.3.0"],main:function(e,t,r,a,s){var o=null!=t?t:e.nullContext||{},i=e.escapeExpression,n=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<h2>"+i(n(r,"i18n").call(o,"search.1",{name:"i18n",hash:{},data:s,loc:{start:{line:1,column:4},end:{line:1,column:23}}}))+'</h2>\r\n<div class="tc-ctl-search-content">\r\n    <input type="search" class="tc-ctl-search-txt" placeholder="'+i(n(r,"i18n").call(o,"search.placeholder",{name:"i18n",hash:{},data:s,loc:{start:{line:3,column:64},end:{line:3,column:93}}}))+'" title="'+i(n(r,"i18n").call(o,"search.instructions",{name:"i18n",hash:{},data:s,loc:{start:{line:3,column:102},end:{line:3,column:132}}}))+'" /><button title="'+i(n(r,"i18n").call(o,"search.instructions",{name:"i18n",hash:{},data:s,loc:{start:{line:3,column:151},end:{line:3,column:181}}}))+'" class="tc-ctl-btn tc-ctl-search-btn">'+i(n(r,"i18n").call(o,"search.2",{name:"i18n",hash:{},data:s,loc:{start:{line:3,column:220},end:{line:3,column:239}}}))+'</button>\r\n    <ul class="tc-ctl-search-list tc-hidden"></ul>\r\n</div>'},useData:!0};e.register=function(e){const t=this,r=TC.Control.prototype.register.call(t,e);t._search={data:[]};t.layerStyleFN=function(){function e(e){return e.indexOf(".")>-1?e.split(".")[0]:e}function r(r,a,s){var o=t.getSearchTypeByFeature(s);if(o){var i=o.getStyleByFeatureType(e(s));if(i&&i.hasOwnProperty(a))return i[a][r]}return TC.Cfg.styles[a][r]}return function(t,a,s,o){!TC.Feature||o instanceof TC.Feature||this.map.trigger(TC.Consts.event.FEATURESADD,{layer:this.layer,geom:o.geom});var i=r(a,t,e(o.id));if(s){if(i instanceof Array){var n=i.map(function(e){return o.getData().hasOwnProperty(e)?o.getData()[e]:""}),l=this.getSearchTypeByFeature(e(o.id));return l?l.outputFormatLabel.tcFormat(n):n.join(" ")}return o.getData().hasOwnProperty(i)?o.getData()[i]:""}return i}}();var a=t.layerStyleFN;t.layerPromise=e.addLayer({id:t.getUID(),title:"B\xfasquedas",owner:t,stealth:!0,declutter:!0,type:TC.Consts.layerType.VECTOR,styles:{polygon:{fillColor:a.bind(t,"polygon","fillColor",!1),fillOpacity:a.bind(t,"polygon","fillOpacity",!1),strokeColor:a.bind(t,"polygon","strokeColor",!1),strokeOpacity:a.bind(t,"polygon","strokeOpacity",!1),strokeWidth:a.bind(t,"polygon","strokeWidth",!1)},line:{strokeColor:a.bind(t,"line","strokeColor",!1),strokeOpacity:a.bind(t,"line","strokeOpacity",!1),strokeWidth:a.bind(t,"line","strokeWidth",!1)},marker:{anchor:TC.Defaults.styles.marker.anchor,height:TC.Defaults.styles.marker.height,width:TC.Defaults.styles.marker.width},point:{radius:a.bind(t,"point","radius",!1),height:a.bind(t,"point","height",!1),width:a.bind(t,"point","width",!1),fillColor:a.bind(t,"point","fillColor",!1),fillOpacity:a.bind(t,"point","fillOpacity",!1),strokeColor:a.bind(t,"point","strokeColor",!1),strokeWidth:a.bind(t,"point","strokeWidth",!1),fontSize:a.bind(t,"point","fontSize",!1),fontColor:a.bind(t,"point","fontColor",!1),labelOutlineColor:a.bind(t,"point","labelOutlineColor",!1),labelOutlineWidth:a.bind(t,"point","labelOutlineWidth",!1),label:a.bind(t,"point","label",!0),angle:a.bind(t,"point","angle",!0)}}}).then(function(e){t.layer=e;return e});t.EMPTY_RESULTS_LABEL=t.getLocaleString("noResults");t.EMPTY_RESULTS_TITLE=t.getLocaleString("checkCriterion");t.OUTBBX_LABEL=t.getLocaleString("outsideOfLimits");t.WFS_TYPE_ATTRS=["url","version","geometryName","featurePrefix","featureType","properties","outputFormat"];return r};const t=function(e){const t=this;e.label;var r=[];0===t.lastPattern.trim().length&&t.textInput.value.trim().length>0&&(t.lastPattern=t.textInput.value.trim());var a=t.lastPattern,s=[],o=",";-1==(a=t.NORMAL_PATTERNS.ROMAN_NUMBER.test(a)?a.replace(t.NORMAL_PATTERNS.ABSOLUTE_NOT_DOT,""):a.replace(t.NORMAL_PATTERNS.ABSOLUTE,"")).indexOf(o)&&(o=" ");s=a.trim().split(o);if(e.label.indexOf(t.LAT_LABEL)>-1&&e.label.indexOf(t.LON_LABEL)>-1||e.label.indexOf(t.UTMX_LABEL)>-1&&e.label.indexOf(t.UTMY_LABEL)>-1){s=t.lastPattern.split(" ");for(var i=0;i<s.length;i++)","==s[i].trim().slice(-1)&&(s[i]=s[i].slice(0,-1))}for(var n=0;n<s.length;n++)if(s[n].trim().length>0){r.push("("+s[n].trim().replace(/\(/gi,"").replace(/\)/gi,"")+")");if(u=/((\<)|(\>)|(\<\>))/gi.exec(s[n].trim()))for(var l=s[n].trim().replace(/((\<)|(\>)|(\<\>))/gi,"").split(" "),c=0;c<l.length;c++)l[c].trim().length>0&&r.push("("+l[c].trim().replace(/\(/gi,"\\(").replace(/\)/gi,"\\)")+")")}if(e.dataRole==TC.Consts.searchType.ROAD||e.dataRole==TC.Consts.searchType.ROADPK){var u;if(u=t.getSearchTypeByRole(e.dataRole).getPattern().exec(t.lastPattern)){r=[];u[2]&&u[3]&&u[4]?r.push("("+u[2]+"-"+u[3]+"-"+u[4]+")"):u[2]&&u[3]?r.push("("+u[2]+"-"+u[3]+")"):u[3]&&u[4]?r.push("("+u[3]+"-"+u[4]+")"):(u[2]||u[3])&&r.push("("+(u[2]||u[3])+")");u[5]&&r.push("(?:"+t.getLocaleString("search.list.pk")+"\\:\\s\\d*)("+u[5]+")\\d*")}else u&&u[5]&&(r=[]).push("(?:"+t.getLocaleString("search.list.pk")+"\\:\\s\\d*)("+u[5]+")\\d*")}var p="("+r.join("|")+")";p=(p=(p=(p=(p=(p=(p=(p=(p=(p=(p=p.replace(/\xe1|\xe0/gi,"a")).replace(/\xe9|\xe8/gi,"e")).replace(/\xed|\xec/gi,"i")).replace(/\xf3|\xf2/gi,"o")).replace(/\xfa|\xf9/gi,"u")).replace(/\xfc/gi,"u")).replace(/a/gi,"[a|\xe1|\xe0]")).replace(/e/gi,"[e|\xe9|\xe8]")).replace(/i/gi,"[i|\xed|\xec]")).replace(/o/gi,"[o|\xf3|\xf2]")).replace(/u/gi,"[u|\xfa|\xfc|\xf9]");var T=new RegExp(p,"gi"),f=e.label;return e.dataRole!==TC.Consts.searchType.ROAD||e.dataRole!==TC.Consts.searchType.ROADPK?f.replace(T,function(){var e=Array.prototype.slice.call(arguments,0);return e[e.length-3]?e[0].replace(e[e.length-3],"<b>"+e[e.length-3]+"</b>"):"<b>"+e[0]+"</b>"}):f.replace(T,"<b>$1</b>")},r=function(e){const t=this;var r=e.target;if("a"!==r.tagName.toLowerCase()){let t=e.target;const a=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;for(;t;){if(a.call(t,"a")){r=t;break}t=t.parentElement}}if(r.querySelector("span[hidden]")){t.textInput.value=r.querySelector("span[hidden]").textContent;t.lastPattern=t.textInput.value;t._goToResult(unescape(r.getAttribute("href")).substring(1),r.parentNode.getAttribute("dataRole"));TC.UI.autocomplete.call(t.textInput,"clear")}},a=function(e,t){const r=/[^a-zA-Z]/g,a=/[^0-9]/g;var s=parseInt(e,10),o=parseInt(t,10);if(isNaN(s)&&isNaN(o)){var i=e.replace(r,""),n=t.replace(r,"");if(i===n){var l=parseInt(e.replace(a,""),10),c=parseInt(t.replace(a,""),10);return l===c?0:l>c?1:-1}return i>n?1:-1}return isNaN(s)?1:isNaN(o)?-1:s>o?1:-1},s=function(e){const r=this;var s=[],o=[],i=e.results.sort(function(e,t){const r=this;return r.getSearchTypeByRole(e.dataRole).searchWeight&&r.getSearchTypeByRole(t.dataRole).searchWeight?(r.getSearchTypeByRole(e.dataRole).searchWeight||0)>(r.getSearchTypeByRole(t.dataRole).searchWeight||0)?1:(r.getSearchTypeByRole(e.dataRole).searchWeight||0)<(r.getSearchTypeByRole(t.dataRole).searchWeight||0)?-1:a(e.label,t.label):e.dataRole>t.dataRole?1:e.dataRole<t.dataRole?-1:a(e.label,t.label)}.bind(r));r.rootCfg.active&&(i=i.sort(function(e,t){const r=this,s=function(){var s,o,i=r.rootCfg.active.root[0]instanceof Array?r.rootCfg.active.root[0].join("-"):r.rootCfg.active.root[0];if(e.properties&&e.properties.length>0&&t.properties&&t.properties.length>0){s=r.rootCfg.active.dataIdProperty.map(function(t){return e.properties[t].toString()}).join("-");o=r.rootCfg.active.dataIdProperty.map(function(e){return t.properties[e].toString()}).join("-")}else{s=e.id;o=t.id}return s!==i&&o===i?1:s===i&&o!==i?-1:a(e.label,t.label)}.bind(this);return r.getSearchTypeByRole(e.dataRole).searchWeight&&r.getSearchTypeByRole(t.dataRole).searchWeight?(r.getSearchTypeByRole(e.dataRole).searchWeight||0)>(r.getSearchTypeByRole(t.dataRole).searchWeight||0)?1:(r.getSearchTypeByRole(e.dataRole).searchWeight||0)<(r.getSearchTypeByRole(t.dataRole).searchWeight||0)?-1:s():s()}.bind(r)));for(var n=0;n<i.length;n++){var l=i[n];if(-1==o.indexOf(l.dataRole)){s.push(r.getSearchTypeByRole(l.dataRole).getSuggestionListHead());o.push(l.dataRole)}s.push(`<li dataRole="${l.dataRole}"><a href="#${encodeURIComponent(l.id)}"><span hidden>${l.label}</span>${t.call(r,l)}</a></li>`)}Array.prototype.map.call(r.resultsList.querySelectorAll("li[dataRole]"),e=>e.getAttribute("dataRole")).filter((e,t,r)=>r.indexOf(e)===t&&!o.includes(e)).forEach(e=>{s.push(r.getSearchTypeByRole(e).getSuggestionListHead());s.push(`<li dataRole="${e}"><a class="tc-ctl-search-li-loading" href="#">${r.getLocaleString("searching")}<span class="tc-ctl-search-loading-spinner tc-ctl-search-loading"></span></a></li>`)});return s.join("")};e.renderData=function(e,t){var a=this;a._search=a._search||{};var o=function(){a.search(a.textInput.value,function(e){if(1===e.length){a.textInput.value=e[0].label;a._goToResult(e[0].id,a.resultsList.querySelector("li:not([header])").getAttribute("dataRole"));a.resultsList.classList.add(TC.Consts.classes.HIDDEN)}else 0===e.length&&a.resultsList.classList.add(TC.Consts.classes.HIDDEN)})};return TC.Control.prototype.renderData.call(a,e,function(){var e=function(){a.textInput.value=a.resultsList.label||a.resultsList.querySelector("li:not([header]) > a > span").textContent;a.lastPattern=a.textInput.value;a._goToResult(a.resultsList.id||unescape(a.resultsList.querySelector("li:not([header]) > a").getAttribute("href")).substring(1),a.resultsList.querySelector("li:not([header])").getAttribute("dataRole"));a.resultsList.classList.add(TC.Consts.classes.HIDDEN)};a.textInput=a.div.querySelector("input.tc-ctl-search-txt");a.options&&a.options.placeHolder&&a.textInput.setAttribute("placeHolder",a.options.placeHolder.trim());a.resultsList=a.div.querySelector(".tc-ctl-search-list");a.button=a.div.querySelector(".tc-ctl-search-btn");a.button.addEventListener(TC.Consts.event.CLICK,function(){a.getLayer().then(function(t){a.resultsList.querySelectorAll("li > a:not(.tc-ctl-search-li-loading):not(.tc-ctl-search-li-empty)").length>1||(t.features.length>0?t.map.zoomToFeatures(t.features):1===a.resultsList.querySelectorAll("li > a:not(.tc-ctl-search-li-loading):not(.tc-ctl-search-li-empty)").length?e():a.textInput.dispatchEvent(new Event("keyup")))})},{passive:!0});if(a.options.instructions){a.textInput.setAttribute("title",a.options.instructions.trim());a.button.setAttribute("title",a.options.instructions.trim())}a.resultsList.addEventListener(TC.Consts.event.CLICK,TC.EventTarget.listenerBySelector("a.tc-ctl-search-li-empty",function(){a.resultsList.classList.add(TC.Consts.classes.HIDDEN);a.textInput.focus()}),{passive:!0});a.textInput.addEventListener("keypress",function(t){if(13==t.which){t.preventDefault();t.stopPropagation();a.lastPattern="";1===a.resultsList.querySelectorAll("li > a:not(.tc-ctl-search-li-loading):not(.tc-ctl-search-li-empty)").length?e():o();return!1}});a.textInput.addEventListener("search",function(){if(0===a.textInput.value.length){a.resultsList.classList.add(TC.Consts.classes.HIDDEN);o()}});a.textInput.addEventListener("input",function(){if(0===a.textInput.value.length){a.resultsList.classList.add(TC.Consts.classes.HIDDEN);o()}});a.textInput.addEventListener("targetCleared.autocomplete",function(){a.resultsList.classList.add(TC.Consts.classes.HIDDEN)});a.textInput.addEventListener("targetUpdated.autocomplete",function(){a.resultsList.querySelectorAll("li").length>0&&a.resultsList.classList.remove(TC.Consts.classes.HIDDEN)});a.lastPattern="";a.retryTimeout=null;TC.loadJS(!TC.UI||!TC.UI.autocomplete,[TC.apiLocation+"TC/ui/autocomplete.js"],function(){var e;TC.UI.autocomplete.call(a.textInput,{link:"#",target:a.resultsList,minLength:2,ctx:a,source:function(t,r){a.lastpress=performance.now();e||(e=requestAnimationFrame(function t(){var s=a.textInput.value.trim();if(s.length>0&&(!a.lastPattern||s!=a.lastPattern)&&performance.now()-a.lastpress>a.interval){window.cancelAnimationFrame(e);e=void 0;a.resultsList.classList.add(TC.Consts.classes.HIDDEN);a.lastPattern=s;a.search(s,r)}else e=requestAnimationFrame(t)}))},callback:r.bind(a),buildHTML:s.bind(a)});const t=function(e){if(!e.ctrlKey&&!e.altKey&&!e.shiftKey)if(40===e.keyCode){a.textInput==document.activeElement&&a.resultsList.querySelector("li:not([header]) a")?a.resultsList.querySelector("li:not([header]) a").focus():a.resultsList.querySelector("li:not([header]):last-child a")===document.activeElement?a.textInput.focus():function(e,t){var r=e.nextElementSibling;if(!t)return r;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}(document.activeElement.parentElement,"li:not([header])").querySelector("a").focus();e.preventDefault();e.stopPropagation()}else if(38===e.keyCode){a.textInput==document.activeElement?a.resultsList.querySelector("li:not([header]):last-child a").focus():document.activeElement==a.resultsList.querySelector("li:not([header]) a")?a.resultsList.querySelector("li:not([header]):last-child a").focus():function(e,t){var r=e.previousElementSibling;if(!t)return r;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}(document.activeElement.parentElement,"li:not([header])").querySelector("a").focus();e.preventDefault();e.stopPropagation()}e.stopPropagation()};a.textInput.addEventListener("keydown",t);a.resultsList.addEventListener("keydown",t)});TC.Util.isFunction(t)&&t()})};e.addAllowedSearchType=function(e,t){this.allowedSearchTypes.push(new SearchType(e,t,this))};e.getSearchTypeByRole=function(e){return this.allowedSearchTypes.filter(function(t){return t.typeName==e})[0]};e.getSearchTypeByFeature=function(e){var t=this.allowedSearchTypes.filter(function(t){return t.isFeatureOfThisType(e)});return t.length>0?t[0]:null};e.getElementOnSuggestionList=function(e,t){const r=this;for(var a=0;a<r.searchRequestsResults.length;a++)if(r.searchRequestsResults[a].id==e&&(!t||t&&r.searchRequestsResults[a].dataRole===t))return r.searchRequestsResults[a]};e.getLayer=function(){return this.layerPromise};e.getFeatures=function(){return this.layer.features};e.cleanMap=function(){const e=this;if(e.layer){const a=e.layer;var t=a.features.slice();a.clearFeatures();e.map.trigger(TC.Consts.event.FEATUREREMOVE,{layer:a,feature:t});for(var r=0;r<e.WFS_TYPE_ATTRS.length;r++)a.hasOwnProperty(e.WFS_TYPE_ATTRS[r])&&delete a[e.WFS_TYPE_ATTRS[r]]}};e.getMunicipalities=function(){var e=this;TC.cache.search=TC.cache.search||{};e._municipalitiesPromise=new Promise(function(t,r){if(TC.cache.search.municipalities)t(TC.cache.search.municipalities);else{var a=e.getSearchTypeByRole(TC.Consts.searchType.CADASTRAL);if(!(a.municipality&&a.municipality.featureType&&a.municipality.labelProperty&&a.municipality.idProperty))throw new Error("Error en la configuraci\xf3n de la b\xfasqueda: "+a.typeName+". Error en el objeto municipality");var s={REQUEST:"GetFeature",SERVICE:"WFS",TYPENAME:a.municipality.featureType,VERSION:a.version,PROPERTYNAME:a.municipality.labelProperty+","+a.municipality.idProperty,OUTPUTFORMAT:a.outputFormat};a.featurePrefix&&(s.TYPENAME=a.featurePrefix+":"+s.TYPENAME);var o=a.url+"?"+TC.Util.getParamString(s);TC.ajax({url:o,method:"GET",responseType:"text"}).then(function(e){const r=e.data;var s=(a.outputFormat===TC.Consts.format.JSON?new TC.wrap.parser.JSON:new TC.wrap.parser.WFS({featureNS:a.municipality.featurePrefix,featureType:a.municipality.featureType})).read(r);TC.cache.search.municipalities=[];for(var o=0;o<s.length;o++){var i=s[o];TC.cache.search.municipalities.push({label:i.data[a.municipality.labelProperty],id:i.data[a.municipality.idProperty]})}TC.cache.search.municipalities.sort(function(e,t){return e.label<t.label?-1:e.label>t.label?1:0});t(TC.cache.search.municipalities)}).catch(function(){t()})}});return e._municipalitiesPromise};e.getCoordinates=function(e){const t=this;return new Promise(function(r,a){var s=e.match(new RegExp("^"+t.UTMX_LABEL.trim().toLowerCase()+"*\\s*([-+]?[0-9]{"+t.UTMX_LEN+"}(?:[.,]\\d+)?)\\s*\\,?\\s*"+t.UTMY_LABEL.trim().toLowerCase()+"*\\s*([-+]?[0-9]{"+t.UTMY_LEN+"}(?:[.,]\\d+)?)$"));s&&(e=s[1]+" "+s[2]);(s=e.match(new RegExp("^"+t.LAT_LABEL.trim().toLowerCase()+"*\\s*([-+]?\\d{1,3}([.,]\\d+)?)\\,?\\s*"+t.LON_LABEL.trim().toLowerCase()+"*\\s*([-+]?\\d{1,2}([.,]\\d+)?)$")))&&(e=s[1]+" "+s[3]);if(/\d/.test(e)&&(new RegExp("^([-+]?[0-9]{"+t.UTMX_LEN+"}(?:[.,]\\d+)?)\\s*\\,?\\s*([-+]?[0-9]{"+t.UTMY_LEN+"}(?:[.,]\\d+)?)$").test(e)||/^([-+]?\d{1,3}([.,]\d+)?)\,?\s*([-+]?\d{1,2}([.,]\d+)?)$/.test(e))){if((s=/^([-+]?\d{1,3}([.,]\d+)?)\,?\s*([-+]?\d{1,2}([.,]\d+)?)$/.exec(e))&&(s[1].indexOf(",")>-1||s[3].indexOf(",")>-1)){s[1]=s[1].replace(",",".");s[3]=s[3].replace(",",".");e=s[1]+" "+s[3]}if(!s||s&&(s[1].indexOf(",")>-1?s[1].replace(",","."):s[1])<=180&&(s[3].indexOf(",")>-1?s[3].replace(",","."):s[3])<=90){if((s=new RegExp("^([-+]?[0-9]{"+t.UTMX_LEN+"}(?:[.,]\\d+)?)\\s*\\,?\\s*([-+]?[0-9]{"+t.UTMY_LEN+"}(?:[.,]\\d+)?)$").exec(e))&&(s[1].indexOf(",")>-1||s[2].indexOf(",")>-1)){s[1]=s[1].replace(",",".");s[2]=s[2].replace(",",".");e=s[1]+" "+s[2]}e=e.replace(t.UTMX_LABEL,"").replace(t.UTMY_LABEL,"").replace(t.LON_LABEL,"").replace(t.LAT_LABEL,"");var o=TC.Util.parseCoords(e);if(o){var i=o[0].value,n=o[1].value,l=o[0].type===TC.Consts.UTM?t.UTMX:t.LAT,c=o[1].type===TC.Consts.UTM?t.UTMY:t.LON,u=l+i+c+n,p=t.getPoint(u);if(p&&!t.insideLimit(p)){i=o[1].value;n=o[0].value;u=(l=o[1].type===TC.Consts.UTM?t.UTMX:t.LAT)+i+(c=o[0].type===TC.Consts.UTM?t.UTMY:t.LON)+n;p=t.getPoint(u)}if(p){t.availableSearchTypes[TC.Consts.searchType.COORDINATES].label=/^X([-+]?\d+(?:\.\d+)?)Y([-+]?\d+(?:\.\d+)?)$/.test(u)?t.getLocaleString("search.list.coordinates.utm")+t.map.crs:t.getLocaleString("search.list.coordinates.geo");r([{id:u,label:t.getLabel(u),dataRole:TC.Consts.searchType.COORDINATES}])}else a()}else a()}else a()}else a()})};e.getCadastralRef=function(e){const t=this;return new Promise(function(r,a){var s=e.match(new RegExp(t.MUN_LABEL.trim().toLowerCase()+"?\\s(.*)\\,\\s?"+t.POL_LABEL.trim().toLowerCase()+"?\\s(\\d{1,2})\\,\\s?"+t.PAR_LABEL.trim().toLowerCase()+"?\\s(\\d{1,4})"));s&&(e=s[1]+", "+s[2]+", "+s[3]);var o=e;!/^(.*)\,(\s*\d{1,2}\s*)\,(\s*\d{1,4}\s*)$/.test(e)&&t.getSearchTypeByRole(TC.Consts.searchType.CADASTRAL).suggestionRoot&&(o=t.getSearchTypeByRole(TC.Consts.searchType.CADASTRAL).suggestionRoot+", "+e);/^(.*)\,(\s*\d{1,2}\s*)\,(\s*\d{1,4}\s*)$/.test(o)&&!new RegExp("^([-+]?[0-9]{"+t.UTMX_LEN+"})\\s*\\,\\s*([-+]?[0-9]{"+t.UTMY_LEN+"})$").test(e)?t.getMunicipalities().then(function(e){var a=/^(.*)\,(\s*\d{1,2}\s*)\,(\s*\d{1,4}\s*)$/.exec(o);if(a){var s=new RegExp(a[1].trim().replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),i=[];const o=function(e,r,a,s){var o=[];o.push[t.MUN]=e;o.push[t.POL]=a;o.push[t.PAR]=s;return{id:t.MUN+e+t.POL+a+t.PAR+s,label:t.getLabel(t.MUN+r+t.POL+a+t.PAR+s),dataRole:TC.Consts.searchType.CADASTRAL,properties:o}};if((i=e.filter(function(e){e=e.label||e.id||e;return s.test(e)||s.test(t.removePunctuation(e))})).length>0)for(var n=0;n<i.length;n++)i[n]=o(i[n].id,i[n].label,a[2].trim(),a[3].trim());if(/^[0-9]*$/g.test(a[1])){if(a[1].trim()===t.getSearchTypeByRole(TC.Consts.searchType.CADASTRAL).suggestionRoot){var l=e.filter(function(e){return parseInt(e.id)===parseInt(t.getSearchTypeByRole(TC.Consts.searchType.CADASTRAL).suggestionRoot)})[0];l&&r([o(l.id,l.label,a[2].trim(),a[3].trim())])}i.push(o(a[1].trim(),a[1].trim(),a[2].trim(),a[3].trim()))}r(i)}}):a()})};e.stringPatternsValidators={tsp:function(e,t,r,a){var s=/^([^0-9\,]+)(?:\s*\,\s*)(?:([^\,][a-z\xf1\xe1\xe9\xed\xf3\xfa\xfc\xe0\xe8\xec\xf2\xf9\s*\-\.\(\)\/0-9]+))(?:\s*\,\s*)(?:(\d{1,3}\s?\-?\s?[a-z]{0,4}\s?\-?\s?[a-z]{0,4})|([a-z]{1,4}\s?\-?\s?\d{1,3})|(sn|S\/N|s\/n|s\-n)|([a-z]{1,4}\s?\+\s?[a-z]{1,4}))$/i.exec(e);if(s&&s[1]&&s[2]){var n=function(){return o((s[3]||s[4]||s[5]||s[6]).trim())};if(/^([^0-9]+)$/i.test(s[1].trim())&&/^([^0-9]+)$/i.test(s[2].trim())){t.push({t:s[1].trim(),s:s[2].trim(),p:n()});t.push({t:s[2].trim(),s:s[1].trim(),p:n()})}else/^([^0-9]+)$/i.test(s[1].trim())?t.push({t:s[1].trim(),s:s[2].trim(),p:n()}):t.push({s:s[1].trim(),t:s[2].trim(),p:n()});i.call(this,t,r,a);return!0}return!1},spt:function(e,t,r,a){var s=/^(?:([^\,][a-z\xf1\xe1\xe9\xed\xf3\xfa\xfc\xe0\xe8\xec\xf2\xf9\s*\-\.\(\)\/0-9]+))(?:\s*\,\s*)(?:(\d{1,3}\s?\-?\s?[a-z]{0,4}\s?\-?\s?[a-z]{0,4})|([a-z]{1,4}\s?\-?\s?\d{1,3})|(sn|S\/N|s\/n|s\-n)|([a-z]{1,4}\s?\+\s?[a-z]{1,4}))(?:\s*\,\s*)([^0-9\,]+)$/i.exec(e);if(s&&s[6]&&s[1]){var n=function(){return o((s[2]||s[3]||s[4]||s[5]).trim())};if(/^([^0-9]+)$/i.test(s[6].trim())&&/^([^0-9]+)$/i.test(s[1].trim())){t.push({t:s[6].trim(),s:s[1].trim(),p:n()});t.push({t:s[1].trim(),s:s[6].trim(),p:n()})}else/^([^0-9]+)$/i.test(s[6].trim())?t.push({t:s[6].trim(),s:s[1].trim(),p:n()}):t.push({s:s[6].trim(),t:s[1].trim(),p:n()});i.call(this,t,r,a);return!0}return!1},tnsp:function(e,t,r,a){var s=/^(?:([^\,][a-z\xf1\xe1\xe9\xed\xf3\xfa\xfc\xe0\xe8\xec\xf2\xf9\s*\-\.\(\)\/0-9]+))(?:\s*\,\s*)([^0-9\,]+)(?:\s*\,\s*)(?:(\d{1,3}\s?\-?\s?[a-z]{0,4}\s?\-?\s?[a-z]{0,4})|([a-z]{1,4}\s?\-?\s?\d{1,3})|(sn|S\/N|s\/n|s\-n)|([a-z]{1,4}\s?\+\s?[a-z]{1,4}))$/i.exec(e);if(s&&s[1]&&s[2]){t.push({t:s[2].trim(),s:s[1].trim(),p:o((s[3]||s[4]||s[5]||s[6]).trim())});i.call(this,t,r,a);return!0}return!1},ts:function(e,t,r,a){var s=/^([^0-9\,]+)(?:\s*\,\s*)(?:([^\,][a-z\xf1\xe1\xe9\xed\xf3\xfa\xfc\xe0\xe8\xec\xf2\xf9"\s*\-\.\(\)\/0-9]+))$/i.exec(e);if(!s&&/^[^0-9]*$/i.test(e.trim())){var o=e.split(",").reverse();s=/^([^0-9\,]+)(?:\s*\,\s*)(?:([^\,][a-z\xf1\xe1\xe9\xed\xf3\xfa\xfc\xe0\xe8\xec\xf2\xf9"\s*\-\.\(\)\/0-9]+))$/i.exec(o.join(","))}if(s&&s[1]&&s[2]){if(/^([^0-9]+)$/i.test(s[1].trim())&&/^([^0-9]+)$/i.test(s[2].trim())){t.push({t:s[1].trim(),s:s[2].trim()});t.push({s:s[1].trim(),t:s[2].trim()});i.call(this,t,r,a)}else{var n=function(e){for(var t=e.split(" ").reverse(),r=[],a=0;a<t.length;a++)if(1==t[a].length){r.push(t[a]);t[a]=""}return r.length>0?t.reverse().join(" ").trim()+self._LIKE_PATTERN+r.reverse().join(self._LIKE_PATTERN):t.reverse().join(" ").trim()};/^([^0-9]+)$/i.test(s[1].trim())?t.push({t:s[1].trim(),s:n(s[2].trim())}):t.push({s:n(s[1].trim()),t:s[2].trim()});i.call(this,t,r,a,!0)}return!0}return!1},st:function(e,t,r,a){var s=/^(?:([^\,][a-z\xf1\xe1\xe9\xed\xf3\xfa\xfc\xe0\xe8\xec\xf2\xf9\s*\-\.\(\)\/0-9]+))(?:\s*\,\s*)([^0-9\,]+)$/i.exec(e);if(!s){var n=e.split(",").reverse();s=/^([^0-9\,]+)(?:\s*\,\s*)(?:([^\,][a-z\xf1\xe1\xe9\xed\xf3\xfa\xfc\xe0\xe8\xec\xf2\xf9"\s*\-\.\(\)\/0-9]+))$/i.exec(n.join(","))}if(s){for(var l={},c=(n=e.split(",").reverse(),0);c<n.length;c++)if(/^([^0-9\,]+)$/i.test(n[c].trim()))l.t=n[c].trim();else if(/(\s*\d+)/i.test(n[c].trim()))if(-1==n[c].trim().indexOf(" "))l.s=n[c].trim();else{for(var u=n[c].trim().split(" ").reverse(),p=function(e){if(/^(?:(\d{1,3}\s?\-?\s?[a-z]{0,4}\s?\-?\s?[a-z]{0,4})|([a-z]{1,4}\s?\-?\s?\d{1,3})|(sn|S\/N|s\/n|s\-n)|([a-z]{1,4}\s?\+\s?[a-z]{1,4}))$/i.exec(e.trim())){l.p=o(e.trim());return!0}return!1},T=0,f=u[T].trim();T<u.length&&!p(f);)++T<u.length&&(f+=u[T]);if(l.p){for(var h=u,g=0;g<h.length;g++){for(var d=!1,y=0;y<h[g].split("").length;y++)l.p.indexOf(h[g][y])>-1&&(d=!0);if(d){h[g];h[g]="";if(l.p==o(f))break}}if(/^([^\,][a-z\xf1\xe1\xe9\xed\xf3\xfa\xfc\xe0\xe8\xec\xf2\xf9\s*\-\.\(\)\/0-9]+)$/i.test(u.reverse().join(" ").trim())){for(var C=[],m=u.reverse(),L=0;L<m.length;L++)if(1==m[L].trim().length){C.push(m[L].trim());m[L]=""}l.s=C.length>0?m.reverse().join(" ").trim()+self._LIKE_PATTERN+C.reverse().join(self._LIKE_PATTERN):m.reverse().join(" ").trim()}t.push({t:l.t,s:l.s+" "+l.p})}else l.s=n[c].trim()}t.push(l);i.call(this,t,r,a);return!0}return!1},s_or_t:function(e,t,r,a){var s=/^([^\,][a-z\xf1\xe1\xe9\xed\xf3\xfa\xfc\xe0\xe8\xec\xf2\xf9\s*\-\.\(\)\/0-9\<\>]+)$/i.exec(e);if(s&&s[1]){if(r){t.push({t:s[1].trim()});t.push({t:r,s:s[1].trim()})}else t.push({t:s[1].trim()});return!0}return!1},sp:function(e,t,r,a){var s=/^([^\,][a-z\xf1\xe1\xe9\xed\xf3\xfa\xfc\xe0\xe8\xec\xf2\xf9\s*\-\.\(\)\/]+)\s*\,?\s*((\d{1,3}\s?\-?\s?[a-z]{0,4}\s?\-?\s?[a-z]{0,4})|([a-z]{1,4}\s?\-?\s?\d{1,3})|(sn|S\/N|s\/n|s\-n)|([a-z]{1,4}\s?\+\s?[a-z]{1,4}))$/i.exec(e);if(s&&s[1]&&s[2]){r?t.push({t:r,s:s[1].trim(),p:o(s[2].trim())}):t.push({t:s[1].trim(),s:s[2].trim()});return!0}return!1},snp:function(e,t,r,a){var s=/^([^\,][0-9\s*\-\.\(\)\/]+)\s*\,?\s*(\d{1,3}\s?\-?\s?[a-z]{0,4}\s?\-?\s?[a-z]{0,4})|([a-z]{1,4}\s?\-?\s?\d{1,3})|(sn|S\/N|s\/n|s\-n)|([a-z]{1,4}\s?\+\s?[a-z]{1,4})$/i.exec(e);if(s&&s[1]&&s[2]&&r){t.push({t:r,s:s[1].trim(),p:o(s[2].trim())});return!0}return!1}};const o=function(e){for(var t=[function(e){return/^(\d{1,3})\s?\-?\s?([a-z]{0,4})\s?\-?\s?([a-z]{0,4})$/i.test(e)},function(e){return/^([a-z]{1,4})\s?\-?\s?(\d{1,3})$/i.test(e)},function(e){return/^(sn|S\/N|s\/n|s\-n)$/i.test(e)},function(e){return/^([a-z]{1,4}\s?\+\s?[a-z]{1,4})$/i.test(e)}],r=[function(e){var t=[],r=/^(\d{1,3})\s?\-?\s?([a-z]{0,4})\s?\-?\s?([a-z]{0,4})$/i.exec(e);if(r){for(var a=1;a<r.length;a++)r[a].trim().length>0&&t.push(r[a].trim());return t.join(self._LIKE_PATTERN)}return e},function(e){var t=[],r=/^([a-z]{1,4})\s?\-?\s?(\d{1,3})$/i.exec(e);if(r){for(var a=1;a<r.length;a++)r[a].trim().length>0&&t.push(r[a].trim());return t.join(self._LIKE_PATTERN)}return e},function(e){return/^(sn|S\/N|s\/n|s\-n)$/i.exec(e)?"s*n":e},function(e){/^([a-z]{1,4}\s?\+\s?[a-z]{1,4})$/i.exec(e);return e}],a=0;a<r.length&&!t[a].call(self,e);)a++;return a<r.length?r[a].call(self,e):e},i=function(e,t,r,a){const s=this;if(t)for(var o=e.length;o--;)if(a)e.push(TC.Util.extend({},e[o],{t:t}));else if(e[o].t){var i=s.rootCfg.active.rootLabel.filter(function(t){return t.label.indexOf(s.removePunctuation(e[o].t).toLowerCase())>-1}.bind(s));1==i.length?e[o].t=i[0].id:i.length>1?i.map(function(t){var r=TC.Util.extend({},e[o]);r.t=t.id;e.push(r)}):0==i.length&&r&&e.splice(o,1)}},n=function(e,t){const r=this,a=r.rootCfg.active&&r.rootCfg.active.root||"",s=r.rootCfg.active&&r.rootCfg.active.limit||!1;var o=[];","==(t=t.trim()).charAt(t.length-1)&&(t=t.substring(0,t.length-1));if(function(){for(var e=[function(e){return e.length>=3},function(e){return!/^\d+$/.test(e)&&!/^\d+\,\s*\d+$/.test(e)}],a=0;a<e.length;a++)if(!e[a].call(r,t))return!1;return!0}()){var i=[];if(0===(i=e.map(function(e){return r.getSearchTypeByRole(e)}).filter(function(e){return e.stringPatternToCheck}).map(function(e){return e.stringPatternToCheck}).flat()).length){i=[r.stringPatternsValidators.tsp,r.stringPatternsValidators.spt,r.stringPatternsValidators.tnsp,r.stringPatternsValidators.ts,r.stringPatternsValidators.st];i=a&&t.split(",").length<3?[r.stringPatternsValidators.sp,r.stringPatternsValidators.snp,r.stringPatternsValidators.s_or_t].concat(i):i.concat([r.stringPatternsValidators.sp,r.stringPatternsValidators.snp,r.stringPatternsValidators.s_or_t])}var n=0;try{for(;n<i.length&&!i[n].call(r,t,o,a,s);)n++}catch(e){TC.error("Error seg\xfan el patr\xf3n: "+t,TC.Consts.msgErrorMode.EMAIL,"Error en la b\xfasqueda del callejero")}return o}return null},l=function(e,t,r,a){return fetch(e.url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:e.filter.getParams(a),signal:t}).then(function(e){if(e.ok)return e.text();throw"Search: error requestToWFS"}).then(r).catch(function(e){"AbortError"===e.name?console.log("Search: petici\xf3n abortada"):TC.error(e);throw e})};e.getStringPattern=function(e,t){const r=this;return new Promise((a,s)=>{let o=[],i=[];t=function(e){e=this.removePunctuation(e);return(e=this.NORMAL_PATTERNS.ROMAN_NUMBER.test(e)?e.replace(this.NORMAL_PATTERNS.ABSOLUTE_NOT_DOT,""):e.replace(this.NORMAL_PATTERNS.ABSOLUTE,"")).toLowerCase()}.call(r,t);let c=/(.*)\((.*)\)?/.exec(t);if(c&&c.length>2){o=n.call(r,e,c[1])||[];let t=n.call(r,e,c[1]+","+c[2])||[];o=o.concat(t)}else o=n.call(r,e,t)||[];if(o.length>0){let t=[],n=t=>e.filter(function(e){return Object.keys(r.getSearchTypeByRole(e).queryProperties).length===Object.keys(t).length}),c=[];for(var u=0;u<o.length;u++){let e=o[u],a=n(e);for(var p=0;p<a.length;p++){let s=r.getSearchTypeByRole(a[p]);if(c.indexOf(s.typeName)<0){t.push(s.getSuggestionListHead());t.push('<li dataRole="'+s.typeName+'"><a class="tc-ctl-search-li-loading" href="#">'+r.getLocaleString("searching")+'<span class="tc-ctl-search-loading-spinner tc-ctl-search-loading"></span></a></li>');c.push(s.typeName)}let o=e=>s.getSuggestionListElements(e);i.push(l.call(r,s,r.searchRequestsAbortController.signal,o,e))}}if(i.length>0){r.resultsList.innerHTML+=t.join("");r.textInput.dispatchEvent(new CustomEvent("targetUpdated.autocomplete"));Promise.all(i).then(e=>{a([].concat.apply([],e))}).catch(e=>{s()})}else s()}else s()})};e.getRoad=function(e){const t=this;return new Promise(function(r,a){if((e=e.trim()).length<2)r([]);else{var s=t.getSearchTypeByRole(TC.Consts.searchType.ROAD),o=s.getPattern().exec(e);if(o&&o[3]){var i=o[2]?o[2].trim()+"-"+o[3].trim():o[3].trim();o[4]&&o[4].length>0&&(i=i+"-"+o[4].trim());t.resultsList.innerHTML=s.getSuggestionListHead()+'<li dataRole="'+s.typeName+'"><a class="tc-ctl-search-li-loading" href="#">'+t.getLocaleString("searching")+'<span class="tc-ctl-search-loading-spinner tc-ctl-search-loading"></span></a></li>';t.textInput.dispatchEvent(new CustomEvent("targetUpdated.autocomplete"));fetch(s.url+"?"+s.filter.getParams({t:i}),{signal:t.searchRequestsAbortController.signal}).then(e=>{if(e.ok)return e.text();throw"Search: error getRoad"}).then(e=>{let t=[],o=s.parseFeatures(e);if(o.length>0){o.map(function(e){var r=s.outputProperties;if(!t.some(function(t){return t.text==e.data[r[0]]})){var a=s.outputFormatLabel.tcFormat(s.outputProperties.map(function(t){return e.data[t]})),o=s.outputProperties.map(function(t){return e.data[t]}).join("-");t.push({id:s.dataIdProperty.map(function(t){return e.data[t]}).join("#"),label:a,text:o,dataLayer:e.id.split(".")[0],dataRole:s.typeName})}});r(t)}else a()}).catch(function(e){a()})}else a()}})};e.getPK=function(e){var t=this;return new Promise(function(r,a){if((e=e.trim()).length<3)r([]);else{var s=t.getSearchTypeByRole(TC.Consts.searchType.ROADPK),o=s.getPattern().exec(e);if(o&&o[3]&&o[5]){var i=o[2]?o[2].trim()+"-"+o[3].trim():o[3].trim();o[4]&&o[4].length>0&&(i=i+"-"+o[4].trim());t.resultsList.innerHTML=s.getSuggestionListHead()+'<li dataRole="'+s.typeName+'"><a class="tc-ctl-search-li-loading" href="#">'+t.getLocaleString("searching")+'<span class="tc-ctl-search-loading-spinner tc-ctl-search-loading"></span></a></li>';t.textInput.dispatchEvent(new CustomEvent("targetUpdated.autocomplete"));fetch(s.url+"?"+s.filter.getParams({t:i,s:o[5].trim()}),{signal:t.searchRequestsAbortController.signal}).then(e=>{if(e.ok)return e.text();throw"Search: error getRoadPK"}).then(function(e){let t=[],o=s.parseFeatures(e);if(o.length>0){o.map(function(e){var r=s.outputProperties;if(!t.some(function(t){return t.label==e.data[r[0]]})){var a=s.outputFormatLabel.tcFormat(s.outputProperties.map(function(t){return e.data[t]}));t.push({id:s.dataIdProperty.map(function(t){return e.data[t]}).join("#"),label:a,text:a,dataLayer:e.id.split(".")[0],dataRole:s.typeName})}});r(t)}else a()}).catch(function(e){a()})}else a()}})};e.search=function(e,t){var r=this;if((e=e.trim()).length>0){e=e.toLowerCase();r.searchRequestsAbortController&&r.searchRequestsAbortController.abort();r.resultsList.innerHTML="";r.textInput.dispatchEvent(new CustomEvent("targetUpdated.autocomplete"));r.searchRequestsResults=[];let a=!1,s=()=>{a=!0;r.searchRequestsAbortController.signal.removeEventListener("abort",s)};r.searchRequestsAbortController=new AbortController;r.searchRequestsAbortController.signal.addEventListener("abort",s);let o=0,i=()=>{if(0===--o){if(e!==r.textInput.value.trim().toLowerCase())return;if(0===r.searchRequestsResults.length){r.cleanMap();if(!r.layer||r.layer&&0===r.layer.features.length){r.resultsList.innerHTML='<li><a title="'+r.EMPTY_RESULTS_TITLE+'" class="tc-ctl-search-li-empty">'+r.EMPTY_RESULTS_LABEL+"</a></li>";r.textInput.dispatchEvent(new CustomEvent("targetUpdated.autocomplete"))}}r.lastPattern=""}},n=()=>{if(r.searchRequestsResults){r.searchRequestsResults=r.searchRequestsResults.sort(function(e,t){var r,a=/(\d+)/,s="";if(a.test(e.label)&&a.test(t.label)){r=e.label.match(a)[1];s=t.label.match(a)[1]}else{r=e.label;s=t.label}return r>s?1:r<s?-1:0});r._search.data=r.searchRequestsResults;t&&t(r.searchRequestsResults)}};r.allowedSearchTypes.forEach(function(t){if(t.parser){o++;t.parser.call(r,e).then(function(e,t){let a=()=>{let t=r.resultsList.querySelector('li[dataRole="'+e+'"]');if(t){let e=Array.prototype.indexOf.call(t.parentElement.childNodes,t),a=r.resultsList.childNodes[e-1];r.resultsList.removeChild(a);r.resultsList.removeChild(t)}};if(t&&t.length>0){let e=t.filter((e,t)=>-1===r.searchRequestsResults.findIndex(t=>t.id===e.id));if(e.length===t.length){r.searchRequestsResults=r.searchRequestsResults.concat(e);n()}else 1===t.length&&a()}else a();i()}.bind(r,t.typeName)).catch(function(e){i()}.bind(r,t.typeName))}else console.log("Falta implementaci\xf3n del m\xe9todo parser")})}else{r.lastPattern="";r.cleanMap()}};e._goToResult=function(e,t){var r=this,a=null;r.searchRequestsAbortController&&r.searchRequestsAbortController.abort();return new Promise(function(s,o){r.loading||(r.loading=r.map.getControlsByClass("TC.control.LoadingIndicator")[0]);var i;i=r.loading.addWait();if(matchMedia("(max-width: 30em)").matches){r.textInput.blur();r.map.trigger(TC.Consts.event.TOOLSCLOSE)}r.cleanMap();var n=!1,l=!0;r.allowedSearchTypes.forEach(function(s){if(l)if(r.availableSearchTypes[s.typeName]){var o=t||r.getElementOnSuggestionList.call(r,e).dataRole;if(o){var i=r.getSearchTypeByRole(o);if(r.availableSearchTypes[o]&&i&&i.goTo)null!==(a=i.goTo.call(r,e,o))&&(l=!1);else if(!r.availableSearchTypes[o]&&i&&i.goTo){n=!0;null!==(a=i.goTo.call(r,e,o))&&(l=!1)}else console.log("Falta implementaci\xf3n del m\xe9todo goTo")}}else if(s.goTo){n=!0;null!==(a=s.goTo.call(r,e))&&(l=!1)}else console.log("Falta implementaci\xf3n del m\xe9todo goTo")});r.loading.removeWait(i);if(a){r.getLayer().then(function(e){switch(!0){case a.params.type==TC.Consts.layerType.VECTOR:for(var t=0;t<r.WFS_TYPE_ATTRS.length;t++)e.hasOwnProperty(r.WFS_TYPE_ATTRS[t])&&delete e[r.WFS_TYPE_ATTRS[t]];break;case a.params.type==TC.Consts.layerType.WFS:for(t=0;t<r.WFS_TYPE_ATTRS.length;t++)e[r.WFS_TYPE_ATTRS[t]]=a.params[r.WFS_TYPE_ATTRS[t]];i=r.loading.addWait()}e.type=a.params.type;r.map.on(TC.Consts.event.FEATURESADD,function(e){e.layer===r.layer&&function(e){if(e&&e.length>0)for(var t=0;t<e.length;t++)e[t].showsPopup!=this.queryableFeatures&&(e[t].showsPopup=this.queryableFeatures)}.call(r,e.features)});r.map.one(TC.Consts.event.LAYERUPDATE,function(t){if(t.layer==e){r.map.one(TC.Consts.event.FEATURESADD,function(t){if(t.layer==e){if(!t.layer.features||0==t.layer.features.length&&t.layer.wrap.layer.getSource().getFeatures()){r.resultsList.classList.add(TC.Consts.classes.HIDDEN);var s=t.layer.wrap.layer.getSource().getExtent(),o=t.layer.map.options.pointBoundsRadius;if(s[2]-s[0]==0){s[0]=s[0]-o;s[2]=s[2]+o}if(s[3]-s[1]==0){s[1]=s[1]-o;s[3]=s[3]+o}t.layer.map.setExtent(s);r.map.trigger(TC.Consts.event.ZOOMTO,{extent:s,layer:t.layer})}else if(t.layer.features&&t.layer.features.length>0){r.resultsList.classList.add(TC.Consts.classes.HIDDEN);r.layer.map.zoomToFeatures(t.layer.features);r.map.trigger(TC.Consts.event.FEATURESADD,{layer:r.layer,features:r.layer.features})}else if(t.layer.features&&0==t.layer.features.length&&a.params.type==TC.Consts.layerType.WFS){r.resultsList.inner=a.emptyResultHTML;r.textInput.dispatchEvent(new CustomEvent("targetUpdated.autocomplete"));r.map.trigger(TC.Consts.event.SEARCHQUERYEMPTY)}r.loading.removeWait(i)}});if(t.layer.features&&t.layer.features.length>0){r.resultsList.classList.add(TC.Consts.classes.HIDDEN);r.layer.map.zoomToFeatures(r.layer.features);r.map.trigger(TC.Consts.event.FEATURESADD,{layer:r.layer,features:r.layer.features});r.loading.removeWait(i)}else if(t.layer.features&&0==t.layer.features.length&&a.params.type==TC.Consts.layerType.WFS){r.resultsList.innerHTML=a.emptyResultHTML;r.textInput.dispatchEvent(new CustomEvent("targetUpdated.autocomplete"));t.newData&&t.newData.features&&t.newData.features.length>0||r.map.trigger(TC.Consts.event.SEARCHQUERYEMPTY);r.loading.removeWait(i)}}});e.refresh()});s(a)}else{o(Error("Method goTo has no implementation"));n||r.map.trigger(TC.Consts.event.SEARCHQUERYEMPTY)}})};e.goToResult=function(e,t){if(this.getSearchTypeByRole(t))return this._goToResult(e,t);if(this.availableSearchTypes[t]){this.addAllowedSearchType(t,this.availableSearchTypes[t],this);return this._goToResult(e,t)}alert("No se reconoce el tipo de b\xfasqueda: "+t)};e.goToCoordinates=function(e){var t={};if(/^X([-+]?\d+(?:[\.\,]\d+)?)Y([-+]?\d+(?:[\.\,]\d+)?)$/.test(e)||/^Lat((?:[+-]?)\d+(?:[.,]\d+)?)Lon((?:[+-]?)\d+(?:[.,]\d+)?)$/.test(e)){t.params={type:TC.Consts.layerType.VECTOR,styles:{marker:{url:this.layerStyleFN.bind(this,"marker","url",!0)}}};t.emptyResultHTML='<li><a class="tc-ctl-search-li-empty">'+this.OUTBBX_LABEL+"</a></li>";(function(e){var t=this;wait=t.loading.addWait();var r,a,s=t.getPoint(e);if(s){r=t.getLabel(e);a=t.layer.addMarker(s,TC.Util.extend({},t.map.options.styles.point,{title:r,group:r}))}else{var o=/^Lat((?:[+-]?)\d+(?:\.\d+)?)Lon((?:[+-]?)\d+(?:\.\d+)?)$/.exec(e);e=t.LAT+o[2]+t.LON+o[1];if(s=t.getPoint(e)){r=t.getLabel(e);a=t.layer.addMarker(s,TC.Util.extend({},t.map.options.styles.point,{title:r,group:r}));t.textInput.value=r}}a.then(function(e){t.map.trigger(TC.Consts.event.FEATURESADD,{layer:t.layer,features:[e]});t.map.zoomToFeatures([e]);t.loading.removeWait(wait)})}).call(this,e);return t}return null};e.goToCadastralRef=function(e){var t={},r=new RegExp("^"+this.MUN+"(\\d+)"+this.POL+"(\\d{1,2})"+this.PAR+"{1}(\\d{1,4})");if(r.test(e)){var a=r.exec(e);TC.filter||TC.syncLoadJS(TC.apiLocation+"TC/Filter");var s=this.getSearchTypeByRole(TC.Consts.searchType.CADASTRAL);t.params={type:TC.Consts.layerType.WFS,url:s.url,version:s.version,geometryName:s.geometryName,featurePrefix:s.featurePrefix,featureType:s.featureType,properties:new TC.filter.and(new TC.filter.equalTo(s.queryProperties.firstQueryWord,a[1].trim()),new TC.filter.equalTo(s.queryProperties.secondQueryWord,a[2].trim()),new TC.filter.equalTo(s.queryProperties.thirdQueryWord,a[3].trim())),outputFormat:s.outputFormat,styles:s.styles};t.emptyResultHTML='<li><a title="'+this.EMPTY_RESULTS_TITLE+'" class="tc-ctl-search-li-empty">'+this.EMPTY_RESULTS_LABEL+"</a></li>";return t}return null};e.goToRoad=function(e){var t={},r=this.getSearchTypeByRole(TC.Consts.searchType.ROAD);t.params={type:TC.Consts.layerType.WFS,url:r.url,version:r.version,geometryName:r.geometryName,featurePrefix:r.featurePrefix,featureType:r.getFeatureTypes(),maxFeatures:3e3,properties:r.filter.getGoToFilter(e),outputFormat:r.outputFormat,styles:r.styles};t.emptyResultHTML='<li><a title="'+this.EMPTY_RESULTS_TITLE+'" class="tc-ctl-search-li-empty">'+this.EMPTY_RESULTS_LABEL+"</a></li>";return t};e.goToPK=function(e){var t={},r=this.getSearchTypeByRole(TC.Consts.searchType.ROADPK);t.params={type:TC.Consts.layerType.WFS,url:r.url,version:r.version,geometryName:r.geometryName,featurePrefix:r.featurePrefix,featureType:r.getFeatureTypes(),maxFeatures:3e3,properties:r.filter.getGoToFilter(e),outputFormat:r.outputFormat,styles:r.styles};t.emptyResultHTML='<li><a title="'+this.EMPTY_RESULTS_TITLE+'" class="tc-ctl-search-li-empty">'+this.EMPTY_RESULTS_LABEL+"</a></li>";return t};e.goToStringPattern=function(e,t){var r={},a=this.getSearchTypeByRole(t);r.params={type:TC.Consts.layerType.WFS,url:a.url,version:a.version,geometryName:a.geometryName,featurePrefix:a.featurePrefix,featureType:a.getFeatureTypes(),maxFeatures:3e3,properties:a.filter.getGoToFilter(e),outputFormat:a.outputFormat,styles:a.styles};return r};e.getPoint=function(e){var t,r=this.map.wrap.isGeo(),a=/^X([-+]?\d+(?:\.\d+)?)Y([-+]?\d+(?:\.\d+)?)$/.exec(e);if(a&&3===a.length){t=[parseFloat(a[1]),parseFloat(a[2])];r&&(t=TC.Util.reproject(t,this.map.options.utmCrs,this.map.crs))}else{if((a=/^Lat((?:[+-]?)\d+(?:[.,]\d+)?)Lon((?:[+-]?)\d+(?:[.,]\d+)?)$/.exec(e))&&3===a.length){t=[parseFloat(a[2]),parseFloat(a[1])];if(!r)return TC.Util.reproject(t,this.map.options.geoCrs,this.map.crs)}if((a=/^Lon((?:[+-]?)\d+(?:[.,]\d+)?)Lat((?:[+-]?)\d+(?:[.,]\d+)?)$/.exec(e))&&3===a.length){t=[parseFloat(a[2]),parseFloat(a[1])];if(!r)return TC.Util.reproject(t,this.map.options.geoCrs,this.map.crs)}}return t};e.insideLimit=function(e){return!!function(e,t){return!(e instanceof Array)||t[0]>=e[0]&&t[0]<=e[2]&&t[1]>=e[1]&&t[1]<=e[3]}(this.map.options.maxExtent,e)};e.getPattern=function(){return this.textInput.value};e.getLabel=function(e){var t=e,r=TC.Util.getMapLocale(this.map);if(e.match(new RegExp("^(?:"+this.LAT+"[-\\d])|(?:"+this.UTMX+"[-+]?[\\d])"))){(s=(t=t.replace(this.LAT,this.LAT_LABEL).replace(this.LON," "+this.LON_LABEL).replace(this.UTMX,this.UTMX_LABEL).replace(this.UTMY," "+this.UTMY_LABEL)).match(new RegExp("^"+this.LAT_LABEL.trim()+"*\\s*([-+]?\\d{1,3}([.,]\\d+)?)\\,?\\s*"+this.LON_LABEL.trim()+"*\\s*([-+]?\\d{1,2}([.,]\\d+)?)$")))&&(t=(t=t.replace(s[1],parseFloat(s[1]).toLocaleString(r))).replace(s[3],parseFloat(s[3]).toLocaleString(r)));var a=1.1.toLocaleString(r).substring(1,2);if(s=t.match(new RegExp("^"+this.UTMX_LABEL.trim()+"*\\s*([-+]?[0-9]{"+this.UTMX_LEN+"}(?:[.,]\\d+)?)\\s*\\,?\\s*"+this.UTMY_LABEL.trim()+"*\\s*([-+]?[0-9]{"+this.UTMY_LEN+"}(?:[.,]\\d+)?)$"))){Number.isInteger(parseFloat(s[1]))||(t=t.replace(s[1],s[1].replace(".",a)));Number.isInteger(parseFloat(s[2]))||(t=t.replace(s[2],s[2].replace(".",a)))}}else if(e.match(new RegExp("^(?:"+this.LON+"[-\\d])"))){(s=(t=t.replace(this.LON,this.LON_LABEL).replace(this.LAT," "+this.LAT_LABEL)).match(new RegExp("^"+this.LON_LABEL.trim()+"*\\s*([-+]?\\d{1,3}([.,]\\d+)?)\\,?\\s*"+this.LAT_LABEL.trim()+"*\\s*([-+]?\\d{1,2}([.,]\\d+)?)$")))&&(t=(t=t.replace(s[1],parseFloat(s[1]).toLocaleString(r))).replace(s[3],parseFloat(s[3]).toLocaleString(r)))}else if(e.match(new RegExp("^(?:(\\"+this.MUN+"{1})(.*)(\\"+this.POL+"{1})(\\d{1,2})(\\"+this.PAR+"{1})(\\d{1,4}))"))){var s=e.match(new RegExp("^(?:(\\"+this.MUN+"{1})(.*)(\\"+this.POL+"{1})(\\d{1,2})(\\"+this.PAR+"{1})(\\d{1,4}))"));t=this.MUN_LABEL+s[2]+", "+this.POL_LABEL+s[4]+", "+this.PAR_LABEL+s[6]}return t};e.removePunctuation=function(e){e=e||"";for(var t=new Array(e.length),r={"\xe1":"a","\xe0":"a","\xc1":"A","\xc0":"A","\xe9":"e","\xe8":"e","\xc9":"E","\xc8":"E","\xed":"i","\xec":"i","\xcd":"I","\xcc":"I","\xf3":"o","\xf2":"o","\xd3":"O","\xd2":"O","\xfa":"u","\xf9":"u","\xfc":"u","\xda":"U","\xd9":"U","\xdc":"U"},a=0,s=e.length;a<s;a++)t[a]=r[e.charAt(a)]||e.charAt(a);return t.join("")};e.exportState=function(){const e=this;return e.exportsState&&e.layer?{id:e.id,searchText:e.textInput&&e.textInput.value,layer:e.layer.exportState({exportStyles:!1})}:null};e.importState=function(e){const t=this;t.textInput.value=e.searchText;t.layer.importState(e.layer).then(function(){t.layer.features.forEach(function(e){e.setStyle(null)})})}}();String.prototype.tcFormat||(String.prototype.tcFormat=function(){var e=(arguments||[""])[0];return this.replace(/{(\d+)}/g,function(t,r){return void 0!==e[r]?e[r]:t})});String.prototype.splitRemoveWhiteSpaces||(String.prototype.splitRemoveWhiteSpaces=function(e){for(var t=[],r=this.split(e),a=0;a<r.length;a++)r[a].trim().length>0&&t.push(r[a].trim());return t});String.prototype.toCamelCase||(String.prototype.toCamelCase=function(){var e=this.toLowerCase(),t=this.toLowerCase().match(/[^A-Z\xc1\xc9\xcd\xd3\xda\xdc\xc0\xc8\xcc\xd2\xd9\xe1\xe9\xed\xf3\xfa\xfc\xe0\xe8\xec\xf2\xf9a-z0-9_]+(.)/g);if(t)for(var r=0;r<t.length;r++)/[-;:.<>\{\}\[\]\/\s()]/g.test(t[r])&&(e=e.replace(t[r],t[r].toUpperCase()));return e.charAt(0).toUpperCase()+e.substring(1)});Array.prototype.hasOwnProperty("findByProperty")||Object.defineProperty(Array.prototype,"findByProperty",{enumerable:!1,writable:!0,value:function(e,t){for(var r=0;r<this.length;r++)if(this[r][e]==t)return this[r]}});String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var r=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>r.length)&&(t=r.length);t-=e.length;var a=r.indexOf(e,t);return-1!==a&&a===t});
//# sourceMappingURL=../maps/control/Search.min.js.map