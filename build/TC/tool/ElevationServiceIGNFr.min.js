TC.tool=TC.tool||{};TC.tool.ElevationService||TC.syncLoadJS(TC.apiLocation+"TC/tool/ElevationService");TC.tool.ElevationServiceIGNFr=function(o){TC.tool.ElevationService.apply(this,arguments);this.url=this.options.url||"//wxs.ign.fr/njfzwf3vgc55gekk8ra4zezx/alti/wps";this.process=this.options.process||"gs:WPSElevation";this.profileProcess=this.options.profileProcess||"gs:WPSLineElevation";this.minimumElevation=this.options.minimumElevation||-99998;this.nativeCRS="EPSG:4326"};TC.inherit(TC.tool.ElevationServiceIGNFr,TC.tool.ElevationService);!function(){const o=TC.tool.ElevationServiceIGNFr.prototype;o.request=function(o){const t=this;o=o||{};var e,i=!1;switch(!0){case TC.Geometry.isPoint(o.coordinates):e=[[o.coordinates]];break;case TC.Geometry.isRing(o.coordinates):e=[o.coordinates];break;case TC.Geometry.isRingCollection(o.coordinates):e=o.coordinates;i=!0}o.crs&&o.crs!==t.CRS&&(e=TC.Util.reproject(e,o.crs,t.nativeCRS));const n=[].concat.apply([],e),r={lon:n.map(function(o){return o[0]}).join("|"),lat:n.map(function(o){return o[1]}).join("|"),crs:"crs:84",format:"json"};var s=t.process;if(o.sampleNumber){s=t.profileProcess;r.sampling=o.sampleNumber}else if(o.resolution){s=t.profileProcess;const n=function(o,t){const e=t[0]-o[0],i=t[1]-o[1];return Math.sqrt(e*e+i*i)};var c=0;e.forEach(function(o){c+=o.map(function(o,t,e){const i=e[t-1];return i?n(i,o):0}).reduce(function(o,t){return o+t},0);i&&(c+=n(o[o.length-1],o[0]))});r.sampling=c/o.resolution}return TC.tool.ElevationService.prototype.request.call(t,{dataInputs:r,process:s})};o.parseResponse=function(o,t){if((o=JSON.parse(o)).elevations){var e=o.elevations.map(function(o){return[o.lon,o.lat,o.z]});t.crs&&t.crs!==this.nativeCRS&&(e=TC.Util.reproject(e,this.nativeCRS,t.crs));return TC.tool.ElevationService.prototype.parseResponse.call(this,{coordinates:e},t)}return[]}}();