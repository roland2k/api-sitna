var TC=TC||{};TC.tool=TC.tool||{};TC.tool.Proxification=function(e,t){this.Consts={url:{SPLIT_REGEX:/([^:]*:)?\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/}};if(void 0===e)throw new TypeError('"proxy" parameter is undefined',"TC.tool.Proxification.js");this.proxy="function"==typeof e?e:function(t){var r=e;"http"!=t.substr(0,4)&&(r+=window.location.protocol);return r+=encodeURIComponent(t)};t=t||{};this._location=t.location||window.location;this.preventMixedContent=void 0===t.allowedMixedContent||!t.allowedMixedContent};!function(){window.fetch||function(e){"use strict";if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{new Blob;return!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],n=function(e){return e&&DataView.prototype.isPrototypeOf(e)},o=ArrayBuffer.isView||function(e){return e&&r.indexOf(Object.prototype.toString.call(e))>-1};f.prototype.append=function(e,t){e=a(e);t=c(t);var r=this.map[e];this.map[e]=r?r+","+t:t};f.prototype.delete=function(e){delete this.map[a(e)]};f.prototype.get=function(e){e=a(e);return this.has(e)?this.map[e]:null};f.prototype.has=function(e){return this.map.hasOwnProperty(a(e))};f.prototype.set=function(e,t){this.map[a(e)]=c(t)};f.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)};f.prototype.keys=function(){var e=[];this.forEach(function(t,r){e.push(r)});return u(e)};f.prototype.values=function(){var e=[];this.forEach(function(t){e.push(t)});return u(e)};f.prototype.entries=function(){var e=[];this.forEach(function(t,r){e.push([r,t])});return u(e)};t.iterable&&(f.prototype[Symbol.iterator]=f.prototype.entries);var i=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];m.prototype.clone=function(){return new m(this,{body:this._bodyInit})};y.call(m.prototype);y.call(b.prototype);b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})};b.error=function(){var e=new b(null,{status:0,statusText:""});e.type="error";return e};var s=[301,302,303,307,308];b.redirect=function(e,t){if(-1===s.indexOf(t))throw new RangeError("Invalid status code");return new b(null,{status:t,headers:{location:e}})};e.Headers=f;e.Request=m;e.Response=b;e.fetch=function(e,r){return new Promise(function(n,o){var i=new m(e,r);r=r||{};var s=new XMLHttpRequest;s.onload=function(){if(0===s.status)return new b(null,{status:s.status});var e={status:s.status,statusText:s.statusText,headers:g(s.getAllResponseHeaders()||"")};e.url="responseURL"in s?s.responseURL:e.headers.get("X-Request-URL");var t="response"in s?s.response:s.responseText;n(new b(t,e))};s.onerror=function(){o(new TypeError("Network request failed"))};s.ontimeout=function(){o(new TypeError("Network request failed"))};s.open(i.method,i.url,!r.sync);"include"===i.credentials?s.withCredentials=!0:"omit"===i.credentials&&(s.withCredentials=!1);!r.sync&&"responseType"in s&&t.blob&&(s.responseType="blob");i.headers.forEach(function(e,t){s.setRequestHeader(t,e)});s.send(void 0===i._bodyInit?null:i._bodyInit)})};e.fetch.polyfill=!0}function a(e){"string"!=typeof e&&(e=String(e));if(/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function c(e){"string"!=typeof e&&(e=String(e));return e}function u(e){var r={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};t.iterable&&(r[Symbol.iterator]=function(){return r});return r}function f(e){this.map={};e instanceof f?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function h(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function l(e){return new Promise(function(t,r){e.onload=function(){t(e.result)};e.onerror=function(){r(e.error)}})}function p(e){var t=new FileReader,r=l(t);t.readAsArrayBuffer(e);return r}function d(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);t.set(new Uint8Array(e));return t.buffer}function y(){this.bodyUsed=!1;this._initBody=function(e){this._bodyInit=e;if(e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&n(e)){this._bodyArrayBuffer=d(e.buffer);this._bodyInit=new Blob([this._bodyArrayBuffer])}else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!o(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=d(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))};if(t.blob){this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))};this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}}this.text=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,r=l(t);t.readAsText(e);return r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)};t.formData&&(this.formData=function(){return this.text().then(T)});this.json=function(){return this.text().then(JSON.parse)};return this}function m(e,t){var r,n,o=(t=t||{}).body;if(e instanceof m){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url;this.credentials=e.credentials;t.headers||(this.headers=new f(e.headers));this.method=e.method;this.mode=e.mode;if(!o&&null!=e._bodyInit){o=e._bodyInit;e.bodyUsed=!0}}else this.url=String(e);this.credentials=t.credentials||this.credentials||"omit";!t.headers&&this.headers||(this.headers=new f(t.headers));this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),i.indexOf(n)>-1?n:r);this.mode=t.mode||this.mode||null;this.referrer=null;if(("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function T(e){var t=new FormData;e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}});return t}function g(e){var t=new f;e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}});return t}function b(e,t){t||(t={});this.type="default";this.status=void 0===t.status?200:t.status;this.ok=this.status>=200&&this.status<300;this.statusText="statusText"in t?t.statusText:"OK";this.headers=new f(t.headers);this.url=t.url||"";this._initBody(e)}}("undefined"!=typeof self?self:this);var e=function(e){var t=document.createElement("a");t.href=e;if(!t.origin){if(!t.protocol||!t.hostname){var r=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/.exec(t.href);t.protocol=r[1];if(r[4].indexOf(":")>-1){var n=r[4].split(":");t.hostname=n[0];t.port=n[1]}else t.hostname=r[4]}t.origin=(0===t.protocol.length?window.location.protocol:t.protocol)+"//"+t.hostname+(t.port&&e.indexOf(t.port)>-1?":"+t.port:"")}return t};var t=TC.tool.Proxification.prototype;t.cacheHost=new function(){var t=function(t){var r=e(t);return r?r.origin:null};this._hosts=[];this._hostsImage=[];this.is=function(e,r){var n=t(e);return null!==this.get(n,r)};this.get=function(e,t){if(0===this.getList(t).length)return null;var r=this.getList(t).filter(function(r){return r.key===e&&t.exportable==r.exportable});return 0===r.length?null:r[0]};this.getList=function(e){return e.forImage?this._hostsImage:this._hosts};this.addKey=function(e,r){var n={key:t(e),action:null};r.exportable&&(n.exportable=r.exportable);this.getList(r).push(n);return this.getList(r)[this.getList(r).length-1]};this.removeKey=function(e,r){for(var n=t(e),o=0;o<this.getList(r).length;o++)if(this.getList(r)[o].key===n&&r.exportable==this.getList(r)[o].exportable){this.getList(r).splice(o,1);break}};this.getAction=function(e,r){r=r||{};var n=t(e),o=this.get(n,r);return o?o._actionPromise:Promise.reject(new Error("Cache null"))}};t._isServiceWorker=function(){if(navigator.serviceWorker){if(navigator.serviceWorker.controller&&"activated"===navigator.serviceWorker.controller.state)return!0;navigator.serviceWorker.ready.then(function(e){return!!e.active}).catch(()=>{console.log("Capturamos error que se produce en FF por configuraci\xf3n del navegador.")});return!1}return!1};t._isSameOrigin=function(e){var t=0!==e.indexOf("http")&&0!==e.indexOf("//"),r=!t&&e.match(this.Consts.url.SPLIT_REGEX);if(r){var n=r[1];t=(n==this._location.protocol||null==n)&&r[3]==this._location.hostname;var o=r[4],i=this._location.port;(80!=o&&""!==o||"80"!=i&&""!==i)&&(t=t&&o==i)}return t};t._isSameProtocol=function(e){var t=/^(https?:\/\/)/i,r=e.match(t);if(r&&r.length>1){var n=self._location.match(t);if(n&&n.length>1)return r[0].trim()===n[0].trim()}return!1};t._isSecureURL=function(e){return!/^(f|ht)tps?:\/\//i.test(e)||/^(f|ht)tps:\/\//i.test(e)};const r=function(e,t,r){this.status=e;this.text=t;this.url=r};var n=function(t,r){var n=e(t);return t.replace(n.protocol,r)},o=function(e){return n(e,"https:")},i=function(e){return n(e,"http:")},s=function(e,t,r,n){var s=this;e=o(e);s._image.getImgTag(e,t).then(function(e){r(e,s._actionHTTPS)},function(o){o===s._image.ErrorType.PROTOCOL?n(o):a.call(s,i(e),t,r,n)})},a=function(e,t,r,n){var o=this;t.sameOrigin=o._isSameOrigin(o._actionProxy.call(o,e));o._image.getImgTagByAction(e,t,o._actionProxy.bind(o)).then(function(e){r(e,o._actionProxy)},function(e){n(e)})};t._actionDirect=function(e){return e};t._actionHTTP=function(e){return n(e,"http:")};t._actionHTTPS=function(e){return n(e,"https:")};t._actionProxy=function(e){return this.proxy(e)};t._image={ErrorType:{CORS:"cors",PROTOCOL:"protocol",NOTFOUNDED:"notfounded",UNEXPECTED:"unexpected",OFFLINE:"offline"},checkHttpStatus:function(e){const t=this;return navigator.onLine?fetch(e,{credentials:"omit"}).then(function(e){return{status:e.status,statusText:e.statusText}}).catch(function(e){return{statusText:t.ErrorType.UNEXPECTED}}):Promise.reject({statusText:t.ErrorType.OFFLINE})},getImgTag:function(e,r){return new Promise(function(t,n){var o=this,i=document.createElement("img");if(r.exportable&&!r.sameOrigin){i.dataset.checkCORSHeaders=!0;i.crossOrigin="anonymous"}i.onload=function(){console.log("Load OK: "+i.src);i.onload=i.onerror=void 0;if(r.exportable&&!r.sameOrigin){try{var e=function(e){var t=document.createElement("CANVAS"),r=t.getContext("2d");t.height=e.height;t.width=e.width;r.drawImage(e,0,0);return t}(i);result=e.toDataURL("image/png");t(i)}catch(e){18===e.code?n(o.ErrorType.CORS):t(i)}}else t(i)};i.onerror=function(t){console.log("Load crossOrigin ERROR: "+i.src);if(i.dataset.checkCORSHeaders){i.crossOrigin=null;i.onerror=void 0;i.onerror=function(e){console.log("Load ERROR: "+i.src);o.checkHttpStatus(i.src).then(function(e){r.ignoreProxification?n(o.ErrorType.PROTOCOL):400===e.status?n(o.ErrorType.PROTOCOL):n(e)}).catch(n);i.onload=i.onerror=void 0};i.src=e}else{console.log("Load ERROR: "+i.src);i.onload=i.onerror=void 0;o.checkHttpStatus(i.src).then(function(e){r.ignoreProxification?n(o.ErrorType.PROTOCOL):400===e.status?n(o.ErrorType.PROTOCOL):n(e)}).catch(n)}};try{i.src=e}catch(e){console.log("Load ERROR: "+i.src);n(o.ErrorType.UNEXPECTED)}}.bind(t._image))},getImgTagByAction:function(e,r,n){return new Promise(function(t,o){var i=this,s=document.createElement("img");r.sameOrigin||r.exportable&&(s.crossOrigin="anonymous");s.onload=function(){s.onload=s.onerror=void 0;t(s)};s.onerror=function(e){console.log("Load ERROR: "+s.src);s.onload=s.onerror=void 0;i.checkHttpStatus(s.src).then(function(e){r.ignoreProxification?o(i.ErrorType.PROTOCOL):400===e.status?o(i.ErrorType.PROTOCOL):o(e)}).catch(o)};s.src=n(e)}.bind(t._image))}};t._fetch={Headers:{CONTENTTYPE:"content-type",CONTENTDISPOSITION:"content-disposition"},ErrorType:{CORS:"cors",PROTOCOL:"protocol",NOTFOUNDED:"Not_Founded",UNEXPECTED:"Un_Expected",UNEXPECTEDCONTENTTYPE:"Un_Expected_ContentType"},validateResponse:function(e){if(!e.ok)throw new r(e.status,e.statusText,e.url);return e},validateContentType:function(e,t){const r=this;if(!e)return t;var n=t.headers.get(r._fetch.Headers.CONTENTTYPE);if(n&&-1===n.indexOf(e))throw Error(r._fetch.ErrorType.UNEXPECTEDCONTENTTYPE);return t}};t.fetchImage=function(e,t){var r=this;(t=t||{}).forImage=!0;return new Promise(function(n,c){if(r.cacheHost.is(e,t))r.cacheHost.getAction(e,t).then(function(o){t.sameOrigin=r._isSameOrigin(o.action(e));r._image.getImgTagByAction(e,t,o.action).then(function(e){n(e)},function(e){c(e)})}).catch(e=>c(e));else{var u=r.cacheHost.addKey(e,t);u._actionPromise=new Promise(function(f,h){const l=function(e,o){u.action=o.bind(r);u.exportable=t.exportable;f({action:u.action});n(e)},p=function(n){h(n);if(200==n.status){r.cacheHost.removeKey(e,t);c(n)}else{r.cacheHost.removeKey(e,t);c(n)}};!function(t){if(r._isSameOrigin(e)){t.sameOrigin=!0;r._image.getImgTag(e,t).then(function(e){l(e,r._actionDirect)},p)}else r._isSecureURL(e)?r._image.getImgTag(e,t).then(function(e){l(e,r._actionDirect)},function(n){t.exportable&&n===r._image.ErrorType.CORS||r._isServiceWorker()||r._isSecureURL(r._location)&&r.preventMixedContent?n===r._image.ErrorType.PROTOCOL&&t.ignoreProxification?p(n):a.call(r,e,t,l,p):function(e,t,r,n){var s=this;e=i(e);s._image.getImgTag(e,t).then(function(e){r(e,s._actionHTTP)},function(i){i===s._image.ErrorType.PROTOCOL?n(i):a.call(s,o(e),t,r,n)})}.call(r,e,t,l,p)}):r._isServiceWorker()||r._isSecureURL(r._location)&&r.preventMixedContent?s.call(r,e,t,l,p):r._image.getImgTag(e,t).then(function(e){l(e,r._actionDirect)},function(n){t.exportable&&n===r._image.ErrorType.CORS||!r._isSecureURL(r._location)?n===r._image.ErrorType.PROTOCOL&&t.ignoreProxification?p(n):a.call(r,e,t,l,p):s.call(r,e,t,l,p)})}(t)})}})};t.fetchRetry=function(e,t,r){const n=this;var o=fetch;t.sync&&(o=n.fetchSync);return o(e,t).catch(function(o){if(1===r)throw o;return n.fetchRetry(e,t,r-1)})};t.fetchSync=function(e,t){var r=this;return new Promise(function(n,o){"Symbol"in r&&Symbol;var i="FileReader"in r&&"Blob"in r&&function(){try{new Blob;return!0}catch(e){return!1}}();if("ArrayBuffer"in r){var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"];ArrayBuffer.isView}function a(e){var t=new Headers;e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}});return t}var c=new Request(e,t),u=new XMLHttpRequest;u.onload=function(){var e={status:u.status,statusText:u.statusText,headers:a(u.getAllResponseHeaders()||"")};e.url="responseURL"in u?u.responseURL:e.headers.get("X-Request-URL");var t="response"in u?u.response:u.responseText;n(new Response(t,e))};u.onerror=function(){o(new TypeError("Network request failed"))};u.ontimeout=function(){o(new TypeError("Network request failed"))};u.open(c.method,c.url,!1);"include"===c.credentials?u.withCredentials=!t.sync:"omit"===c.credentials&&(u.withCredentials=!1);!t.sync&&"responseType"in u&&i&&(u.responseType="blob");c.headers.forEach(function(e,t){u.setRequestHeader(t,e)});u.send(void 0===c._bodyInit?null:c._bodyInit)})};t.fetchXML=function(e,t){(t=t||{}).responseType="xml";return this.fetch(e,t)};t.fetchJSON=function(e,t){(t=t||{}).responseType=TC.Consts.mimeType.JSON;return this.fetch(e,t)};t.fetchBlob=function(e,t){(t=t||{}).responseType="blob";return this.fetch(e,t)};t.fetchImageAsBlob=function(e,t){(t=t||{}).responseType="image";return this.fetch(e,t)};t.fetch=function(t,r){const n=this;if((r=r||{}).type){r.method=r.type;delete r.type}if(r.data){r.body=r.data;delete r.data}if(r.contentType){r.headers=new Headers;r.headers.append("Content-Type",r.contentType);delete r.contentType}r.responseType||(r.responseType="");var o=function(e,t,r,i){return(t.retryAttempts?n.fetchRetry(r[0].call(n,e),t,t.retryAttempts):fetch(r[0].call(n,e),t)).then(n._fetch.validateResponse).then(n._fetch.validateContentType.bind(n,t.responseType)).then(function(e){i&&(i.action=r[0].bind(n));const o=e.headers.get(n._fetch.Headers.CONTENTTYPE);if(t.nomanage)return Promise.resolve(e);const s=function(t){return e.blob().then(function(e){const r=new FileReader;return new Promise(function(n,o){r.addEventListener("error",function(){r.abort();o(new DOMException("Problem decoding"))});r.addEventListener("loadend",function(){n(r.result)});r.readAsText(e,t)})}).catch(function(e){throw e})};switch(!0){case t.responseType.indexOf("xml")>-1:case t.responseType.indexOf("text/xml")>-1:case t.responseType.indexOf(TC.Consts.mimeType.XML)>-1:return(a=/charset=([^;]*)/i.exec(o))&&2===a.length&&"UTF-8"!==a[1]?s(a[1]).then(function(e){return(new window.DOMParser).parseFromString(e,"text/xml")}).catch(function(e){throw e}):e.text().then(function(e){return(new window.DOMParser).parseFromString(e,"text/xml")}).catch(function(e){throw e});case t.responseType.indexOf("arraybuffer")>-1:return e.arrayBuffer();case t.responseType.indexOf("image")>-1:case t.responseType.indexOf("blob")>-1:case t.responseType.indexOf("application/zip")>-1:case t.responseType.indexOf("application/x-zip-compressed")>-1:case t.responseType.indexOf("application/vnd.google-earth.kmz")>-1:case t.responseType.indexOf("application/octet-stream")>-1:case t.responseType.indexOf("application/geopackage+sqlite3")>-1:return e.blob().then(function(e){return new Blob([e],{type:o})}).catch(function(e){throw e});case t.responseType.indexOf("document")>-1:throw new DeveloperError("Unhandled responseType: "+t.responseType);case t.responseType.indexOf(TC.Consts.mimeType.JSON)>-1:return e.json();case""==t.responseType:case t.responseType.indexOf("text")>-1:default:var a;return(a=/charset=([^;]*)/i.exec(o))&&2===a.length&&"UTF-8"!==a[1]?s(a[1]).then(function(e){return""==t.responseType?{responseText:e,contentType:o}:e}).catch(function(e){throw e}):e.text().then(function(e){return""==t.responseType?{responseText:e,contentType:o}:e}).catch(function(e){throw e})}}).catch(function(n){if(1===r.length){console.log("request failed",n);return Promise.reject(n)}r.shift();return o(e,t,r,i)})};if(n.cacheHost.is(t,r))return new Promise(function(e,i){n.cacheHost.getAction(t,r).then(function(n){e(o(t,r,[n.action]))}).catch(function(o){!o.status||o.status>=400?i(new Error(o.text)):e(n.fetch(t,r))})});var i=n.cacheHost.addKey(t,r);return new Promise(function(s,a){i._actionPromise=new Promise(function(c,u){t=e(t).href;const f=function(e){c({action:i.action});s(e)},h=function(e){n.cacheHost.removeKey(t,r);u(e);a(new Error(e.text))};n._isSameOrigin(t)?o(t,r,[n._actionDirect,n._actionProxy],i).then(f).catch(h):n._isSecureURL(t)?n._isServiceWorker()?o(t,r,[n._actionDirect,n._actionProxy],i).then(f).catch(h):o(t,r,n._isSecureURL(n._location)?[n._actionDirect,n._actionProxy]:[n._actionDirect,n._actionHTTP,n._actionProxy],i).then(f).catch(h):n._isServiceWorker()?o(t,r,[n._actionHTTPS,n._actionProxy],i).then(f).catch(h):o(t,r,n._isSecureURL(n._location)?[n._actionHTTPS,n._actionProxy]:[n._actionDirect,n._actionHTTPS,n._actionProxy],i).then(f).catch(h)});i._actionPromise.catch(function(e){!e.status||e.status>=400?a(new Error(e.text)):s(n.fetch(t,r))})})};t.fetchFile=function(e,t){const r=this;(t=t||{}).nomanage=!0;return new Promise(function(n,o){r.fetch(e,t).then(function(t){const o=t.headers.get(r._fetch.Headers.CONTENTDISPOSITION);var i=new RegExp(/\w+.\w{1,}$/gi).exec(e)[0];if(o&&/(attachment);([^;]*)/gi.test(o))try{i=/filename\*?=\"?([\w|-]*\'\')?(.*\.\w*)\"?/gi.exec(o)[2]}catch(e){try{i=o.substring((o.lastIndexOf("'")||o.indexOf("="))+1)}catch(e){}}t.blob().then(function(e){n(new File([e],i,{type:t.headers.get(r._fetch.Headers.CONTENTTYPE)}))})}).catch(o)})}}();
//# sourceMappingURL=../maps/tool/Proxification.min.js.map